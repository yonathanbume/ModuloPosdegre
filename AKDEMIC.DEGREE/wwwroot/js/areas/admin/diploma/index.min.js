var diplomas=function(){var a={objects:{}},e={career:function(a){$.ajax({type:"GET",url:`/admin/padron-de-registro/carreras/${a}/get`.proto().parseURL()}).done((function(a){$("#careerId").empty(),$("#careerId").select2({data:a.items})})),$("#careerId").on("change",(function(){var a=$(this).val();e.program_academic(a)})),$("#careerId").trigger("change")},faculty:function(){$.ajax({type:"GET",url:"/admin/padron-de-registro/facultades/get".proto().parseURL()}).done((function(a){$("#facultyId").select2({data:a.items})})),$("#facultyId").on("change",(function(){var a=$(this).val();e.career(a)})),$("#facultyId").trigger("change")},program_academic:function(a){$.ajax({type:"GET",url:`/admin/padron-de-registro/programaacademicos/${a}/get`.proto().parseURL()}).done((function(a){$("#program_academicId").empty(),$("#program_academicId").select2({data:a.items})}))}},t=function(){$("#searchValue").doneTyping((function(){a.objects["tbl-datatable-registry-patterns"].draw()})),$("#searchDiplomaNumber").doneTyping((function(){a.objects["tbl-datatable-registry-patterns"].draw()}),2),$("#searchBookNumber").doneTyping((function(){""==$(this).val()?$("#d-zone").hide():$("#d-zone").show(),a.objects["tbl-datatable-registry-patterns"].draw()}),2),$("#officeNumber").doneTyping((function(){""==$(this).val()?$("#d-zone").hide():$("#d-zone").show(),a.objects["tbl-datatable-registry-patterns"].draw()}))},r={ajax:{type:"GET",dataType:"JSON",url:"/admin/diplomas/lista-registro-padrones".proto().parseURL(),data:function(a){a.searchDiplomaNumber=$("#searchDiplomaNumber").val(),a.searchValue=$("#searchValue").val(),a.seachBookNumber=$("#searchBookNumber").val(),a.careerId=$("#careerId").val(),a.facultyId=$("#facultyId").val(),a.academicProgramId=$("#program_academicId").val(),a.officeNumber=$("#officeNumber").val()}},columns:[{data:"request_name",name:"request_name",title:"Concepto"},{data:"type",name:"type",title:"Tipo"},{data:"user",name:"user",title:"Estudiante"},{data:"dni",name:"dni",title:"DNI"},{data:"careerName",name:"carrerName",title:"Escuela Profesional"},{data:"currentAcademicYear",name:"currentAcademicYear",title:"Ciclo"},{title:"Opciones",orderable:!1,render:function(a,e,t,r){var o="";return o+=`<button data-id="${t.id}" class="btn btn-info btn-sm m-btn m-btn--icon btn-add"><span><i class="flaticon-eye"></i><span>Ver Diploma</span></span></button>`,o+=`<div style="display:inline-block"><a data-id="${t.id}" class="btn btn-sm m-btn m-btn--icon btn-download" title="Descargar" style="width:50px!important;vertical-align: middle;border-style:none;"><img src="/images/demo/pdf.svg"/></a></div>`}}]},o=function(){a.objects["tbl-datatable-registry-patterns"]=$("#tbl-datatable-registry-patterns").DataTable(r),a.objects["tbl-datatable-registry-patterns"].on("click",".btn-add",(function(a){a.preventDefault(),$(this).addLoader();var e=$(this).data("id");location.href=`/admin/diplomas/${e}/diploma`.proto().parseURL()})),a.objects["tbl-datatable-registry-patterns"].on("click",".btn-download",(function(){var a=$(this).data("id");$.fileDownload(`/admin/diplomas/descargar/Pdf/${a}`.proto().parseURL()).done((function(){$(".btn-excel").removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(a){$(".btn-excel").removeLoader();var e,t,r=(e=a,t=document.createElement("div"),e&&"string"==typeof e&&(e=(e=e.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),t.innerHTML=e,e=t.textContent,t.textContent=""),e);toastr.error(r,"Error")}))}))};return{load:function(){e.faculty(),o(),t(),$("#btn-search-filters").on("click",(function(e){e.preventDefault(),a.objects["tbl-datatable-registry-patterns"].draw()})),$("#btn-zip").on("click",(function(a){a.preventDefault();var e=$("#searchBookNumber").val();""!==e&&($("#btn-zip").addLoader(),$.fileDownload(`/admin/diplomas/diploma-zip?searchBookNumber=${e}`.proto().parseURL()).always((function(){$("#btn-zip").removeLoader()})).done((function(){$("#btn-zip").removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(){$("#btn-zip").removeLoader(),toastr.error("No se pudo descargar el archivo","Error")})))}))}}}();$((function(){diplomas.load()}));
var InitApp=function(){var t={patterns:{object:null,options:{ajax:{url:"/admin/historial-padrones/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){delete t.columns,t.search=$("#search").val()}},columns:[{title:"Nro. Oficio",data:"number"},{title:"Descripción",data:"description"},{title:"Descargar",data:"file",width:"80px",render:function(t,a,e,n){return null!=t&&""!=t?`<button data-id="${e.id}" class="btn btn-success m-btn btn-sm m-btn--icon m-btn--icon-only btn-download"><i class="la la-download"></i></button>`:"---"}},{title:"Opciones",data:null,width:"100px",render:function(t){return`<button type="button" data-object="${t.proto().encode()}" class="btn btn-info btn-sm m-btn m-btn--icon btn-edit" title=""><i class="la la-edit"></i> Editar</button> <button class="btn btn-danger m-btn btn-sm m-btn--icon m-btn--icon-only btn-delete" data-id="${t.id}"><i class="la la-trash"></i></button>`}}]},init:function(){this.object=$("#data-table").DataTable(this.options),$("#data-table").on("click",".btn-edit",(function(t){var a=$(this).data("object");a=a.proto().decode(),e.edit.load(a)})),$("#data-table").on("click",".btn-delete",(function(t){var a=$(this).data("id");e.delete.load(a)})),$("#data-table").on("click",".btn-download",(function(t){var a=$(this).data("id");window.open(`/admin/historial-padrones/descargar/${a}`.proto().parseURL(),"_blank")}))},reload:function(){this.object.ajax.reload()}}},a=function(){$("#search").doneTyping((function(){t.patterns.reload()}))},e={create:{object:$("#create-form").validate({submitHandler:function(a){mApp.block("#enrollment_modal .modal-content");var n=new FormData($(a).get(0));$("#create-form .btn-save").addLoader(),$.ajax({url:$(a).attr("action"),type:"POST",data:n,contentType:!1,processData:!1}).done((function(a){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),swal({type:"success",title:"Tarea Completada",html:a}),t.patterns.reload(),e.create.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)})).always((function(){mApp.unblock("#enrollment_modal .modal-content"),$("#create-form .btn-save").removeLoader()}))}}),clear:function(){e.edit.object.resetForm(),$("input").val("").text(""),$("#Special").prop("checked",!1),$(".custom-file-label").text("Seleccionar Archivo...")}},edit:{object:$("#edit-form").validate({submitHandler:function(a){mApp.block("#enrollment_modal .modal-content");var n=new FormData($(a).get(0));$.ajax({url:$(a).attr("action"),type:"POST",data:n,contentType:!1,processData:!1}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.patterns.reload(),e.edit.clear()})).fail((function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)})).always((function(){mApp.unblock("#enrollment_modal .modal-content")}))}}),load:function(t){$("#edit-modal").modal("toggle"),$("#eId").val(t.id),$("#eOfficeNumber").val(t.number),$("#eDescription").val(t.description)},clear:function(){e.edit.object.resetForm()}},delete:{load:function(a){swal({title:"¿Está seguro?",text:"El padrón será eliminado permanentemente",type:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(e){e.value&&$.ajax({url:"/admin/historial-padrones/eliminar",type:"POST",data:{id:a},success:function(){t.patterns.reload(),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)},error:function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}})}))}}};return{init:function(){t.patterns.init(),a()}}}();$((function(){InitApp.init()}));
var registrypatterns=function(){var a={objects:{}},e={career:function(a){$.ajax({type:"GET",url:`/admin/padron-de-registro/carreras/${a}/get`.proto().parseURL()}).done((function(a){$("#careerId").html(null),$("#careerId").select2({data:a.items})})),$("#careerId").on("change",(function(){var a=$(this).val();e.program_academic(a)})),$("#careerId").trigger("change")},faculty:function(){$.ajax({type:"GET",url:"/admin/padron-de-registro/facultades/get".proto().parseURL()}).done((function(a){$("#facultyId").select2({data:a.items})})),$("#facultyId").on("change",(function(){var a=$(this).val();e.career(a)})),$("#facultyId").trigger("change")},program_academic:function(a){$.ajax({type:"GET",url:`/admin/padron-de-registro/programaacademicos/${a}/get`.proto().parseURL()}).done((function(a){$("#program_academicId").html(null),$("#program_academicId").select2({data:a.items})}))},type:function(){$("#type").select2({minimumResultsForSearch:-1})},clasification:function(){$("#clasification").select2({minimumResultsForSearch:-1})}},t=function(){$("#search").doneTyping((function(){a.objects["tbl-datatable-registry-patterns"].draw()})),$("#searchBookNumber").doneTyping((function(){a.objects["tbl-datatable-registry-patterns"].draw()}),2)},r={ajax:{type:"GET",dataType:"JSON",url:"/admin/padron-de-registro/lista-registro".proto().parseURL(),data:function(a){a.searchValue=$("#search").val(),a.searchBookNumber=$("#searchBookNumber").val(),a.careerId=$("#careerId").val(),a.facultyId=$("#facultyId").val(),a.academicProgramId=$("#program_academicId").val(),a.dateStartFilter=$("#dateStartFilter").val(),a.dateEndFilter=$("#dateEndFilter").val(),a.type=$("#type").val(),a.clasification=$("#clasification").val()}},columns:[{data:"request_name",name:"request_name"},{data:"type",name:"type"},{data:"user",name:"user"},{data:"dni",name:"dni"},{data:"careerName",name:"carrerName"},{orderable:!1,render:function(a,e,t,r){var n="";return t.hasGeneratedCode?n+=`<button data-id="${t.id}" class="btn btn-info btn-sm m-btn m-btn--icon btn-add"><span><i class="flaticon-eye"></i><span></span></span></button>`:n+=`<button data-id="${t.id}" class="btn btn-success btn-sm m-btn m-btn--icon btn-add"><span><i class="flaticon-cogwheel-2"></i><span>Generar Padrón</span></span></button>`,n}}]},n=function(){a.objects["tbl-datatable-registry-patterns"]=$("#tbl-datatable-registry-patterns").DataTable(r),a.objects["tbl-datatable-registry-patterns"].on("click",".btn-add",(function(a){a.preventDefault(),$(this).addLoader();var e=$(this).data("id");location.href=`/admin/padron-de-registro/${e}/gestion`.proto().parseURL()}))};return{load:function(){$("#dateStartFilter").datepicker(),$("#dateEndFilter").datepicker(),$("#dateStartFilter").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker}).on("changeDate",(function(a){$("#dateEndFilter").datepicker("setStartDate",moment(a.date).toDate())})),$("#dateEndFilter").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker}).on("changeDate",(function(a){$("#dateStartFilter").datepicker("setEndDate",a.date)})),$("#btn-search-dates").on("click",(function(e){e.preventDefault();var t=$("#dateStartFilter").val(),r=$("#dateEndFilter").val();if(null===t||null===r)return!1;a.objects["tbl-datatable-registry-patterns"].draw()})),$("#btn-search-filters").on("click",(function(e){e.preventDefault(),a.objects["tbl-datatable-registry-patterns"].draw()})),e.faculty(),e.type(),e.clasification(),n(),t(),$(".btn-excel").on("click",(function(a){a.preventDefault(),$(".btn-excel").addLoader(),$.fileDownload("/admin/padron-de-registro/reporte-excel".proto().parseURL(),{data:{careerId:$("#careerId").val(),facultyId:$("#facultyId").val(),academicProgramId:$("#program_academicId").val(),dni:$("#search").val(),searchBookNumber:$("#searchBookNumber").val(),dateStartFilter:$("#dateStartFilter").val(),dateEndFilter:$("#dateEndFilter").val(),type:$("#type").val(),clasification:$("#clasification").val()}}).always((function(){$(".btn-excel").removeLoader()})).done((function(){$(".btn-excel").removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(a){$(".btn-excel").removeLoader(),toastr.error("No se encontraron padrones generados","Error")}))})),$(".btn-excel-sunedu").on("click",(function(a){a.preventDefault(),$(".btn-excel-sunedu").addLoader(),$.fileDownload("/admin/padron-de-registro/reporte-excel-sunedu".proto().parseURL(),{data:{careerId:$("#careerId").val(),facultyId:$("#facultyId").val(),academicProgramId:$("#program_academicId").val(),dni:$("#search").val(),searchBookNumber:$("#searchBookNumber").val(),dateStartFilter:$("#dateStartFilter").val(),dateEndFilter:$("#dateEndFilter").val(),type:$("#type").val(),clasification:$("#clasification").val()}}).always((function(){$(".btn-excel-sunedu").removeLoader()})).done((function(){$(".btn-excel-sunedu").removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(a){$(".btn-excel-sunedu").removeLoader(),toastr.error("No se encontraron padrones generados","Error")}))}))}}}();$((function(){registrypatterns.load()}));
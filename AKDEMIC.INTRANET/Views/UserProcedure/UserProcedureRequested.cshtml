@using AKDEMIC.INTRANET.ViewModels.UserProcedureViewModels
@model UserProcedureViewModel
@{
    ViewBag.Tittle = $"Continuación del Trámite - " + '"' + $"{Model.NameProcedure}" + '"';
    ViewBag.Subtittle = "Solicitar Trámite";
    ViewData["Breadcrumbs"] = new[] {
new BreadcrumbViewData { Name = "Listado de Trámites de Usuarios", Controller = "UserProcedure", Action = "Index"},
};
}

@section Styles {
    <link href="~/assets/css/cropper/cropper.css" rel="stylesheet" />
}
<div class="m-content">
    <div class="m-portlet">
        <div class="m-portlet__head">
            <div class="m-portlet__head-caption">
                <div class="m-portlet__head-title">
                    <h3 class="m-portlet__head-text">
                        @ViewBag.Tittle
                    </h3>
                </div>
            </div>
        </div>
        <div class="m-portlet__body">

            <div class="row mt-2 ml-2">
                <div class="col-lg-6">
                    <div class="row">
                        <div class="col-lg-12">
                            <h5><strong> Requisitos</strong></h5>
                        </div>
                        @foreach (var item in Model.ProcedureRequirement)
                        {
                            <div class="col-lg-6 mt-2" style="color:#1b1b1b;font-size:15px; font-weight: 400;">
                                - @item.Name :
                            </div>
                            <div class="col-lg-6 mt-2" style="color:#1b1b1b;font-size:15px; font-weight: 400;">
                                S/. @item.Cost
                            </div>
                        }
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="row">

                        <div class="col-lg-12">
                            <h5><strong>Autoridad competente a cargo</strong></h5>
                        </div>

                        @foreach (var item in Model.Dependencies)
                        {
                            <div class="col-lg-12 mt-2" style="color:#1b1b1b;font-size:15px; font-weight: 400;">
                                - @item.Name
                            </div>
                        }
                    </div>

                    <div class="row mt-5">

                        <div class="col-lg-12">
                            <h5><strong>D&iacute;as H&aacute;biles</strong></h5>
                        </div>

                        @if (Model.Duration == 1)
                        {
                            <div class="col-lg-12" style="font-size:15px; font-weight: 400;">
                                @Model.Duration d&iacute;a
                            </div>
                        }
                        else
                        {
                            <div class="col-lg-12" style="font-size:15px; font-weight: 400;">
                                @Model.Duration d&iacute;as
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="m-portlet">

        <form id="procedure-modal-request-form" class="m-form m-form--label-align-right m-form--state" asp-action="UpdateUserProcedure" asp-controller="UserProcedure" enctype="multipart/form-data">
            <div class="m-portlet__head">
                <div class="m-portlet__head-caption">
                    <div class="m-portlet__head-title">
                        <h3 class="m-portlet__head-text">
                            @ViewBag.Subtittle
                        </h3>
                    </div>
                </div>
                <div class="m-portlet__head-icon">
                    <div class="m-portlet__foot m-portlet__foot--fit m--align-right m--margin-top-10">
                        <button id="btnSave" name="Send" type="submit" class="btn btn-primary">
                            <span class="ladda-label">
                                <i class="la la-send"></i>
                                &nbsp; Enviar Solicitud
                            </span>
                            <span class="ladda-spinner">
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="m-portlet__body">

                <input name="Id" type="hidden" value="@Model.Id">

                <input asp-for="ProcedureId" type="hidden">

                <input type="hidden" asp-for="urlCropImg" value="" />
                <input type="hidden" asp-for="HasReceipt" id="hasReceipt" value="false" />
                <input type="hidden" asp-for="HasPicture" id="hasPicture" value="@Model.HasPicture" />

                <div class="form-group m-form__group row">
                    @if (Model.HasPicture)
                    {
                        <div class="col-lg-6">
                            <div class="row">

                                <div class="col-lg-10 align-self-center">
                                    <label asp-for="Comment">Sustento</label>
                                    <textarea name="Comment" class="form-control m-input disable-resize" placeholder="Sustento del Trámite" rows="9" required></textarea>
                                </div>
                            </div>

                        </div>

                        <div class="col-lg-6">
                            <div class="row">
                                <div class="col-lg-12 align-self-center">
                                    <label class="form-control-label">Registra tu fotograf&iacute;a</label>
                                    <div class="row align-items-center">
                                        <div class="col-md-10 pr-0">
                                            <input id="imageFile" style="font-family:Montserrat;" type="text" class="form-control m-input" value="" placeholder="Adjuntar Fotografía" disabled />
                                        </div>
                                        <div class="col-md-2 text-center pl-0">
                                            <a href="#" class="btn btn-primary btn-sm m-btn m-btn--icon m--margin-left-5 btn-image" title="Agregar Portada">
                                                <i class="la la-plus"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12 align-self-center mt-2">
                                    <div class="m-form__group-sub col-lg-12 col-xs-12 upload-demo-wrap">
                                        <div id="upload-offi" style="text-align:center">
                                            <img id="img-offi-preview" style="width: 200px; height:200px;" src="/images/demo/user.png" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="col-lg-12">
                            <label asp-for="Comment">Sustento</label>
                            <textarea name="Comment" class="form-control m-input disable-resize" placeholder="Sustento del Trámite" rows="5" required></textarea>
                        </div>
                    }
                </div>

                <div class="m-form__heading m--margin-top-20">
                    <h5 class="m-form__custom-heading-subtitle">Requisitos del Trámite</h5>
                </div>

                <div class="form-group m-form__group row">
                    <div class="col-lg-12 m-form__group-sub">
                        <label asp-for="DocumentFiles">Documentos</label>
                        <div class="custom-file">
                            <input id="DocumentFiles" type="file" class="custom-file-input" placeholder="Documentos" accept="application/*" multiple>
                            <label class="custom-file-label" for="SignatureFile">Seleccione archivos</label>
                        </div>
                    </div>
                </div>

                <div class="form-group m-form__group row">
                    <div class="m-form__group-sub col-lg-12">
                        <table class="table table-striped table-bordered" id="tbl-files">
                            <thead>
                                <tr>
                                    <th>Nombre de Archivo</th>
                                    @*<th>Tamaño</th>*@
                                    <th>Opción</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>

            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="image-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-primary font-weight-bold">
                    Fotograf&iacute;a formal en formato digital
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="form-group m-form__group row m-form__group--first align-items-center" style="margin:10px;">

                    <div class="col-lg-6">
                        <div class="m-form__group-sub col-lg-12">
                            <label asp-for="Image" class="required-form-label">Registra tu fotograf&iacute;a</label>
                            <div class="m-input-icon m-input-icon--right">
                                <div class="custom-file">
                                    <input id="Image" asp-for="Image" type="file" class="custom-file-input" accept="image/*" required />
                                    <label class="custom-file-label" for="customFile">Adjuntar imagen</label>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="m-form__group-sub col-lg-12 upload-demo-wrap">
                                <div id="upload-offi" style="padding-bottom:30px;text-align:center">
                                    <img id="img-offi" style="width: 300px; height:300px;max-width: 100%;" src="/images/demo/user.png" />
                                    <p style="font-weight:bold; margin-top:10px; text-align:center">Resolución de la imagen recomendada: <span style="color:#8b0404;">aprox 300px x 300px</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 align-self-center">
                        <div class="preview" style="overflow: hidden;"></div>
                    </div>

                </div>

                <div class="m--margin-top-60"></div>

                <div class="form-group m-form__group row text-center">
                    <div class="m-form__group-sub col-md-12 col-lg-12 col-xs-12">
                        <button id="btnCropSave" class="btn btn-lg btn-primary text-center" type="submit">Recortar y Guardar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="receipt-modal" role="dialog" aria-labelledby="receiptModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-primary font-weight-bold" id="receipt-modal-label">
                    Agregar Recibo de Pago
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <form id="create-receipt-form" class="m-form m-form--state m-form--fit m-form--label-align-right" asp-action="ValidateReceipt" asp-controller="UserProcedure">
                <div class="modal-body tab-content m-portlet__body">
                    <div class="m-alert m-alert--icon alert alert-danger m--hide" role="alert" id="add_reference_msg">
                        <div class="m-alert__icon">
                            <i class="la la-warning"></i>
                        </div>
                        <div class="m-alert__text" id="add_form_msg_txt">
                            Oh rayos! Ocurri&oacute; un error en el servidor
                        </div>
                        <div class="m-alert__close">
                            <button type="button" class="close" data-close="alert" aria-label="Close"></button>
                        </div>
                    </div>
                    <input type="hidden" asp-for="HasReceipt" value="@Model.HasReceipt" />
                    <input type="hidden" asp-for="ConceptId" value="@Model.ConceptId" />
                    <div class="row">
                        <div class="form-group m-form__group col-lg-12">
                            <label asp-for="PaymentReceipt.Datetime">Fecha</label>
                            <div class="input-group">
                                <input asp-for="PaymentReceipt.Datetime" class="form-control m-input date-picker" required />
                                <div class="input-group-append"><span class="input-group-text"><i class="la la-calendar"></i></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group m-form__group col-lg-12">
                            <label asp-for="PaymentReceipt.Sequence">Secuencia</label>
                            <div class="input-group">
                                <input asp-for="PaymentReceipt.Sequence" class="form-control m-input" required />
                                <div class="input-group-append"><span class="input-group-text"><i class="la la-sort-numeric-asc"></i></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group m-form__group col-lg-12">
                            <label asp-for="PaymentReceipt.Amount">Monto</label>
                            <div class="input-group">
                                <input asp-for="PaymentReceipt.Amount" class="form-control m-input" type="number" required />
                                <div class="input-group-append"><span class="input-group-text"><i class="la la-money"></i></span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                        Cerrar
                    </button>
                    <button id="btnAddReceipt" type="submit" class="btn btn-primary ladda-button" data-style="slide-down">
                        <span class="ladda-label">Guardar</span>
                        <span class="ladda-spinner"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/modules/file.js"></script>
    <script src="~/js/modules/form.js"></script>
    <script src="~/js/modules/select.js"></script>
    <script src="~/js/modules/unit.js"></script>
    <script src="~/js/views/userprocedure/continuetUserProcedure.js" asp-append-version="true"></script>
    <script src="~/js/lib/cropper/cropper.js"></script>
}
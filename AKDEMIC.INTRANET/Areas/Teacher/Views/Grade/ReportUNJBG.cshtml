@model AKDEMIC.INTRANET.Areas.Teacher.Models.GradeViewModels.ActaScoresViewModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Acta de notas</title>
    <style>
        body {
            font-family: "Calibri";
            font-size: 13px;
        }

        h1 {
            margin-bottom: 5px !important;
            font-size: 28px;
        }

        h2 {
            margin: 0px;
            font-size: 18px;
        }

        img {
            top: 0;
            left: 0;
            max-height: 60px;
        }

        header {
            width: 100%;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-weight: normal;
        }

        tr {
            page-break-inside: avoid;
        }


        th {
            page-break-inside: avoid;
        }

        .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .unbordered {
            border: 0px;
            padding: 3px 3px !important;
        }
        .no-background{
            background-color:transparent !important;
        }
        .unbordered {
            border: 0px !important;
            padding: 3px 3px !important;
        }
        th {
            font-weight: normal;
            text-align: left;
        }

        .red {
            color: red;
        }

        .bold {
            font-weight: bold;
            background-color: lightgray;
        }

        .center {
            text-align: center;
        }

        .header2 {
            font-size: 10px;
            padding: 3px 0px !important;
        }

        .header > th, td {
            border: 1px solid black;
            padding: 5px 3px !important;
        }

        .td-header {
            border: none;
            padding: 0px !important;
        }

        .detail-header {
            font-size: 11px;
            text-align: left;
            font-weight: 600;
        }

        .footer {
            font-size: 15px;
            text-align: center;
            font-style: italic;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: -6px;
        }

        .thd {
            border: 1px solid black;
            padding: 5px;
            font-size: 13px;
        }

        .negrita {
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        .unk-header {
            width: 100%;
            text-align: center;
            margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <table>
        <thead class="headerformat" style="height:100px;">
            <tr class="unbordered" style="height:100px;">
                <th colspan="1" style="text-align: center;padding: 0px 20px;">
                    @*<img style="top: 0; left: 0; height: 100px;width:auto" src="@Model.Img" />*@
                </th>
                <th colspan="5">
                    <div class="unk-header center" style="font-size:18px;">
                        <p style="margin:0px;text-transform: uppercase" class="negrita">@GeneralHelpers.GetInstitutionName() - @GeneralHelpers.GetInstitutionLocation()</p>
                        <p style="margin:0px;" class="negrita">FACULTAD DE @Model.BasicInformation.Faculty.ToUpper()</p>
                        <p style="margin:0px;font-size:28px" class="negrita">ACTA FINAL</p>
                    </div>
                </th>
            </tr>
            <tr class="unbordered" style="">
                <th class="unbordered" colspan="6" style="padding:unset !important">
                    <table class="unbordered">
                        <tbody class="unbordered">
                            <tr class="unbordered">
                                <td class="bold unbordered no-background" style="width:9%">CAR.PROF:</td>
                                <td class="unbordered">@Model.BasicInformation.Career</td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>
                            </tr>
                            <tr class="unbordered">
                                <td class="bold unbordered no-background">ASIGNATURA:</td>
                                <td class="unbordered">@Model.BasicInformation.Course</td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>
                                <td class="unbordered"></td>                             
                            </tr>
                            <tr class="unbordered">
                                <td class="bold unbordered no-background">PERIODO:</td>
                                <td class="unbordered no-background">@Model.BasicInformation.Term</td>
                                <td class="bold unbordered no-background" style="width:18%">AÑO/SEMEST:</td>
                                <td class="unbordered">@(Model.BasicInformation?.Cycle != 0 ? ConstantHelpers.ACADEMIC_YEAR.TEXT[Convert.ToInt32(Model.BasicInformation?.Cycle)].ToUpper():"-")</td>
                                <td class="bold unbordered no-background" style="width:11%;">CREDITOS:</td>
                                <td class="unbordered" style="width:6%;">@Model.BasicInformation.Credits</td>                               
                            </tr>
                            <tr class="unbordered">
                                <td class="bold unbordered no-background" style="width:9%">DOCENTE:</td>
                                <td class="unbordered">@Model.BasicInformation.Teacher</td>
                                <td class="bold unbordered no-background" style="width:9%">TURNO:</td>
                                <td class="unbordered"></td>
                                <td class="bold unbordered no-background">SECCION:</td>
                                <td class="unbordered">@Model.BasicInformation.Section</td>
                            </tr>
                        </tbody>
                    </table>
                    <br />
                    <br />
                </th>
            </tr>

            <tr class="bordered">
                <th rowspan="2" class="bold center bordered">N°</th>
                <th rowspan="2" class="bold center bordered">CÓDIGO</th>
                <th rowspan="2" colspan="2" class="bold center bordered">APELLIDOS Y NOMBRES</th>
                <th colspan="2" class="bold center bordered"> PROMEDIO FINAL </th>
            </tr>
            <tr class="bordered">
                <th class="bold center bordered">N°</th>
                <th class="bold center bordered">Letras</th>
            </tr>
        </thead>

        <tbody>
            @for (var i = 0; i < Model.Rows.Count; i++)
            {
                <tr class="bordered">
                    <th class="thd center">@Model.Rows[i].Order</th>
                    <th class="thd" style="border-right:0px !important;">@Model.Rows[i].Code</th>
                    <th class="thd" colspan="2" style="border-right:0px !important;">@Model.Rows[i].Surnames, @Model.Rows[i].Names</th>

                    @if (Model.Rows[i].StudentStatus != ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN)
                    {
                        if (Model.Rows[i].FinalEvaluationNumber < Model.Approbed)
                        {
                            <th class="red thd">@Model.Rows[i].FinalEvaluation @(Model.Rows[i].HasSusti ? "(SUSTI)" : "")</th>
                            <th class="red thd">@Model.Rows[i].FinalEvaluationText</th>
                        }
                        else
                        {
                            <th class="thd" style="font-weight:bold;">@Model.Rows[i].FinalEvaluation  @(Model.Rows[i].HasSusti ? "(SUSTI)" : "")</th>
                            <th class="thd">@Model.Rows[i].FinalEvaluationText</th>
                        }
                    }
                    else
                    {
                        <th class="red thd">R</th>
                        <th class="red thd">RETIRADO</th>
                    }
                </tr>
            }
            @if (Model.Rows.Count == 0)
            {
                <tr class="bordered">
                    <th class="center" colspan="6">No hay estudiantes en la sección</th>
                </tr>
            }

        </tbody>
        <tfoot>
            <tr class="unbordered">
                <th  class="unbordered" colspan="6">
                    <br />
                    <table>
                        <tr>
                            @{
                                var app = (Model.Rows.Count(x => x.FinalEvaluationNumber >= Model.Approbed));
                                var disapp = (Model.Rows.Count(x => x.FinalEvaluationNumber < Model.Approbed && x.StudentStatus != ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN));
                                var ret = (Model.Rows.Count(x => x.StudentStatus == ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN));
                            }
                            <td class="bold no-background">REFERENCIAS</td>
                            <td class="">MATRICULADOS: <span class="bold no-background"> @Model.Rows.Count()</span></td>
                            <td class="" colspan="2">APROBADOS: <span class="bold no-background"> @app</span></td>
                            <td class="" colspan="2">DESAPROBADOS: <span class="bold no-background"> @disapp</span></td>
                            <td class="">RETIRADOS / OTROS: <span class="bold no-background"> @ret</span></td>
                        </tr>
                        <tr>
                            <td colspan="3" class="bold no-background">ELABORADO POR: <span style="font-style:normal">@Model.BasicInformation?.User</span></td>
                            <td colspan="2" rowspan="2" class="bold center no-background" style="">Fecha Acta: <br />@DateTime.UtcNow.ToLocalDateFormat()</td>
                            <td colspan="2" rowspan="2" class="bold no-background" style="vertical-align:top;font-size:10px">FIRMA DOCENTE:</td>
                        </tr>
                        <tr>
                            <td colspan="3" class="bold no-background" style="color:transparent">|</td>
                        </tr>
                    </table>                
                </th>               
            </tr>
            <tr class="unbordered">
                <th class="unbordered" colspan="6">
                    La nota minima de aprobación es 11 en la escala vigesimal de 00 a 20
                </th>
                <th class="unbordered" colspan="2" style="text-align:right">
                   
                </th>
            </tr>
            <tr class="unbordered" style="height:70px;vertical-align:bottom">
                <th colspan="3" class="center" style="padding:0 20px;">
                    <div style="border-bottom:1px solid black;height:inherit;margin:0;padding:0;color:transparent">|||||</div>
                </th>
                <th colspan="3" class="center" style="padding:0 20px;">
                    <div style="border-bottom:1px solid black;height:inherit;margin:0;padding:0;color:transparent">|||||</div>
                </th>
            </tr>
            <tr class="unbordered">
                <th colspan="3" class="center" style="vertical-align:top">
                    DRA. CACHIATARI VARGAS ELENA
                </th>
                <th colspan="3" class="center" style="vertical-align:top">
                    MGR. OBST. BARREDA GRADOS JUANA IN&Eacute;S
                </th>
            </tr>
        </tfoot>
    </table>
    <br />
</body>
</html>

@model AKDEMIC.INTRANET.Areas.Teacher.Models.GradeViewModels.ActaScoresViewModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Acta de notas</title>
    <style>
        body {
            font-family: "Calibri";
            font-size: 13px;
        }

        h1 {
            margin-bottom: 5px !important;
            font-size: 28px;
        }

        h2 {
            margin: 0px;
            font-size: 18px;
        }

        img {
            top: 0;
            left: 0;
            max-height: 60px;
        }

        header {
            width: 100%;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-weight: normal;
        }

        tr {
            page-break-inside: avoid;
        }


        th {
            page-break-inside: avoid;
        }

        tbody .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .unbordered {
            border: 0px;
            padding: 3px 3px !important;
        }

        th {
            font-weight: normal;
            text-align: left;
        }

        .red {
            color: red;
        }

        .bold {
            font-weight: bold;
            background-color: lightgray;
        }

        .center {
            text-align: center;
        }

        .header2 {
            font-size: 10px;
            padding: 3px 0px !important;
        }

        .header > th, td {
            border: 1px solid black;
            padding: 5px 3px !important;
        }

        .td-header {
            border: none;
            padding: 0px !important;
        }

        .detail-header {
            font-size: 11px;
            text-align: left;
            font-weight: 600;
        }

        .footer {
            font-size: 15px;
            text-align: center;
            font-style: italic;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: -6px;
        }

        .thd {
            border: 1px solid black;
            padding: 5px;
            font-size: 13px;
        }

        .negrita {
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        .unk-header {
            width: 100%;
            text-align: center;
            margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <table>
        <thead class="headerformat" style="height:100px;">
            <tr class="unbordered" style="height:100px;">
                <th colspan="1" style="text-align: center;padding: 0px 20px;">
                    <img style="top: 0; left: 0; height: 100px;width:auto" src="@Model.Img" />
                </th>
                <th colspan="5">
                    <div class="unk-header center" style="font-size:18px;">
                        <p style="margin:0px;text-transform: uppercase" class="negrita">@GeneralHelpers.GetInstitutionName()</p>
                        <p style="margin:0px;" class="negrita">ACTA DE NOTAS</p>
                    </div>
                </th>
            </tr>
            <tr class="unbordered" style="">
                <th colspan="6" style="padding:unset !important">
                    <table class="header">
                        <tbody>
                            <tr>
                                <td class="bold" style="width:9%">DOCENTE:</td>
                                <td colspan="3">@Model.BasicInformation.Teacher</td>
                                <td class="bold">SEMESTRE ACADÉMICO:</td>
                                <td>@Model.BasicInformation.Term</td>
                            </tr>
                            <tr>
                                <td class="bold">CURSO:</td>
                                <td style="width:45%">@Model.BasicInformation.Course</td>
                                <td class="bold" style="width:11%;">CRÉDITOS:</td>
                                <td style="width:6%;">@Model.BasicInformation.Credits</td>
                                <td class="bold" style="width:18%">CICLO DEL CURSO:</td>
                                <td>@Model.BasicInformation.Cycle</td>
                            </tr>
                            <tr>
                                <td class="bold">ESCUELA:</td>
                                <td>@Model.BasicInformation.Career</td>
                                <td class="bold">SEDE:</td>
                                <td>@Model.BasicInformation.Sede</td>
                                <td class="bold">SECCIÓN:</td>
                                <td>@Model.BasicInformation.Section</td>
                            </tr>
                        </tbody>
                    </table>
                    <br />
                    <br />
                    <br />
                </th>
            </tr>

            <tr class="bordered">
                <th class="bold center">N°</th>
                <th class="bold center">Estudiante</th>
                <th class="bold center">Apellidos y Nombres</th>
                <th class="bold center">Nota</th>
                <th class="bold center">Descripción</th>
                <th class="bold center">Observación</th>

            </tr>
        </thead>

        <tbody>
            @for (var i = 0; i < Model.Rows.Count; i++)
            {
            <tr class="bordered">
                <th class="thd center">@Model.Rows[i].Order</th>
                <th class="thd" style="border-right:0px !important;">@Model.Rows[i].Code</th>
                <th class="thd" style="border-right:0px !important;">@Model.Rows[i].Surnames, @Model.Rows[i].Names</th>
                @if (!Model.Rows[i].Withdrawn)
                {
                    if (Model.Rows[i].FinalEvaluationNumber < Model.Approbed)
                    {
                        <th class="red thd">@Model.Rows[i].FinalEvaluation @(Model.Rows[i].HasSusti ? "(SUSTI)" : "")</th>
                        <th class="red thd">@Model.Rows[i].FinalEvaluationText</th>
                    }
                    else
                    {
                        <th class="thd" style="font-weight:bold;">@Model.Rows[i].FinalEvaluation  @(Model.Rows[i].HasSusti ? "(SUSTI)" : "")</th>
                        <th class="thd">@Model.Rows[i].FinalEvaluationText</th>
                    }
                }
                else
                {
                    <th class="red thd">R</th>
                    <th class="red thd">RETIRADO</th>
                }
                <th class="thd"></th>
            </tr>
            }
            @if (Model.Rows.Count == 0)
            {
                <tr class="bordered">
                    <th class="center" colspan="6">No hay estudiantes en la sección</th>
                </tr>
            }

            <tr style="border:unset !important">
                <th colspan="2" style="border:unset !important">
                    <table>
                        <tr>
                            <td><b>Resumen</b></td>
                            <td># Estudiantes</td>
                            <td>Porcentual</td>
                        </tr>
                        <tr>
                            <td><b>Matriculados</b></td>
                            <td>@Model.Rows.Count()</td>
                            <td>@((Model.Rows.Count() * 100 > 0) ? (Model.Rows.Count() * 100 / Model.Rows.Count()) : 0)%</td>
                        </tr>
                        <tr>
                            <td><b>Aprobados</b></td>
                            @{
                                var app = (Model.Rows.Count(x => x.FinalEvaluationNumber >= Model.Approbed));
                            }
                            <td>@app</td>
                            <td>@((app * 100) > 0 ? (app * 100) / Model.Rows.Count() : 0)%</td>
                        </tr>
                        <tr>
                            <td><b>Desaprobados</b></td>
                            @{
                                var disapp = (Model.Rows.Count(x => x.FinalEvaluationNumber < Model.Approbed && !x.Withdrawn));
                            }
                            <td>@disapp</td>
                            <td>@((disapp * 100) > 0 ? (disapp * 100) / Model.Rows.Count() : 0)%</td>
                        </tr>
                        @*<tr>
                                <td><b>No rindió</b></td>
                                <td></td>
                                <td></td>
                            </tr>*@
                        <tr>
                            <td><b>Retirados</b></td>
                            @{
                                var ret = (Model.Rows.Count(x => x.Withdrawn));
                            }
                            <td>@ret</td>
                            <td>@((ret * 100) > 0 ? (ret * 100) / Model.Rows.Count() : 0)%</td>
                        </tr>
                    </table>
                </th>
                <th colspan="4" style="border:unset !important">
                    <table>
                        <tr style="height:60px">
                            <th>

                            </th>
                            <th style="text-align:right">
                                <table>
                                    <tr style="text-align:center">
                                        <td>@DateTime.Now.Day</td>
                                        <td>@DateTime.Now.Month</td>
                                        <td>@DateTime.Now.Year</td>
                                    </tr>
                                </table>
                            </th>
                        </tr>
                        <tr style="height:60px">
                            <th>
                                <div style="border-top:1px solid black; height:inherit; text-align:center;margin:5px">
                                    FIRMA DOCENTE
                                </div>
                            </th>
                            <th>

                            </th>
                        </tr>
                        <tr style="height:60px">
                            <th>
                                <div style="border-top:1px solid black; height:inherit; text-align:center;margin:5px">
                                    VB. de Jefatura
                                </div>
                            </th>
                            <th>
                                <div style="border-top:1px solid black; height:inherit; text-align:center;margin:5px">
                                    VB. de DUAA
                                </div>
                            </th>
                        </tr>
                    </table>
                </th>
            </tr>
        </tbody>
    </table>
    <br />
</body>
</html>

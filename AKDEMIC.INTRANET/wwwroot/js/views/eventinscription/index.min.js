var Events=function(){var e=null,t=$("#table-events"),n={paginate:function(){var n=0;t.bind("repaginate",(function(){t.find("tbody tr").hide().slice(3*n,3*(n+1)).show()})),t.trigger("repaginate");var a=t.find("tbody tr").length;console.log(a);for(var r=Math.ceil(a/3),o=$('<div class="pager"></div>'),s=0;s<r;s++)$('<span class="page-number"></span>').text(s+1).bind("click",{newPage:s},(function(e){n=e.data.newPage,t.trigger("repaginate"),$(this).addClass("active").siblings().removeClass("active")})).appendTo(o).addClass("clickable");o.insertAfter(t).find("span.page-number:first").addClass("active"),$(".btn-inscription").on("click",(function(){var e=$(this).data("id");swal({title:"¿Está seguro?",text:"El usuario será inscrito",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, inscribir",confirmButtonClass:"btn btn-success m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((t=>{$.ajax({url:"/inscripcion_eventos/agregar",type:"POST",data:{id:e},success:function(e){swal({type:"success",title:"Completado",text:"El usuario ha sido inscrito con éxito",confirmButtonText:"Excelente"}),location.reload()},error:function(e){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"No se pudo registrar la inscripción, es posible que ya esté registrado."})}})}))})})),$(".btn-read-more").on("click",(function(){var t=$(this).data("id");e=t,$.ajax({url:"/inscripcion_eventos/getEvent",type:"POST",data:{id:t},success:function(e){i.files.reload();var t=$("#detail_modal");t.find(".event-name").text(e.eventName),t.find(".event-date").text(e.eventDate),t.find(".event-image").attr("src",`/imagenes/${e.pathPicture}`),t.find(".event-range").text(`Desde : ${e.registrationStartDate} Hasta : ${e.registrationEndDate}`),t.find(".event-type").text(e.eventTypeName),t.find(".event-creator").text(e.creator),t.find(".event-description").text(e.description),null!=e.urlVideo&&""!=e.urlVideo?($(".url_container").removeClass("d-none"),t.find(".event-urlvideo").attr("href",urlVideo)):$(".url_container").addClass("d-none")},error:function(e){}})}))},init:function(){$.ajax({url:("/inscripcion_eventos/getEvents/"+$("#select_eventtype").val()).proto().parseURL(),type:"POST",success:function(e){$("#table-events tbody").append(e),n.paginate()}})}},i={files:{object:null,options:{ajax:{url:"/inscripcion_eventos/get-archivos",type:"GET",data:function(t){t.eventId=e}},columns:[{data:"name",title:"Nombre"},{data:null,title:"Archivo",render:function(e){return`<a href="/documentos/${e.urlFile}" target="_blank" class="btn btn-primary btn-sm m-btn m-btn--icon" title="Descargar"><span><i class="la la-download"></i><span>Descargar</span></span></a> `}}]},reload:function(){null==i.files.object?i.files.object=$("#table_files").DataTable(i.files.options):i.files.reload()}}};return{init:function(){n.init(),$.ajax({url:"/inscripcion_eventos/getEventTypes".proto().parseURL()}).done((function(e){$("#select_eventtype").select2({data:e.eventTypes}).on("change",(function(e){$(".pager").remove(),$("#table-events tbody").empty(),n.init()}))}))}}}();$((function(){Events.init()}));
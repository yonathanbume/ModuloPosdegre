var Notifications=function(){var t=[],i=[],e=function(){$(".sendAlert").on("click",(function(){var t=$(this);t.addLoader(),$.ajax({url:"/alertaInstitucional/enviar".proto().parseURL(),type:"POST",success:function(i){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.removeLoader()},error:function(){toastr.error("Error al enviar la alerta",_app.constants.toastr.title.error),t.removeLoader()}})})),$(".m_topbar_notification_icon").click((function(){0===i.length&&open&&setTimeout((function(){$(".m-list-timeline__item.new").removeClass("new")}),3e3)}))},s=function(){$.ajax({type:"GET",url:"/notification/get",success:function(i){t=i.result,$("#topbar_notifications_notifications_1 .m-list-timeline__items").empty(),$("#topbar_notifications_notifications_1 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_messages_1 .m-list-timeline__items").empty(),$("#topbar_notifications_messages_1 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_notifications_2 .m-list-timeline__items").empty(),$("#topbar_notifications_notifications_2 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_messages_2 .m-list-timeline__items").empty(),$("#topbar_notifications_messages_2 .m-stack--ver.m-stack--general").remove(),$(".number-notification").text(i.pending),i.pending>0&&$(".m_topbar_notification_icon .m-nav__link-badge").addClass("m-badge");var e=$("#topbar_notifications_notifications_1 .m-scrollable"),s=$("#topbar_notifications_notifications_2 .m-scrollable"),a=$("#topbar_notifications_messages_1 .m-scrollable"),n=$("#topbar_notifications_messages_2 .m-scrollable");t.length<=0?($("#topbar_notifications_notifications_1 .m-list-timeline .m-list-timeline--skin-light").remove(),$("#topbar_notifications_notifications_2 .m-list-timeline .m-list-timeline--skin-light").remove(),e.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen notificaciones.</span></div></div>"),s.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen notificaciones.</span></div></div>")):$.each(t,(function(t,i){$("#topbar_notifications_notifications_1 .m-list-timeline__items").append("<div class='m-list-timeline__item new"+(!0===i.readed?" m-list-timeline__item--read":"")+"'><span class='m-list-timeline__badge'></span><span class='m-list-timeline__text'>"+(""!==i.url?"<a href='/redirect/"+i.id+"' class='m-link'>":"")+i.text+"</a>"+(""!==i.state_text?" <span class='m-badge "+i.background_state_class+" m-badge--wide'>"+i.state_text+"</span>":"")+"</span><span class='m-list-timeline__time'>"+i.date+"</span></div>"),$("#topbar_notifications_notifications_2 .m-list-timeline__items").append("<div class='m-list-timeline__item new"+(!0===i.readed?" m-list-timeline__item--read":"")+"'><span class='m-list-timeline__badge'></span><span class='m-list-timeline__text'>"+(""!==i.url?"<a href='/redirect/"+i.id+"' class='m-link'>":"")+i.text+"</a>"+(""!==i.state_text?" <span class='m-badge "+i.background_state_class+" m-badge--wide'>"+i.state_text+"</span>":"")+"</span><span class='m-list-timeline__time'>"+i.date+"</span></div>")})),i.messages.length<=0?($("#topbar_notifications_messages_1 .m-list-timeline .m-list-timeline--skin-light").remove(),$("#topbar_notifications_messages_2 .m-list-timeline .m-list-timeline--skin-light").remove(),a.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen mensajes.</span></div></div>"),n.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen mensajes.</span></div></div>")):(i.messages.forEach((function(t,i){let e='<div class="m-list-timeline__item">';e+='         <span class="m-list-timeline__badge -m-list-timeline__badge--state-success"></span>',e+=`         <span class="m-list-timeline__text"><strong>${t.title}</strong><p>${t.message}</p></span>`,e+=`         <span class="m-list-timeline__time">${t.createdAt}</span>`,e+="   </div>",$("#topbar_notifications_messages_1 .m-list-timeline__items").append(`${e}`)})),i.messages.forEach((function(t,i){let e='<div class="m-list-timeline__item">';e+='         <span class="m-list-timeline__badge -m-list-timeline__badge--state-success"></span>',e+=`         <span class="m-list-timeline__text"><strong>${t.title}</strong><p>${t.message}</p></span>`,e+=`         <span class="m-list-timeline__time">${t.createdAt}</span>`,e+="   </div>",$("#topbar_notifications_messages_2 .m-list-timeline__items").append(`${e}`)})))},complete:function(){}})},a=function(){$.ajax({type:"GET",url:"/notification/get",success:function(i){t=i.result,$("#topbar_notifications_notifications_1 .m-list-timeline__items").empty(),$("#topbar_notifications_notifications_1 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_messages_1 .m-list-timeline__items").empty(),$("#topbar_notifications_messages_1 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_notifications_2 .m-list-timeline__items").empty(),$("#topbar_notifications_notifications_2 .m-stack--ver.m-stack--general").remove(),$("#topbar_notifications_messages_2 .m-list-timeline__items").empty(),$("#topbar_notifications_messages_2 .m-stack--ver.m-stack--general").remove(),$(".number-notification").text(i.pending),i.pending>0&&$(".m_topbar_notification_icon .m-nav__link-badge").addClass("m-badge");var e=$("#topbar_notifications_notifications_1 .m-scrollable"),s=$("#topbar_notifications_notifications_2 .m-scrollable"),a=$("#topbar_notifications_messages_1 .m-scrollable"),n=$("#topbar_notifications_messages_2 .m-scrollable");t.length<=0?($("#topbar_notifications_notifications_1 .m-list-timeline .m-list-timeline--skin-light").remove(),$("#topbar_notifications_notifications_2 .m-list-timeline .m-list-timeline--skin-light").remove(),e.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen notificaciones.</span></div></div>"),s.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen notificaciones.</span></div></div>")):$.each(t,(function(t,i){$("#topbar_notifications_notifications_1 .m-list-timeline__items").append("<div class='m-list-timeline__item new"+(!0===i.readed?" m-list-timeline__item--read":"")+"'><span class='m-list-timeline__badge'></span><span class='m-list-timeline__text'>"+(""!==i.url?"<a href='/redirect/"+i.id+"' class='m-link'>":"")+i.text+"</a>"+(""!==i.state_text?" <span class='m-badge "+i.background_state_class+" m-badge--wide'>"+i.state_text+"</span>":"")+"</span><span class='m-list-timeline__time'>"+i.date+"</span></div>"),$("#topbar_notifications_notifications_2 .m-list-timeline__items").append("<div class='m-list-timeline__item new"+(!0===i.readed?" m-list-timeline__item--read":"")+"'><span class='m-list-timeline__badge'></span><span class='m-list-timeline__text'>"+(""!==i.url?"<a href='/redirect/"+i.id+"' class='m-link'>":"")+i.text+"</a>"+(""!==i.state_text?" <span class='m-badge "+i.background_state_class+" m-badge--wide'>"+i.state_text+"</span>":"")+"</span><span class='m-list-timeline__time'>"+i.date+"</span></div>")})),i.messages.length<=0?($("#topbar_notifications_messages_1 .m-list-timeline .m-list-timeline--skin-light").remove(),$("#topbar_notifications_messages_2 .m-list-timeline .m-list-timeline--skin-light").remove(),a.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen mensajes.</span></div></div>"),n.prepend("<div class='m-stack m-stack--ver m-stack--general' style='min-height: 180px;'><div class='m-stack__item m-stack__item--center m-stack__item--middle'><span>No existen mensajes.</span></div></div>")):(i.messages.forEach((function(t,i){let e='<div class="m-list-timeline__item">';e+='         <span class="m-list-timeline__badge -m-list-timeline__badge--state-success"></span>',e+=`         <span class="m-list-timeline__text"><strong>${t.title}</strong><p>${t.message}</p></span>`,e+=`         <span class="m-list-timeline__time">${t.createdAt}</span>`,e+="   </div>",$("#topbar_notifications_messages_1 .m-list-timeline__items").append(`${e}`)})),i.messages.forEach((function(t,i){let e='<div class="m-list-timeline__item">';e+='         <span class="m-list-timeline__badge -m-list-timeline__badge--state-success"></span>',e+=`         <span class="m-list-timeline__text"><strong>${t.title}</strong><p>${t.message}</p></span>`,e+=`         <span class="m-list-timeline__time">${t.createdAt}</span>`,e+="   </div>",$("#topbar_notifications_messages_2 .m-list-timeline__items").append(`${e}`)})))},complete:function(){}})};return{init:function(){s(),e()},load_slopes:a,push:function(t){(i.push(t),$(".m_topbar_notification_icon .m-nav__link-icon").addClass("m-animate-shake"),$(".m_topbar_notification_icon .m-nav__link-badge").addClass("m-badge"),t.sound)&&new Audio("/audio/institutional-alarm.mp3").play();setTimeout((function(){$(".m_topbar_notification_icon .m-nav__link-icon").removeClass("m-animate-shake")}),3e3),a()}}}();$((function(){Notifications.init()}));
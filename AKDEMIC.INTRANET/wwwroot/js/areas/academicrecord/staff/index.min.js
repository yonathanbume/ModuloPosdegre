var staff=function(){var t={object:null,options:getSimpleDataTableConfiguration({url:"/registrosacademicos/personal/get".proto().parseURL(),data:function(t){t.search=$("#search").val()},pageLength:5,orderable:[],columns:[{title:"Dni",data:"dni"},{title:"Nombre",data:"fullName"},{title:"Usuario",data:"userName",orderable:!1},{title:"Email",data:"email",orderable:!1},{title:"Celular",data:"phoneNumber",orderable:!1},{title:"Opciones",data:null,render:function(t){var e="";return e+="<button data-id='"+t.id+"' class='ml-1 btn btn-secondary btn-sm m-btn--icon btn-edit'><i class='la la-edit'></i></button>",e+='<button class="btn btn-primary btn-sm m-btn m-btn--icon btn-assign-career" data-id="'+t.id+'"><span><i class="la la-edit"></i><span>Asignar</span></span></a>'}}]}),reload:function(){t.object.ajax.reload()},events:{onAssign:function(){$("#users_datatable").on("click",".btn-assign-career",(function(){var t=$(this).data("id");e.assigned.events.show(t)}))},onEdit:function(){$("#users_datatable").on("click",".btn-edit",(function(){var t=$(this).data("id");window.location.href=`/registrosacademicos/personal/editar/${t}`.proto().parseURL()}))},onSearch:function(){$("#search").doneTyping((function(){t.reload()}))},init:function(){this.onAssign(),this.onEdit(),this.onSearch()}},init:function(){t.options.initComplete=function(){n.academicDepartment.init()},t.object=$("#users_datatable").DataTable(t.options),t.events.init()}},e={assigned:{object:$("#assigned_deparments"),events:{show:function(t){e.assigned.form.object.find("[name='UserId']").val(t),e.assigned.object.modal("show"),e.assigned.events.getCareers(t),e.assigned.form.object.find("button[type='submit']").attr("disabled",!0)},hide:function(){e.assigned.object.modal("hide")},onHidden:function(){e.assigned.object.on("hidden.bs.modal",(function(t){$("#Career").val([]).trigger("change"),e.assigned.form.object.find("[name='UserId']").val(""),$("#Career").attr("disabled",!0)}))},getCareers:function(t){$.ajax({url:`/registrosacademicos/personal/${t}/get-departamentos-asignados`,type:"GET"}).done((function(t){$("#AcademicDepartments").val(t).trigger("change")})).always((function(){$("#AcademicDepartments").attr("disabled",!1),e.assigned.form.object.find("button[type='submit']").attr("disabled",!1)}))},init:function(){this.onHidden()}},form:{object:$("#assigned_deparments_form"),events:{validate:function(){e.assigned.form.object.validate({submitHandler:function(t,n){n.preventDefault(),e.assigned.form.events.submit(t)}})},submit:function(t){e.assigned.form.object.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0);var n=new FormData(t);$.ajax({url:"/registrosacademicos/personal/asignar-departamentos",data:n,type:"POST",contentType:!1,processData:!1}).done((function(){swal({type:"success",title:"Completado",text:"Departamentos asignados correctamente.",confirmButtonText:"Aceptar"}),e.assigned.events.hide()})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})})).always((function(){e.assigned.form.object.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))},init:function(){e.assigned.form.events.validate()}},init:function(){e.assigned.form.events.init()}},init:function(){e.assigned.events.init(),e.assigned.form.init()}},init:function(){e.assigned.init()}},n={academicDepartment:{init:function(){$.ajax({url:"/departamentos-academicos/get",type:"GET"}).done((function(t){$("#AcademicDepartments").select2({placeholder:"Seleccionar departamento acad√©mico...",data:t})}))}}};return{init:function(){t.init(),e.init()}}}();$((function(){staff.init()}));
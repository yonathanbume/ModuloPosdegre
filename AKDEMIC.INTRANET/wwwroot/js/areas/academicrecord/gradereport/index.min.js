var GradeReportManagement=function(){var a={objects:{}},e=function(){$("#search").doneTyping((function(){a.objects["tbl-data"].draw()}))},t={columnDefs:[{orderable:!1,targets:[1]}],ajax:{type:"GET",dataType:"JSON",url:"/registrosacademicos/informes-de-grados/obtener-informes-grados".proto().parseURL(),data:function(a){a.searchValue=$("#search").val(),a.careerId=$("#careerId").val()}},columns:[{data:"userName",title:"Código"},{data:"name",title:"Nombres"},{data:"paternalSurname",title:"Apellidos paternos"},{data:"maternalSurname",title:"Apellidos maternos"},{data:"careerName",title:"Escuela Profesional"},{data:null,title:"Opciones",render:function(a,e,t,r){return`<button data-id="${t.id}" class="btn btn-info btn-sm m-btn m-btn--icon detail" title="Ver detalles"><i class="la la-eye"></i></button> \n                            <button data-id="${t.id}" class="btn btn-success btn-sm m-btn m-btn--icon download" title="Descargar constancia de grado"><i class="la la-download"></i></button>`}}]},r=function(){a.objects["tbl-data"].on("click",".detail",(function(){var a=$(this).data("id");window.location.href=`/registrosacademicos/informes-de-grados/detalle/${a}`.proto().parseURL()})),a.objects["tbl-data"].on("click",".download",(function(){var a=$(this);a.addLoader();var e=$(this).data("id");$.fileDownload(`/registrosacademicos/informes-de-grados/generar-constancia-grado/${e}`.proto().parseURL()).always((function(){a.removeLoader()})).done((function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(){toastr.error("No se pudo descargar el archivo","Error")}))}))},o=function(){a.objects["tbl-data"]=$("#grade_report_datatable").DataTable(t),r()};return{init:function(){o(),e(),$("#careerId").select2({allowClear:!0,placeholder:"Buscar..",ajax:{type:"GET",url:"/registrosacademicos/informes-de-grados/obtener-carreras".proto().parseURL(),delay:1e3,data:function(a){return{searchValue:a.term}},processResults:function(a){return{results:a.results}},escapeMarkup:function(a){return a},minimumInputLength:1}}),$("#careerId").on("change",(function(){a.objects["tbl-data"].draw()}))}}}();$((function(){GradeReportManagement.init()}));
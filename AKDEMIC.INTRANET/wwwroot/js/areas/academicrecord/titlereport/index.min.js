var TitleReportManagement=function(){var t={objects:{}},a=function(){$("#search").doneTyping((function(){t.objects["tbl-data"].draw()}))},e={columnDefs:[{orderable:!1,targets:[1]}],ajax:{type:"GET",dataType:"JSON",url:"/registrosacademicos/informes-de-titulos/obtener-informes-titulos".proto().parseURL(),data:function(t){t.searchValue=$("#search").val(),t.careerId=$("#careerId").val()}},columns:[{data:"userName",title:"Código"},{data:"name",title:"Nombres"},{data:"paternalSurname",title:"Apellidos paternos"},{data:"maternalSurname",title:"Apellidos maternos"},{data:"careerName",title:"Escuela Profesional"},{data:null,title:"Opciones",render:function(t,a,e,o){return`<button data-id="${e.id}" class="btn btn-info btn-sm m-btn m-btn--icon detail" title="Ver detalles"><i class="la la-eye"></i></button> \n                            <button data-id="${e.id}" class="btn btn-success btn-sm m-btn m-btn--icon download" title="Descargar constancia de grado"><i class="la la-download"></i></button>`}}]},o=function(){t.objects["tbl-data"].on("click",".detail",(function(){var t=$(this).data("id");window.location.href=`/registrosacademicos/informes-de-titulos/detalle/${t}`.proto().parseURL()})),t.objects["tbl-data"].on("click",".download",(function(){var t=$(this);t.addLoader();var a=$(this).data("id");$.fileDownload(`/registrosacademicos/informes-de-titulos/generar-constancia-titulo/${a}`.proto().parseURL()).always((function(){t.removeLoader()})).done((function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(){toastr.error("No se pudo descargar el archivo","Error")}))}))},r=function(){t.objects["tbl-data"]=$("#title_report_datatable").DataTable(e),o()};return{init:function(){r(),a(),$("#careerId").select2({allowClear:!0,placeholder:"Buscar..",ajax:{type:"GET",url:"/registrosacademicos/informes-de-titulos/obtener-carreras".proto().parseURL(),delay:1e3,data:function(t){return{searchValue:t.term}},processResults:function(t){return{results:t.results}},escapeMarkup:function(t){return t},minimumInputLength:1}}),$("#careerId").on("change",(function(){t.objects["tbl-data"].draw()}))}}}();$((function(){TitleReportManagement.init()}));
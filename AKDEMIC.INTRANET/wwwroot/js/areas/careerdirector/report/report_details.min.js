var reportDetails=function(){var e={object:null,sectionId:null,options:getSimpleDataTableConfiguration({url:"/director-carrera/reporte_asistencia/periodo/get".proto().parseURL(),data:function(e){delete e.columns,e.pid=$("#select2-terms").val(),e.sid=$("#Student_StudentId").val()},pageLength:10,orderable:[],columns:[{data:"courseName",title:"Curso"},{data:"classCount",title:"Total"},{data:"maxAbsences",title:"Máx. Faltas"},{data:"dictated",title:"Dictadas"},{data:"assisted",title:"Asistidas"},{data:"absences",title:"Faltas"},{data:null,title:"% Faltas",render:function(e){var t=function(e,t){if((""+e).includes("e")){var a=(""+e).split("e"),n="";return+a[1]+t>0&&(n="+"),+(Math.round(+a[0]+"e"+n+(+a[1]+t))+"e-"+t)}return+(Math.round(e+"e+"+t)+"e-"+t)}(e.absences/e.classCount*100,2);return isNaN(t)?0:t+" %"}},{data:null,title:"Opciones",render:function(e){var t="";return t+='<button class="btn btn-primary m-btn btn-sm m-btn--icon btn-detail" ',t+=`data-id="${e.sectionId}" `,t+='><span><i class="la la-eye"></i><span> Ver Detalle</span></span></button>'}}]}),reloadTable:function(){null===e.object?e.init():e.object.ajax.reload()},events:{onDetails:function(){$("#datatable_absences").on("click",".btn-detail",(function(){var a=$(this).data("id");e.sectionId=a,$("#absences-detail-modal").modal("toggle"),$("#SectionId").val(a),$("#assistance-filter").select2(),$("#assistance-filter").val(_app.constants.assistance.absence.value).trigger("change"),$("#assistance-filter").on("change",(function(e){e.preventDefault(),e.stopImmediatePropagation(),t.reloadTable()})),$("#absences-detail-modal").one("shown.bs.modal",(function(e){$("#assistance-filter").trigger("change")})),$("#absences-detail-modal").one("hidden.bs.modal",(function(e){null!==t.object&&(t.object.destroy(),t.object=null),$("#assistance-filter").off("change")}))}))},init:function(){this.onDetails()}},init:function(){e.events.init(),e.object=$("#datatable_absences").DataTable(e.options)}},t={object:null,options:getSimpleDataTableConfiguration({url:"/director-carrera/reporte_asistencia/seccion/alumno/get".proto().parseURL(),data:function(t){delete t.columns,t.filter=$("#assistance-filter").val(),t.sid=e.sectionId,t.aid=$("#Student_StudentId").val()},pageLength:10,orderable:[],columns:[{data:"week",title:"Semana"},{data:"sessionNumber",title:"Sesión"},{data:"date",title:"Fecha"},{data:"weekDay",title:"Día"},{data:"startTime",title:"Inicio"},{data:"endTime",title:"Fin"},{data:null,title:"Estado",render:function(e){var t=e.isAbsent?0:1,a={0:{text:_app.constants.assistance.absence.text,value:_app.constants.assistance.absence.value,icon:"la la-user-times",class:"m-badge--danger"},1:{text:_app.constants.assistance.assisted.text,value:_app.constants.assistance.assisted.value,icon:"flaticon-user-ok",class:"m-badge--success"}};return`<span class="m-badge ${a[t].class} m-badge--wide"><i class="${a[t].icon}"></i> ${a[t].text}</span>`}}]}),reloadTable:function(){null===t.object?t.init():t.object.ajax.reload()},init:function(){t.object=$("#absences-detail-datatable").DataTable(t.options)}};return{load:function(){$("#select2-terms").select2({ajax:{url:"/director-carrera/reporte_asistencia/periodos/get".proto().parseURL(),delay:300,processResults:function(e){return{results:e.results}}},minimumInputLength:0,placeholder:"Periodo Académico",allowClear:!0}).on("change",(function(){e.reloadTable()}))}}}();$((function(){reportDetails.load()}));
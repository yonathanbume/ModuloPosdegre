var InitApp=function(){var e=null,a=null,c={term:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(e){$("#termId").select2({placeholder:"Seleccione una periodo acadÃ©mico",minimumResultsForSearch:10,data:e.items,selected:e.selected})}))}},faculty:{init:function(){$.ajax({url:"/facultades/get".proto().parseURL()}).done((function(e){$("#facultyId").select2({data:e.items,placeholder:"Seleccione una facultad",minimumResultsForSearch:10}),$("#facultyId").val(null).trigger("change"),$("#facultyId").on("change",(function(){c.career.load($("#facultyId").val())}))}))}},career:{init:function(){$("#careerId").select2({placeholder:"Seleccione una escuela",disabled:!0}),$("#careerId").on("change",(function(){c.curriculum.load($("#careerId").val())}))},load:function(e){$.ajax({url:`/carreras/get?fid=${e}`.proto().parseURL()}).done((function(e){$("#careerId").empty(),$("#careerId").select2({placeholder:"Seleccione una escuela",data:e.items,disabled:!1,minimumResultsForSearch:10}),e.items.length>0?$("#careerId").trigger("change"):(c.curriculum.empty(),c.academicyear.empty())}))}},curriculum:{init:function(){$("#curriculumId").select2({placeholder:"Seleccione un plan",disabled:!0}),$("#curriculumId").on("change",(function(){c.academicyear.load($("#curriculumId").val())}))},load:function(e){$.ajax({url:`/carreras/${e}/planestudio/get`.proto().parseURL()}).done((function(e){$("#curriculumId").empty(),$("#curriculumId").select2({placeholder:"Seleccione un plan de estudios",data:e.items,disabled:!1}),e.items.length>0?$("#curriculumId").trigger("change"):c.academicyear.empty()}))},empty:function(){$("#curriculumId").empty(),$("#curriculumId").select2({placeholder:"Seleccione un plan",disabled:!0})}},academicyear:{init:function(){$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",disabled:!0})},load:function(e){$.ajax({url:`/planes-estudio/${e}/niveles/get`.proto().parseURL()}).done((function(e){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",data:e.items,disabled:!1,minimumResultsForSearch:-1}),e.items.length>0&&$("#academicyear-select").trigger("change")}))},empty:function(){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",disabled:!0})}},init:function(){c.term.init(),c.faculty.init(),c.career.init(),c.curriculum.init(),c.academicyear.init(),$(".btn-find").on("click",(function(){if(null==$("#facultyId").val()||""==$("#facultyId").val())return toastr.error("Debe seleccionar una facultad",_app.constants.toastr.title.error),!1;var c=$(this),t=$("#termId").val(),r=$("#facultyId").val(),n=$("#careerId").val(),l=$("#curriculumId").val(),i=$("#academicyear-select").val();$.ajax({url:`/director-carrera/reporte-alumnos-competencias/get/${t}/${r}/${n}/${l}/${i}`.proto().parseURL(),type:"GET",dataType:"html",contextType:"application/json",beforeSend:function(){c.addLoader(),$(".highcharts-figure").removeClass("m--hide"),mApp.block("#container","Cargando...")}}).done((function(t){$("#container").html(t),c.removeLoader(),null!=a&&null!=a&&(a.clear(),a.destroy()),a=$("#datatable-a").DataTable({serverSide:!1,dom:"Bfrtip",searching:!0,buttons:[{extend:"excel",footer:!1},{extend:"pdf",footer:!1}]}),$(".details").on("click",(function(){var a=$(this).data("studentid"),c=$(this).data("competenceid"),t=$("#termId").val(),r=$("#facultyId").val(),n=$("#careerId").val(),l=$("#curriculumId").val(),i=$("#academicyear-select").val();$("#courses-modal").modal("show"),mApp.block(".rendering-modal"),$.ajax({type:"GET",url:`/director-carrera/reporte-alumnos-competencias/obtener-datos-por-cantidad-por-estudiante/${t}/${r}/${n}/${l}/${c}/${a}/${i}`.proto().parseURL()}).done((function(a){if(null!=e&&null!=e&&(e.clear(),e.destroy()),e=$("#tbl-data-2").DataTable({serverSide:!1,columnDefs:[{orderable:!1,targets:[0,1,2]}],dom:"Bfrtip",processing:!0,buttons:[{extend:"excel",footer:!1,exportOptions:{columns:[0,1,2]}},{extend:"pdf",footer:!1,exportOptions:{columns:[0,1,2]}}]}),null!=a&&a.length>0){for(var c=0;c<a.length;c++){var t=e.row.add([`${a[c].courseName}`,`${a[c].credits}`,`${a[c].grade}`]).draw().node();$(t).css("text-align","center")}mApp.unblock(".rendering-modal")}}))}))})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)})).always((function(){c.removeLoader(),mApp.unblock("#container")}))}))}};return{init:function(){c.init()}}}();$((function(){InitApp.init()}));
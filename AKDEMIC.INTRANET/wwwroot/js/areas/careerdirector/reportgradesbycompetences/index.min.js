var InitApp=function(){var e,c={term:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(e){$("#termId").select2({placeholder:"Seleccione una periodo académico",minimumResultsForSearch:10,data:e.items,selected:e.selected})}))}},faculty:{init:function(){$.ajax({url:"/facultades/get".proto().parseURL()}).done((function(e){$("#facultyId").select2({data:e.items,placeholder:"Seleccione una facultad",minimumResultsForSearch:10}),$("#facultyId").val(null).trigger("change"),$("#facultyId").on("change",(function(){c.career.load($("#facultyId").val())}))}))}},career:{init:function(){$("#careerId").select2({placeholder:"Seleccione una escuela",disabled:!0}),$("#careerId").on("change",(function(){c.curriculum.load($("#careerId").val())}))},load:function(e){$.ajax({url:`/carreras/get?fid=${e}`.proto().parseURL()}).done((function(e){$("#careerId").empty(),$("#careerId").select2({placeholder:"Seleccione una escuela",data:e.items,disabled:!1,minimumResultsForSearch:10}),e.items.length>0?$("#careerId").trigger("change"):(c.curriculum.empty(),c.academicyear.empty(),c.course.empty())}))}},curriculum:{init:function(){$("#curriculumId").select2({placeholder:"Seleccione un plan",disabled:!0}),$("#curriculumId").on("change",(function(){c.competence.load($("#curriculumId").val())}))},load:function(e){$.ajax({url:`/carreras/${e}/planestudio/get`.proto().parseURL()}).done((function(e){$("#curriculumId").empty(),$("#curriculumId").select2({placeholder:"Seleccione un plan de estudios",data:e.items,disabled:!1}),e.items.length>0?$("#curriculumId").trigger("change"):(c.course.empty(),c.academicyear.empty())}))},empty:function(){$("#curriculumId").empty(),$("#curriculumId").select2({placeholder:"Seleccione un plan",disabled:!0})}},academicyear:{init:function(){$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",disabled:!0}),$("#academicyear-select").on("change",(function(){c.course.load($("#curriculumId").val(),$("#academicyear-select").val())}))},load:function(e){$.ajax({url:`/planes-estudio/${e}/niveles/get`.proto().parseURL()}).done((function(e){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",data:e.items,disabled:!1,minimumResultsForSearch:-1}),e.items.length>0?$("#academicyear-select").trigger("change"):c.course.empty()}))},empty:function(){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un curso",disabled:!0})}},course:{init:function(){$("#courseId").select2({placeholder:"Seleccione un curso",disabled:!0})},load:function(e,c){$.ajax({url:`/planes-estudio/${e}/niveles/${c}/get`.proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todos"}),$("#courseId").empty(),$("#courseId").select2({placeholder:"Seleccione un curso",data:e.items,disabled:!1})}))},empty:function(){$("#courseId").empty(),$("#courseId").select2({placeholder:"Seleccione un curso",disabled:!0})}},competence:{init:function(){$("#competenceId").select2({placeholder:"Seleccione una competencia",disabled:!0})},load:function(e){$.ajax({url:`/competencias/${e}/get`.proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todos"}),$("#competenceId").empty(),$("#competenceId").select2({placeholder:"Seleccione una competencia",data:e.items,disabled:!1})}))},empty:function(){$("#competenceId").empty(),$("#competenceId").select2({placeholder:"Seleccione una competencia",disabled:!0})}},init:function(){c.term.init(),c.faculty.init(),c.career.init(),c.curriculum.init(),c.competence.init(),$(".btn-find").on("click",(function(){if(null==$("#facultyId").val()||""==$("#facultyId").val())return toastr.error("Debe seleccionar una facultad",_app.constants.toastr.title.error),!1;t()}))}},t=function(){mApp.block(".m-portlet__body","Cargando..."),$.ajax({url:"/director-carrera/notas-por-competencias/get".proto().parseURL(),data:{termId:$("#termId").val(),facultyId:$("#facultyId").val(),careerId:$("#careerId").val(),curriculumId:$("#curriculumId").val(),competenceId:$("#competenceId").val()}}).done((function(c){var t=[],a=[];if(null!=c&&null!=c)for(var n=0;n<c.length;n++)t.push(c[n].competenceName),a.push(c[n].finalResult);Highcharts.chart("container",{chart:{type:"column"},title:{text:"Reportes de notas por competencias"},yAxis:{title:{enabled:!1}},xAxis:{title:{enabled:!0,text:"Competencias",style:{fontWeight:"normal"}},categories:t},series:[{name:"Notas ",data:a,showInLegend:!0}],credits:{text:"",href:""}}),null!=e&&null!=e&&(e.clear(),e.destroy());e=$("#tbl-data").DataTable({serverSide:!1,columnDefs:[{orderable:!1,targets:[0,1,2,3]}],dom:"Bfrtip",buttons:["excel","pdf"]});for(n=0;n<c.length;n++){var l=e.row.add([`${c[n].competenceName} ( ${c[n].finalResult} )`,null,null,null]).draw().node();$(l).css("color","white").css("background","gray").animate({color:"black"}),$.each(c[n].rowChilds,(function(c,t){e.row.add([null,t.courseName,t.average,t.credits]).draw().node()}))}$(".portlet-details").removeClass("m--hide"),$(".highcharts-figure").removeClass("m--hide")})).fail((function(e){toastr.info(e.responseText,"Información!")})).always((function(){mApp.unblock(".m-portlet__body")}))};return{init:function(){c.init()}}}();$((function(){InitApp.init()}));
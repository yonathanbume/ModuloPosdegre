var MedicalCare=function(){var t,e=$("#PersonalizedStudent"),a=$("#PersonalizedStudent2"),n={allDaySlot:!1,aspectRatio:2,businessHours:{dow:[1,2,3,4,5,6],end:"24:00",start:"07:00"},columnFormat:"dddd",contentHeight:600,defaultView:"agendaWeek",editable:!1,eventRender:function(e,a){a.hasClass("fc-day-grid-event")?(a.data("placement","top"),mApp.initPopover(a)):a.hasClass("fc-time-grid-event")?a.find(".fc-title").append('<div class="fc-description"></div>'):0!==a.find(".fc-list-item-title").length&&a.find(".fc-list-item-title").append('<div class="fc-description"></div>');var o=a.find(".fc-title").clone().children().remove().end().text();a.find(".fc-description").append(`<button data-id='${e.id}' style='height: 13px;width: 22px;float: right;' class='btn btn-danger delete'><i style='font-size: 7px;' class='fa fa-trash'></i></button> <button data-id='${e.id}' style='height: 13px;width: 22px;float: right;margin-right: 3px;' class='btn btn-info edit'><i style='font-size: 7px;' class='fa fa-edit'></i></button> `),a.css("border-color","#"+o.proto().toRGB()).css("border-width","2px"),a.find(".fc-content").css("cursor","pointer"),a.find(".delete").click((function(e){e.stopPropagation();var a=$(this).data("id");swal({title:"¿Está seguro?",text:"La cita será eliminada permanentemente",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((e=>{$.ajax({url:`/doctor/horario-citas/eliminar/${a}`.proto().parseURL(),type:"POST",success:function(e){swal({type:"success",title:"Completado",text:"La cita se eliminó correctamente",confirmButtonText:"Excelente"}),null!==t&&($(t).fullCalendar("destroy"),t=null),t=$(".m-calendar__container").fullCalendar(n)},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"No se pudo eliminar la cita"})}})}))})})),a.find(".edit").click((function(t){t.stopPropagation();var e=$(this).data("id");$("#edit-psicologyappointment-modal").modal("show"),$.ajax({type:"GET",url:`/doctor/horario-citas/obtener/${e}`.proto().parseURL(),success:function(t){null!==t.studentid&&$("#swichPersonalized2").trigger("click"),$("#modal-edit-psicologyappointment select[id='StudentId2']").val(t.studentid).trigger("change"),$("#modal-edit-psicologyappointment input[id='Id']").val(t.id),$("#modal-edit-psicologyappointment input[id='DateMedicalCare2']").val(t.datemedicalcare),$("#modal-edit-psicologyappointment input[id='TimeMedicalCare2']").val(t.timemedicalcare)}})}))},events:{className:"m-fc-event--primary",error:function(){toastr.error("Ocurrió un problema con el servidor","Error")},url:"/doctor/horario-citas/get".proto().parseURL()},eventAfterAllRender:function(){$(".fc-prev-button").prop("disabled",!1),$(".fc-next-button").prop("disabled",!1),mApp.unblock(".m-calendar__container")},eventClick:function(t,e,a){t.studentId===_app.constants.guid||null===t.studentId?toastr.warning("No existe un estudiante para la cita seleccionada",_app.constants.toastr.title.warning):!0===t.attended?toastr.warning("La cita ha sido atendida",_app.constants.toastr.title.warning):(mApp.block(".m-portlet",{type:"loader",message:"Cargando..."}),location.href=`/doctor/horario-citas/detalle-historico/${t.id}/${t.studentId}`.proto().parseURL())},firstDay:1,header:{left:"prev,next today",center:"title"},height:600,locale:"es",maxTime:"24:00:00",minTime:"06:00:00",monthNames:monthNames,dayNames:dayNames,monthNamesShort:monthNamesShort,dayNamesShort:dayNamesShort,buttonText:{today:"hoy",month:"mes",week:"semana",day:"día"},slotDuration:"00:10:00",timeFormat:"h(:mm)A"};return{init:function(){t=$(".m-calendar__container").fullCalendar(n),$("#btnAdd").on("click",(function(){$("#add-medicalappointment-modal").modal("show")})),$("#edit-psicologyappointment-modal").on("hidden.bs.modal",(function(){$("#swichPersonalized2").trigger("click"),$("#edit-psicologyappointment-modal").modal("hide")})),$("#StudentId").select2({allowClear:!0,placeholder:"Buscar..",ajax:{type:"GET",url:"/alumnosv2/get".proto().parseURL(),delay:1e3,data:function(t){return{searchValue:t.term}},processResults:function(t){return{results:t.results}},escapeMarkup:function(t){return t},minimumInputLength:1}}),$("#StudentId2").select2({allowClear:!0,placeholder:"Buscar..",ajax:{type:"GET",url:"/alumnosv2/get".proto().parseURL(),delay:1e3,data:function(t){return{searchValue:t.term}},processResults:function(t){return{results:t.results}},escapeMarkup:function(t){return t},minimumInputLength:1}}),$("#TimeMedicalCare").timepicker(),$("#TimeMedicalCare2").timepicker(),$("#modal-create-medicalappointment").validate({submitHandler:function(e,a){$(":submit").addLoader(),$.ajax({type:"POST",url:"/doctor/horario-citas/agregar-cita/post".proto().parseURL(),data:$("#modal-create-medicalappointment").serialize(),success:function(e){toastr.success(_app.constants.toastr.message.success.create,_app.constants.toastr.title.update),$("#add-medicalappointment-modal").modal("hide"),null!==t&&($(t).fullCalendar("destroy"),t=null),t=$(".m-calendar__container").fullCalendar(n)},error:function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)},complete:function(){$(":submit").removeLoader()}})}}),$("#modal-edit-psicologyappointment").validate({submitHandler:function(e,a){$.ajax({type:"POST",url:"/doctor/horario-citas/editar-cita/post".proto().parseURL(),data:$("#modal-edit-psicologyappointment").serialize(),success:function(e){toastr.success(_app.constants.toastr.message.success.update,_app.constants.toastr.title.update),$("#edit-psicologyappointment-modal").modal("hide"),null!==t&&($(t).fullCalendar("destroy"),t=null),t=$(".m-calendar__container").fullCalendar(n)},error:function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)}})}}),$("#swichPersonalized").on("click",(function(){$(this).is(":checked")?(e.find("#StudentId").attr("name","StudentId"),e.css("display","block")):(e.find("#StudentId").attr("name",""),e.css("display","none"))})),$("#swichPersonalized2").on("click",(function(){$(this).is(":checked")?(a.find("#StudentId2").attr("name","StudentId"),a.css("display","block")):(a.find("#StudentId2").attr("name",""),a.css("display","none"))})),$("#DateMedicalCare").datepicker(),$("#DateMedicalCare2").datepicker()}}}();$((function(){MedicalCare.init()}));
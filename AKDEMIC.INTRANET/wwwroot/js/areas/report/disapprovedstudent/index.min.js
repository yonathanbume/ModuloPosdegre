var initApp=function(){var e={students:{object:null,options:{pageLength:50,ajax:{url:"/reporte/estudiantes-desaprobados/get",type:"GET",data:function(e){delete e.columns,e.termId=$("#term_select").val(),e.facultyId=$("#faculty_select").val(),e.careerId=$("#career_select").val(),e.studentTry=$("#try_select").val()}},columns:[{title:"Escuela Profesional",data:"career"},{title:"Plan",data:"curriculum"},{title:"Código",data:"username"},{title:"Apellidos y Nombres",data:"fullname"},{title:"Ciclo",data:"year"},{title:"Cod Curso",data:"code"},{title:"Asignatura",data:"course"},{title:"Nro veces",data:"time"},{title:"Semestre",data:"term"}],dom:"Bfrtip",buttons:[{text:"Excel",action:function(){var e=$(this)[0].node;$(e).addClass("m-loader m-loader--right m-loader--primary").attr("disabled",!0),$.fileDownload("/reporte/estudiantes-desaprobados/reporte-excel".proto().parseURL(),{httpMethod:"GET",data:{termId:$("#term_select").val(),facultyId:$("#faculty_select").val(),careerId:$("#career_select").val(),studentTry:$("#try_select").val()},successCallback:function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")}}).done((function(){})).fail((function(){toastr.error("Error al descargar el archivo","Error")})).always((function(){$(e).removeClass("m-loader m-loader--right m-loader--primary").attr("disabled",!1)}))}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#data-table").DataTable(this.options)}}},t={term:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(t){$("#term_select").select2({data:t.items}),null!==t.selected&&($("#term_select").val(t.selected),$("#term_select").trigger("change.select2")),e.students.init(),$("#term_select").on("change",(function(t){e.students.reload()}))}))}},faculty:{init:function(){$.ajax({url:"/facultades/get".proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todas"}),$("#faculty_select").select2({data:e.items,minimumResultsForSearch:10}),t.career.events(),t.faculty.events()}))},events:function(){$("#faculty_select").on("change",(function(){$("#faculty_select").val()===_app.constants.guid.empty?(e.students.reload(),$("#career_select").empty(),$("#career_select").select2({placeholder:"Seleccione una Escuela",disabled:!0})):(e.students.reload(),t.career.load($("#faculty_select").val()))}))}},career:{init:function(){$("#career_select").select2({placeholder:"Seleccione una Escuela"})},load:function(e){$.ajax({url:`/facultades/${e}/carreras/v2/get?hasAll=false`.proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todas"}),$("#career_select").empty(),$("#career_select").select2({placeholder:"Seleccione una Escuela",data:e.items,minimumResultsForSearch:10,disabled:!1})}))},events:function(){$("#career_select").on("change",(function(){e.students.reload()}))}},try:{init:function(){$("#try_select").select2({minimumResultsForSearch:-1}).on("change",(function(){e.students.reload()}))}},init:function(){t.term.init(),t.faculty.init(),t.career.init(),t.try.init()}};return{init:function(){t.init()}}}();$((function(){initApp.init()}));
var InitApp=function(){var t={reports:{object:null,options:getSimpleDataTableConfiguration({url:"/academico/recepcion-ficha/get".proto().parseURL(),data:function(t){delete t.columns,t.search=$("#search").val(),t.faculty=$("#faculty_select").val(),t.school=$("#school_select").val(),t.career=$("#career_select").val(),t.status=$("#status_select").val(),t.termId=$("#term_select").val()},pageLength:50,orderable:[],columns:[{data:"code",title:"Código de Acta"},{data:"courseName",title:"Curso"},{data:"typeText",title:"Tipo"},{data:"lastGenerated",title:"Ultima emisión"},{data:"status",title:"Estado"},{data:null,title:"Opciones",orderable:!1,render:function(t){return t.isReceived?"---":`<button data-id=${t.id} class="btn btn-primary btn-sm m-btn m-btn--icon btn-receive"><span><i class="la la-check"></i><span> Recibir </span></span></a>`}}]}),init:function(){this.options.order=[5,"desc"],this.object=$("#data-table").DataTable(this.options),$("#data-table").on("click",".btn-receive",(function(){var e=$(this).data("id");swal({title:"Confirmar recepción de acta",text:"Una vez recepcionada el acta las notas no podrán ser cambiadas.",type:"warning",showCancelButton:!0,confirmButtonText:"Si",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(a){a.value&&$.ajax({url:"/academico/recepcion-ficha/recibir".proto().parseURL(),type:"POST",data:{id:e},success:function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.reports.reload()},error:function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}})}))}))},reload:function(){this.object.ajax.reload()}}},e=function(){$("#search").doneTyping((function(){t.reports.reload()}))},a={onDownloadExcel:function(){$("#export_excel").on("click",(function(){var t=$(this);$(t).addClass("m-loader m-loader--right m-loader--ligth").attr("disabled",!0);var e=`/academico/recepcion-ficha/reporte-excel?termId=${$("#term_select").val()}&status=${$("#status_select").val()}`;$.fileDownload(e,{httpMethod:"GET",successCallback:function(){toastr.success("Archivo descargado satisfactoriamente","Éxito"),$(t).removeClass("m-loader m-loader--right m-loader--ligth").attr("disabled",!1)}})}))},onDownloadPDF:function(){$("#export_pdf").on("click",(function(){var t=$(this),e=`/academico/recepcion-ficha/reporte-pdf?termId=${$("#term_select").val()}&status=${$("#status_select").val()}`;$(t).addClass("m-loader m-loader--right m-loader--ligth").attr("disabled",!0),$.fileDownload(e,{httpMethod:"GET",successCallback:function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")}}).always((function(){$(t).removeClass("m-loader m-loader--right m-loader--ligth").attr("disabled",!1)}))}))},init:function(){this.onDownloadPDF(),this.onDownloadExcel()}},o={status:{init:function(){$("#status_select").select2({minimumResultsForSearch:-1}).on("change",(function(){t.reports.reload()}))}},term:{init:function(){$.ajax({url:"/periodos/get",type:"GET"}).done((function(e){console.log(e),$("#term_select").select2({data:e.items,placeholder:"Seleccionar periodo"}),$("#term_select").val(e.selected).trigger("change"),$("#term_select").on("change",(function(){t.reports.reload()}))}))}},init:function(){o.status.init(),o.term.init()}};return{init:function(){o.init(),e(),t.reports.init(),a.init()}}}();$((function(){InitApp.init()}));
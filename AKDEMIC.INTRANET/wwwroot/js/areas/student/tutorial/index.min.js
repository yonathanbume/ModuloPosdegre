var Tutorial=function(){var t=null,e={load:function(){mApp.block(".m-calendar__container",{type:"loader",message:"Cargando..."}),t=$(".m-calendar__container").fullCalendar(n)},reload:function(){null!==t&&($(t).fullCalendar("destroy"),t=null),n.events.url=`/alumno/tutorias/get?onlyRegistered=${$("#onlyRegistered").is(":checked")}`.proto().parseURL(),this.load()}},n={allDaySlot:!1,aspectRatio:2,businessHours:{dow:[1,2,3,4,5,6],end:"24:00",start:"07:00"},columnFormat:"dddd",contentHeight:700,defaultView:"agendaWeek",editable:!1,eventRender:function(t,e){if(e.hasClass("fc-day-grid-event"))e.data("content",t.description),e.data("placement","right"),mApp.initPopover(e);else if(e.hasClass("fc-time-grid-event")){if(e.find(".fc-title").append('<div class="fc-description">'+t.description+"</div>"),t.registered){var n=t.start.hours(),a=t.start.minutes(),o=t.end.hours(),s=t.end.minutes();0===o&&(o+=24);var r='<span class="fc-registered-info pull-right align-bottom" style="font-weight:bold;color:green"><i class="la la-check"></i>Inscrito</span>';(s+=60*o)-(a+=60*n)<=120?e.find(".fc-description").append(r):e.find(".fc-content").append(r)}}else 0!==e.find(".fc-list-item-title").length&&e.find(".fc-list-item-title").append('<div class="fc-description">'+t.description+"</div>");var i=e.find(".fc-title").clone().children().remove().end().text();e.css("border-color","#"+i.proto().toRGB()).css("border-width","2px")},events:{className:"m-fc-event--primary",error:function(){toastr.error("Ocurrió un problema con el servidor","Error")},url:"/alumno/tutorias/get".proto().parseURL()},eventAfterAllRender:function(){$(".fc-prev-button").prop("disabled",!1),$(".fc-next-button").prop("disabled",!1),mApp.unblock(".m-calendar__container")},eventClick:function(t,e,n){a.show.detail(t.id)},firstDay:1,header:{left:"prev,next today",center:"title"},height:600,locale:"es",maxTime:"24:00:00",minTime:"06:00:00",monthNames:monthNames,dayNames:dayNames,monthNamesShort:monthNamesShort,dayNamesShort:dayNamesShort,buttonText:{today:"hoy",month:"mes",week:"semana",day:"día"},slotDuration:"00:30:00",timeFormat:"h(:mm)A"},a={show:{detail:function(t){mApp.blockPage(),$.ajax({url:`/alumno/tutorias/${t}/get`.proto().parseURL()}).done((function(t){var e=$("#detail-form").get(0).elements;e.id.value=t.id,e.section.value=t.section,e.date.value=t.date,e.classroom.value=t.classroom,e.start.value=t.start,e.end.value=t.end,e.teacher.value=t.teacher,t.canRegister?t.registered?a.switch.inscriptionToCancel():a.switch.cancelToInscription():($("#btnInscription").hide(),$("#btnCancelInscription").hide()),mApp.unblockPage(),$("#detail_modal").modal("show")})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}},switch:{inscriptionToCancel:function(){$("#btnInscription").hide(),$("#btnCancelInscription").show()},cancelToInscription:function(){$("#btnInscription").show(),$("#btnCancelInscription").hide()}}},o=function(){$("#btnInscription").on("click",(function(){var t=$(this);t.addLoader(),$.ajax({url:"/alumno/tutorias/inscripcion".proto().parseURL(),type:"POST",data:{id:$("#id").val()}}).always((function(){a.switch.inscriptionToCancel(),t.removeLoader()})).done((function(){e.reload(),a.switch.inscriptionToCancel(),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))})),$("#btnCancelInscription").on("click",(function(){var t=$(this);t.addLoader(),$.ajax({url:"/alumno/tutorias/anular-inscripcion".proto().parseURL(),type:"POST",data:{id:$("#id").val()}}).always((function(){a.switch.cancelToInscription(),t.removeLoader()})).done((function(){e.reload(),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))})),$("#onlyRegistered").on("change",(function(){e.reload()}))};return{init:function(){e.load(),o()}}}();$((function(){Tutorial.init()}));
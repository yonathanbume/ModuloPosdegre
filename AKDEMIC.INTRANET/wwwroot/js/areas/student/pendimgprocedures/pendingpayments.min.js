var InitApp=function(){var t={payments:{object:null,options:{ajax:{url:"/alumno/tramites_pendientes/get".proto().parseURL(),type:"GET",data:function(t){t.search=$("#search").val()}},order:[[2,"desc"]],columns:[{data:"concept",title:"Concepto"},{data:"issueDate",title:"Fecha emisión",width:100},{data:"totalamount",title:"Monto Total",width:90,className:"text-right",render:function(t){return"S/. "+t.toFixed(2)}},{data:"status",title:"Estado",orderable:!1,width:100,className:"text-center",render:function(t){switch(t){case 1:return"<span class='m-badge m-badge--warning m-badge--wide'>Pendiente</span>";case 2:return"<span class='m-badge m-badge--success m-badge--wide'>Aprobado</span>";default:return"<span class='m-badge m-badge--secundary m-badge--wide'>--</span>"}}},{data:null,title:"Opciones",orderable:!1,render:function(t){return 2==t.status?1==t.requestType?'<button data-paymentid="'+t.id+'" type="button" class="btn btn-sm m-btn m-btn--icon btn-warning coursewithdrawal-request"><span><i class="la la-times"></i><span> Retirar Curso </span></span></button>':2==t.requestType?'<button data-paymentid="'+t.id+'" type="button" class="btn btn-sm m-btn m-btn--icon btn-danger academicyearwithdrawal-request"><span><i class="la la-times"></i><span> Retirar Ciclo </span></span></button>':3==t.requestType?'<button data-paymentid="'+t.id+'" type="button" class="btn btn-sm m-btn m-btn--icon btn-success substitute-exam"><span><i class="la la-check"></i><span> Seleccionar Curso </span></span></button>':"---":"---"}}]},events:{buttons:function(){$("#data-table").on("click",".coursewithdrawal-request",(function(){var t=$(this).data("paymentid");$("#paymentId").val(t),a.enrolledcourses.init(),e.coursewithdrawal.init(t),e.coursewithdrawal.modalObject.modal("show")})).on("click",".academicyearwithdrawal-request",(function(){$(this).data("userid");var e=$(this).data("paymentid");swal({title:"¿Desea retirarse del ciclo?",text:"Se retirará de todas sus asignaturas. Este proceso es irreversible.",type:"warning",showCancelButton:!0,confirmButtonText:"Si, retirar",confirmButtonClass:"btn btn-success m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(a){a.value&&$.ajax({url:`/alumno/tramites_pendientes/retiro-ciclo/${e}`.proto().parseURL(),type:"POST"}).done((function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.payments.reload()})).fail((function(t){null!==t.responseText&&""!==t.responseText?toastr.error(t.responseText,_app.constants.toastr.title.error):toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}))})).on("click",".substitute-exam",(function(){var t=$(this).data("userid"),s=$(this).data("paymentid");$("#UserId").val(t),$("#substitute-paymentId").val(s),a.enrolledcourses.init(),e.substituteexams.init(t,s),e.substituteexam.modalObject.modal("show")}))},init:function(){this.buttons()}},init:function(){this.object=$("#data-table").DataTable(this.options),this.events.init()},reload:function(){this.object.ajax.reload()}},init:function(){t.payments.init()}},e={coursewithdrawal:{modalObject:$("#request-coursewithdrawal-modal"),object:null,clear:function(){this.object.resetForm(),$("#enrolledCoursesSelect").val(null).trigger("change")},init:function(a){this.object=$("#coursewithdrawal-request-form").validate({submitHandler:function(s,n){if(n.preventDefault(),null==$("#enrolledCoursesSelect").val())return $("#coursewithdrawal_msg_txt").html("Debe seleccionar un curso"),$("#coursewithdrawal-modal-form-alert").removeClass("m--hide").show(),!1;swal({title:"Retirar de asignatura",text:"Se retirará de la asignatura seleccionada",type:"warning",showCancelButton:!0,confirmButtonText:"Si, retirar",confirmButtonClass:"btn btn-success m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(n){n.value&&(mApp.block("#coursewithdrawal-request-form"),$.ajax({url:`/alumno/tramites_pendientes/retiro-curso/${a}`,type:"POST",processData:!1,contentType:!1,data:$(s).serialize()}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.coursewithdrawal.clear(),t.payments.reload()})).fail((function(t){null!==t.responseText&&""!==t.responseText?$("#coursewithdrawal_msg_txt").html(t.responseText):$("#coursewithdrawal_msg_txt").html(_app.constants.ajax.message.error),$("#coursewithdrawal-modal-form-alert").removeClass("m--hide").show()})).always((function(){mApp.unblock("#coursewithdrawal-request-form")})))}))}})}},substituteexam:{modalObject:$("#substitute-exam-modal"),object:null,clear:function(){this.object.resetForm(),$("#coursesSelect").val(null).trigger("change")},init:function(a,s){this.object=$("#substitute-exam-form").validate({submitHandler:function(a,n){if(n.preventDefault(),null==$("#coursesSelect").val())return $("#substitute_exam_msg_txt").html("Debe seleccionar un curso"),$("#substitute-exam-form-alert").removeClass("m--hide").show(),!1;swal({title:"Aprobar Exámen",text:"Se solicitará el exámen sustitutorio de la asignatura seleccionada",type:"warning",showCancelButton:!0,confirmButtonText:"Si, solicitar",confirmButtonClass:"btn btn-success m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(n){n.value&&(mApp.block("#substitute-exam-form"),$.ajax({url:`/alumno/tramites_pendientes/examen-sustitutorio/${s}`,type:"POST",processData:!1,contentType:!1,data:$(a).serialize()}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.substituteexam.clear(),t.payments.reload()})).fail((function(t){null!==t.responseText&&""!==t.responseText?$("#substitute_exam_msg_txt").html(t.responseText):$("#substitute_exam_msg_txt").html(_app.constants.ajax.message.error),$("#substitute-exam-form-alert").removeClass("m--hide").show()})).always((function(){mApp.unblock("#substitute-exam-form")})))}))}})}}},a={enrolledcourses:{init:function(){$.ajax({url:"/alumno/tramites_pendientes/cursos-matriculados".proto().parseURL()}).done((function(t){$("#enrolledCoursesSelect, #coursesSelect").select2({data:t,minimumResultsForSearch:-1})}))}}},s=function(){$("#search").doneTyping((function(){t.payments.reload()}))};return{init:function(){t.init(),s(),e.init()}}}();$((function(){InitApp.init()}));
var Events=function(){var t=$("#table-events"),e={paginate:function(){var e=0;t.bind("repaginate",(function(){t.find("tbody tr").hide().slice(3*e,3*(e+1)).show()})),t.trigger("repaginate");var n=t.find("tbody tr").length;console.log(n);for(var a=Math.ceil(n/3),i=$('<div class="pager"></div>'),s=0;s<a;s++)$('<span class="page-number"></span>').text(s+1).bind("click",{newPage:s},(function(n){e=n.data.newPage,t.trigger("repaginate"),$(this).addClass("active").siblings().removeClass("active")})).appendTo(i).addClass("clickable");i.insertAfter(t).find("span.page-number:first").addClass("active"),$(".btn-inscription").on("click",(function(){var t=$(this).data("id");swal({title:"¿Está seguro?",text:"El estudiante será inscrito",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, inscribir",confirmButtonClass:"btn btn-success m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((e=>{$.ajax({url:"/alumno/eventos/agregar",type:"POST",data:{id:t},success:function(t){swal({type:"success",title:"Completado",text:"El estudiante ha inscrito con éxito",confirmButtonText:"Excelente"})},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"No se pudo registrar la inscripción, es posible que ya esté registrado."})}})}))})})),$(".btn-read-more").on("click",(function(){var t=$(this).data("id");$.ajax({url:"/alumno/eventos/getEvent",type:"POST",data:{id:t},success:function(t){console.log(t);var e="";e+='<div class="m-widget19__content">',e+='    <div class="m-widget19__header">',e+='        <div class="m-widget19__stats">',e+='            <span class="m-widget19__number m--font-brand">',e+='                <i class="flaticon-calendar-2"></i>',e+="            </span>",e+='            <span class="m-widget19__comment">',e+=t.eventDate,e+="            </span >",e+="        </div>",e+="    </div>",e+='    <div class="m-widget19__body">',e+="        <label> Inscripciones</label>",e+='        <span class="m-widget19__comment">',e+=t.registrationStartDate+" - "+t.registrationEndDate,e+="        </span ><br />",e+="        <label>Creado por:</label>",e+="        <span> "+t.creator+"</span>",e+="        <br />",e+="        <label>",e+=t.description,e+="</label>",e+="    </div>",e+=" </div>",$("#detail_modal .modal-body").empty(),$("#detail_modal .modal-body").append(e)},error:function(t){}})}))},init:function(){$.ajax({url:("/alumno/eventos/getEvents/"+$("#select_eventtype").val()).proto().parseURL(),type:"POST",success:function(t){for(var n="",a=0;a<t.length;a++){a%3==0&&(n+='<tr class=""><td><div class="row row-event">'),n+='<div class="col-xl-4">',n+='<div class="m-portlet m-portlet--bordered-semi m-portlet--full-height ">',n+='    <div class="m-portlet__head m-portlet__head--fit">',n+='        <div class="m-portlet__head-caption">',n+='            <div class="m-portlet__head-action">',n+='                <button type="button" class="btn btn-sm m-btn--pill btn-brand btn-event-type" style="background-color:'+t[a].eventTypeColor+'">',n+=t[a].eventTypeName,n+="                </button>",n+="            </div>",n+="       </div>",n+="    </div>",n+='    <div class="m-portlet__body">',n+='    <div class="m-widget19">',n+='        <div class="m-widget19__pic m-portlet-fit--top m-portlet-fit--sides" style="min-height-: 286px">',n+='            <img src="'+t[a].pathPicture+'" alt="">',n+='            <h3 class="m-widget19__title m--font-light" style="display:block">'+t[a].eventName+"</h3>",n+='            <div class="m-widget19__shadow"></div>',n+="        </div>",n+='    <div class="m-widget19__content">',n+='        <div class="m-widget19__header">',n+='            <div class="m-widget19__stats">',n+='                <span class="m-widget19__number m--font-brand"><i class="flaticon-calendar-2"></i></span>',n+='                <span class="m-widget19__comment">'+t[a].eventDate+"</span>",n+="            </div>",n+="        </div>",n+='    <div class="m-widget19__body">';var i=t[a].description.slice(NaN,120);t[a].description.length>120&&(i+="..."),n+=i,n+="    </div>",n+="    </div >",n+='    <div class="m-widget19__action">',n+='        <button data-id="'+t[a].id+'" type="button" class="btn m-btn--pill btn-secondary m-btn m-btn--custom btn-read-more" data-toggle="modal" data-target="#detail_modal">',n+="            Ver",n+="        </button>&nbsp;",n+='        <button data-id="'+t[a].id+'" type="button" class="btn m-btn--pill btn-success btn-inscription">',n+="            Inscribirse",n+="        </button>",n+="    </div>",n+="   </div >",n+=" </div >",n+=" </div >",n+="</div >",a%3!=2&&a!=t.length-1||(n+="</tr></td></div>")}$("#table-events tbody").append(n),e.paginate()}})}};return{init:function(){e.init(),$.ajax({url:"/alumno/eventos/getEventTypes".proto().parseURL()}).done((function(t){$("#select_eventtype").select2({data:t.eventTypes}).on("change",(function(t){$(".pager").remove(),$("#table-events tbody").empty(),e.init()}))}))}}}();$((function(){Events.init()}));
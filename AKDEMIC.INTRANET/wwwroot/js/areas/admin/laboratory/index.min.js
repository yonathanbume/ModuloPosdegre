var RequestsTable=function(){var e,t=$("#request-form").validate();$("#cSectionSearch").select2({width:"100%",dropdownParent:$("#request_modal"),placeholder:"Buscar una sección",ajax:{url:"/admin/laboratory/sections/select/filter/get",dataType:"json",data:function(e){return{term:e.term,page:e.page}},processResults:function(e,t){return{results:e.items}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:3}),$("#Date").datepicker({minDate:moment()}),$("#Date").datepicker("setStartDate",new Date),$("#TimeEnd, #TimeStart").timepicker();var a={search:{input:$("#search")},data:{type:"remote",source:{read:{method:"GET",url:"/admin/laboratory/get/".proto().parseURL()}},pageSize:10,saveState:{cookie:!0,webstorage:!0}},columns:[{field:"section",title:"Sección",width:190},{field:"date",title:"Fecha",width:120},{field:"dateRequest",title:"Fecha a reservar",width:120},{field:"string_state",title:"Estado",width:120,template:function(e){return 0===e.state?'<span style="width: 100px;"><span class="m-badge m-badge--brand m-badge--wide">'+e.string_state+"</span></span>":1===e.state?'<span style="width: 100px;"><span class="m-badge  m-badge--success m-badge--wide">'+e.string_state+"</span></span>":2===e.state?'<span style="width: 100px;"><span class="m-badge  m-badge--danger m-badge--wide">'+e.string_state+"</span></span>":void 0}},{field:"options",title:"Opciones",width:300,sortable:!1,filterable:!1,template:function(e){return e.denied?"":'<button data-id="'+e.id+'" class="btn btn-success btn-sm m-btn m-btn--icon btn-format" title="Formato"><span><i class="la la-check"></i><span>Formato ATS</span></span></button>'}}]},s=function(){$(".btn-add").on("click",(function(){n.add()})),e.on("click",".btn-format",(function(){var e=$(this).data("id");window.open(`/admin/format/ats/${e}`.proto().parseURL(),"_blank")}))},n={add:function(){$("#request_modal").modal("toggle"),$("#request-form").find("input").prop("disabled",!1),$("#request-form").find("select").prop("disabled",!1),$("#request-form").find("textarea").prop("disabled",!1),$("#request_modal").one("hidden.bs.modal",(function(e){n.reset()}))},reset:function(){$("#request_form_msg").addClass("m--hide").hide(),$("#cSectionSearch").val("").trigger("change"),t.resetForm()},begin:function(){$("#request_modal input").attr("disabled",!0),$("#request_modal select").attr("disabled",!0),$("#btnSave").addLoader()},complete:function(){$("#request_modal input").attr("disabled",!1),$("#request_modal select").attr("disabled",!1),$("#btnSave").removeLoader()},success:function(t){$("#request_modal").modal("toggle"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),e.reload()},failure:function(e){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!=e.responseText?$("#request_form_msg_txt").html(e.responseText):$("#request_form_msg_txt").html(_app.constants.ajax.message.error),$("#request_form_msg").removeClass("m--hide").show()}};return{init:function(){e=$(".m-datatable").mDatatable(a),s()},Request:{begin:function(){n.begin()},complete:function(){n.complete()},success:function(e){n.success(e)},failure:function(e){n.failure(e)}}}}();$((function(){RequestsTable.init()}));
var admins=function(){var t,e={data:{type:"remote",source:{read:{method:"GET",url:"/admin/permisos/usuarios/admin/get".proto().parseURL()}}},columns:[{field:"name",title:"Nombre"},{field:"username",title:"Usuario"},{field:"options",title:"Opciones",sortable:!1,filterable:!1,template:function(t){return'<button data-id="'+t.id+'" class="btn btn-danger btn-sm m-btn m-btn--icon btn-delete" title="Eliminar"><span><i class="la la-trash"></i><span>Remover</span></span></button> <button data-id="'+t.id+'" class="btn btn-info btn-sm m-btn m-btn--icon btn-edit" title="Editar"><span><i class="la la-edit"></i><span>Editar</span></span></button>'}}]},n={teacherSelect:{init:function(){$.ajax({url:"/admin/permisos/usuarios/get",type:"get"}).done((t=>{$("#cTeacherId").select2({dropdownParent:$("#create_modal"),data:t})}))}},init:function(){n.teacherSelect.init()}},i=function(){$("#create_modal").on("shown.bs.modal",(function(t){$("#cTeacherId").val(null).trigger("change"),$('input[type="checkbox"]').prop("checked",!1)})),t.on("click",".btn-delete",(function(){var e=$(this).data("id");swal({title:"¿Está seguro?",text:"Los permisos de administrador serán removidos.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarla",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((n=>{$.ajax({url:"/admin/permisos/usuarios/admin/delete",type:"POST",data:{id:e},success:function(e){t.reload(),swal({type:"success",title:"Completado",text:"La solicitud ha sido eliminado con éxito",confirmButtonText:"Excelente"})}})}))})})),t.on("click",".btn-edit",(function(){var t=$(this).data("id");$("#edit_modal").modal("show"),$("#edit_modal #cTeacherId").val(t),$.ajax({url:`/admin/permisos/usuarios/admin/detail/get/${t}`.proto().parseURL(),type:"get"}).done((t=>{$.each(t,(function(t,e){$("#edit_modal #chbx-"+e).prop("checked",!0)}))}))}))},a={add:{object:$("#create_modal"),form:$("#create-form"),events:{onHidden:function(){a.add.object.on("hidden.bs.modal",(function(t){$.each($("#create_modal input[type='checkbox']"),(function(t,e){$(this).prop("checked",!1)}))}))},validate:function(){a.add.form.validate({rules:{TeacherId:{required:!0}},submitHandler:function(t,e){a.add.events.submit(t)}})},submit:function(e){var n=new FormData(e);$("input[type='checkbox']:checked").length?(a.add.form.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:"/admin/permisos/usuarios/admin/add",type:"POST",data:n,contentType:!1,processData:!1}).done((function(e){a.add.object.modal("hide"),swal({type:"success",title:"Completado",text:"Permisos otorgados satisfactoriamente.",confirmButtonText:"Aceptar"}).then((function(e){e.value&&t.reload()}))})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})})).always((function(){a.add.form.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))):swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:"Seleccione al menos un sistema"})},init:function(){this.validate(),this.onHidden()}},init:function(){this.events.init()}},edit:{object:$("#edit_modal"),form:$("#edit-form"),events:{validate:function(){a.edit.form.validate({rules:{TeacherId:{required:!0}},submitHandler:function(t,e){e.preventDefault(),a.edit.events.submit(t)}})},onHidden:function(){a.edit.object.on("hidden.bs.modal",(function(t){$.each($("#edit_modal input[type='checkbox']"),(function(t,e){$(this).prop("checked",!1)}))}))},submit:function(e){var n=new FormData(e);n=new FormData(e);$("#edit_modal input[type='checkbox']:checked").length?(a.edit.form.find("button[type='submit']").addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),$.ajax({url:"/admin/permisos/usuarios/admin/add",type:"POST",data:n,contentType:!1,processData:!1}).done((function(){a.edit.object.modal("hide"),t.reload(),swal({type:"success",title:"Completado",text:"Permisos editados satisfactoriamente.",confirmButtonText:"Aceptar"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})})).always((function(){a.edit.form.find("button[type='submit']").removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))):swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:"Seleccione al menos un sistema"})},init:function(){this.validate(),this.onHidden()}},init:function(){this.events.init()}},init:function(){this.add.init(),this.edit.init()}};return{init:function(){t=$(".m-datatable").mDatatable(e),i(),n.teacherSelect.init(),a.init()}}}();$((function(){admins.init()}));
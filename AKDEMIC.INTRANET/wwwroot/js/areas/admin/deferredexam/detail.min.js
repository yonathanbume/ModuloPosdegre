var detail=function(){var t=$("#Id").val(),n={studentsToAssign:{object:null,options:{pageLength:5,serverSide:!1,ajax:{url:`/admin/examen-aplazado/get-alumnos/${t}`,method:"GET",dataSrc:""},columns:[{data:"userName",title:"Código"},{data:"fullName",title:"Estudiante"},{data:"finalGrade",title:"Nota Final"},{data:null,title:"Asignar",render:function(t){var n="";return n+=`<span class="m-switch m-switch--outline m-switch--icon m-switch--primary">\n                                <label>\n                                    <input type="checkbox" ${t.isAssigned?"checked":""} class="students_check" data-id="${t.id}">\n                                    <span></span>\n                                </label>\n                            </span>`}}]},events:{onAssignStudent:function(){$("#students_table").on("click",".students_check",(function(){var e=$(this),a=$(this).data("id");mApp.block("#students_table",{message:"Guardando datos..."}),$.ajax({url:`/admin/examen-aplazado/asignar-estudiante?studentId=${a}&deferredExamId=${t}`,type:"POST"}).done((function(t){toastr.success("Registro actualizado con éxito","Hecho!")})).fail((function(t){toastr.error(t.responseText,"Error!");var n=e.is(":checked");e.prop("checked",!n)})).always((function(){n.students.reload(),mApp.unblock("#students_table")}))}))},init:function(){this.onAssignStudent()}},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#students_table").DataTable(this.options),n.studentsToAssign.events.init()}},students:{object:null,options:{ajax:{url:"/admin/examen-aplazado/get-alumnos-asignados-datatable",data:function(n){n.deferredExamId=t,n.search=$("#search").val()}},columns:[{data:"username",title:"Usuario"},{data:"fullName",title:"Nombre Completo"},{data:"status",title:"Estado",render:function(t){switch(t){case 1:return'<span class="m-badge m-badge--metal m-badge--wide">Pendiente</span>';case 2:return'<span class="m-badge m-badge--primary m-badge--wide">Calificado</span>';default:return"-"}}},{data:"grade",title:"Nota Obtenida",render:function(t){return null==t?"-":t}}]},events:{onDelete:function(){$("#ajax_data").on("click",".btn-delete-assigned-student",(function(){var t=$(this).data("id");swal({title:"Eliminar estudiante",text:"¿Seguro que desea eliminar al estudiante?",type:"warning",showCancelButton:!0,confirmButtonText:"Si",confirmButtonClass:"btn btn-success",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((e=>{$.ajax({url:`/admin/examen-aplazado/{0}/eliminar-estudiante-asignado?deferredExamStudentId=${t}`,type:"POST",success:function(){n.students.reload(),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)},error:function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)},complete:function(){swal.close()}})}))})}))},init:function(){this.onDelete()}},reload:function(){n.students.object.ajax.reload()},init:function(){n.students.object=$("#ajax_data").DataTable(n.students.options),n.students.events.init()}},init:function(){n.students.init(),n.studentsToAssign.init()}},e={onSearch:function(){$("#search").doneTyping((function(){n.students.reload()}))},onUpdateStudents:function(){$("#btn-update-students").on("click",(function(){var e=$(this);e.addLoader(),$.ajax({url:`/admin/examen-aplazado/${t}/actualizar-estudiantes-asignados`,type:"POST"}).done((function(){n.students.reload(),swal({type:"success",title:"Completado",text:"Alumnos actualizados con éxito",confirmButtonText:"Excelente"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:t.responseText})})).always((function(){e.removeLoader()}))}))},onHidden:function(){$("#assigned_students_modal").on("hidden.bs.modal",(function(t){n.studentsToAssign.reload()}))},init:function(){e.onSearch(),e.onUpdateStudents(),e.onHidden()}};return{init:function(){n.init(),e.init()}}}();$((()=>{detail.init()}));
var NewStudents=function(){var e=function(){},t={init:function(){this.terms.init(),this.status.init()},terms:{init:function(){$.ajax({url:"/admin/ranking/periodos/get".proto().parseURL()}).done((function(e){$(".select2-terms").select2({data:e}).on("change",(function(){$(".select2-careers").empty(),$(".select2-academicPrograms").empty(),!1,!1})),!0,t.careers.init()})),$(".select2-careers").select2(),$(".select2-academicPrograms").select2()}},careers:{init:function(){$(".select2-careers").select2({ajax:{url:"/admin/ranking/carreras/get".proto().parseURL(),delay:300},minimumInputLength:0,placeholder:"Carreras",allowClear:!0}).on("change",(function(){""!==$(this).val()&&(!0,!1,$(".select2-academicPrograms").empty(),t.academicPrograms.init())}))}},academicPrograms:{init:function(){$(".select2-academicPrograms").select2({ajax:{url:"/admin/ranking/especialidades/get".proto().parseURL(),data:function(e){return{q:e.term,cid:$(".select2-careers").val()}},delay:300},minimumInputLength:0,placeholder:"Programa Académico",allowClear:!0}).on("change",(function(){""!==$(this).val()&&(!0,datatable.init())}))}},status:{init:function(){$(".select2-status").select2().on("change",(function(){datatable.init()}))}}},a=function(){};return{init:function(){t.init(),e(),a()}}}(),InitApp=function(){var e={students:{object:null,options:{serverSide:!1,ajax:{url:"/admin/ranking/ingresantes/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(e){delete e.columns;var t=$(".select2-terms").val(),a=$(".select2-careers").val(),r=$(".select2-status").val(),s=$(".select2-programs").val();t=t===_app.constants.guid.empty?null:t,a=a===_app.constants.guid.empty?null:a,s=s===_app.constants.guid.empty?null:s,r=0==r?null:r,e.admissionTermId=t,e.careerId=a,e.status=r,e.academicProgramId=s,e.search=$("#search").val()}},columns:[{title:"Posición",data:"position",orderable:!1},{title:"Código",data:"code",orderable:!1},{title:"DNI",data:"dni",orderable:!1},{title:"Apellidos, Nombres",data:"name",orderable:!1},{title:"Carr.",data:"careerCode",orderable:!1},{title:"Curr.",data:"curriculumCode",orderable:!1},{title:"Sede Ingr.",data:"firstCampus",orderable:!1},{title:"Sede Actu.",data:"currentCampus",orderable:!1},{title:"Sem. de Ingreso",data:"admissionTerm",orderable:!1},{title:"Sem. Ultimo",data:"lastTerm",orderable:!1},{title:"Promedio Ultimo",data:"lastWeightedAverageGrade",orderable:!1},{title:"Sem. de Egreso",data:"graduationTerm",orderable:!1},{title:"Prom. de Egreso",data:"meritType",orderable:!1},{title:"Estado",data:"status",orderable:!1},{title:"Cicl. Actual",data:"currentAcademicYear",orderable:!1},{title:"Orden de Mer.",data:"meritType",orderable:!1}]},init:function(){this.object=$(".students-datatable").DataTable(this.options)},reload:function(){this.object.ajax.reload()}}},t={init:function(){this.terms.init(),this.careers.init(),this.academicPrograms.init(),this.status.init()},terms:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(t){$(".select2-terms").select2({data:t.items}),null!==t.selected&&($(".select2-terms").val(t.selected),$(".select2-terms").trigger("change.select2")),e.students.init(),$(".select2-terms").on("change",(function(){e.students.reload()}))}))}},careers:{init:function(){$.ajax({url:"/carreras/get".proto().parseURL()}).done((function(a){a.items.unshift({id:_app.constants.guid.empty,text:"Todos"}),$(".select2-careers").select2({data:a.items}),$(".select2-careers").on("change",(function(){var a=$(".select2-careers").val();a===_app.constants.guid.empty?($(".select2-programs").empty(),$(".select2-programs").select2({placeholder:"Seleccione una escuela",disabled:!0})):t.academicPrograms.load(a),e.students.reload()}))}))}},academicPrograms:{init:function(){$(".select2-programs").select2({placeholder:"Seleccione una escuela"}),$(".select2-programs").on("change",(function(){e.students.reload()}))},load:function(e){$.ajax({url:`/carreras/${e}/programas/get/`.proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todos"}),$(".select2-programs").empty(),$(".select2-programs").select2({placeholder:"Seleccione una Escuela",data:e.items,minimumResultsForSearch:10,disabled:!1})}))}},status:{init:function(){$(".select2-status").select2().on("change",(function(){e.students.reload()}))}}},a=function(){$("#search").doneTyping((function(){e.students.reload()})),$(".btn-report").on("click",(function(){var e=$(this),t=$(".select2-terms").val(),a=$(".select2-careers").val(),r=$(".select2-status").val();return t=t===_app.constants.guid.empty?null:t,a=a===_app.constants.guid.empty?null:a,r=0==r?null:r,e.addLoader(),$.fileDownload(`${location.pathname}/pdf/get?admissionTermId=${t}&careerId=${a}&status=${r}`.proto().parseURL()).always((function(){e.removeLoader()})).done((function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(){toastr.error("No se pudo descargar el archivo","Error")})),!1}))};return{init:function(){t.init(),a()}}}();$((function(){InitApp.init()}));
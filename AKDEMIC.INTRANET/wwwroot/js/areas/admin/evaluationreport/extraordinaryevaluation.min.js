var evaluation=function(){var t={object:null,options:{ajax:{url:"/admin/generacion-actas/evaluacion-extraordinaria/get",type:"GET",data:function(t){t.termId=$("#term_select").val(),t.type=$("#type_filter").val()}},columns:[{title:"Cod. Curso",data:"courseCode"},{title:"Curso",data:"courseName"},{title:"Profesor",data:"teacher"},{title:"Estado",data:null,render:function(t){if(null!==t.evaluationReport){var a={Recibido:{title:"Recibido",class:" m-badge--success"},Generado:{title:"Generado",class:" m-badge--warning"},Pendiente:{title:"Pendiente",class:" m-badge--metal"}};return'<span class="m-badge '+a[t.evaluationReport.status].class+' m-badge--wide">'+a[t.evaluationReport.status].title+"</span>"}return'<span class="m-badge m-badge--metal m-badge--wide">Pendiente</span>'}},{data:null,title:"Detalle",render:function(t){return`<button data-id=${t.id} class="btn btn-primary btn-sm m-btn m-btn--icon btn-preview-details"><i class="la la-eye"></i></button> `}},{title:"Cant. Impresiones",data:null,render:function(t){return null!==t.evaluationReport?t.evaluationReport.printQuantity:"0"}},{title:"Opciones",data:null,render:function(t){var a="";return null!=t.evaluationReport?a+=`<button data-id="${t.id}" class="btn btn-secondary btn-sm m-btn m-btn--icon btn-generate"><span><i class="la la-file-text-o"></i><span>Imprimir</span></span></button>`:t.complete?a+=`<button data-id="${t.id}" class="btn btn-brand btn-sm m-btn m-btn--icon btn-generate"><span><i class="la la-file-text-o"></i><span>Generar</span></span></button>`:a+=`<button data-id="${t.id}" class="btn btn-brand btn-sm m-btn m-btn--icon btn-generate-incomplete"><span><i class="la la-file-text-o"></i><span>Generar</span></span></button>`,a}}]},reload:function(){this.object.ajax.reload()},events:{onGenerate:function(){$("#data-table").on("click",".btn-generate-incomplete",(function(){var a=`/admin/generacion-actas/evaluacion-extraordinaria/imprimir/acta?evaluationId=${$(this).data("id")}`,e=$(this);swal({title:"Evaluaciones sin notas registradas",text:"Existen evaluaciones sin notas registradas, ¿desea generar el acta de todos modos?",type:"warning",showCancelButton:!0,confirmButtonText:"Si",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(n){n.value&&(e.addLoader(),$.fileDownload(a,{httpMethod:"GET",successCallback:function(){e.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito"),t.reload()},failCallback:function(t,a){toastr.error("No se pudo descargar el archivo","Error")}}))}))})),$("#data-table").on("click",".btn-generate",(function(){var a=`/admin/generacion-actas/evaluacion-extraordinaria/imprimir/acta?evaluationId=${$(this).data("id")}`,e=$(this);e.addLoader(),$.fileDownload(a,{httpMethod:"GET",successCallback:function(){e.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito"),t.reload()},failCallback:function(t,a){toastr.error("No se pudo descargar el archivo","Error")}})})),$("#data-table").on("click",".btn-generate-v2",(function(){var a=`/admin/generacion-actas/evaluacion-extraordinaria/imprimir/acta-registro?evaluationId=${$(this).data("id")}`,e=$(this);e.addLoader(),$.fileDownload(a,{httpMethod:"GET",successCallback:function(){e.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito"),t.reload()},failCallback:function(t,a){toastr.error("No se pudo descargar el archivo","Error")}})})),$("#data-table").on("click",".btn-preview-details",(function(){var t=$(this).data("id");$("#preview-datatable").html(""),$("#previewView").modal("show"),mApp.block("#preview-datatable"),$.ajax({url:`/admin/generacion-actas/evaluacion-extraordinaria/vista-previa?evaluationId=${t}`.proto().parseURL(),type:"GET",dataType:"html",contextType:"application/json"}).done((function(t){$("#preview-datatable").html(t)})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)})).always((function(){mApp.unblock("#preview-datatable")}))}))},init:function(){this.onGenerate()}},init:function(){t.object=$("#data-table").DataTable(this.options),t.events.init()}},a={terms:{init:function(){a.terms.load()},load:function(){$.ajax({url:"/periodos/get".proto().parseURL(),success:function(t){$("#term_select").select2({data:t.items})}}).done((function(){t.init(),$("#term_select").on("change",(function(){t.reload()}))}))}},type:{init:function(){$("#type_filter").select2(),$("#type_filter").on("change",(function(){t.reload()}))}},init:function(){a.terms.init(),a.type.init()}};return{init:function(){a.init()}}}();$((()=>{evaluation.init()}));
var index=function(){var e={correctionExam:{object:null,options:{ajax:{url:"/admin/generacion-actas/get-examenes-subsanacion-datatable",type:"GET",data:function(e){e.termId=$("#term_select").val(),e.careerId=$("#career_select").val(),e.curriculumId=$("#curriculum_select").val(),e.search=$("#course_search").val()}},columns:[{title:"Cod. Curso",data:"courseCode"},{title:"Curso",data:"courseName"},{title:"Estado",data:null,render:function(e){return null===e.evaluationReport?'<span class="m-badge m-badge--metal m-badge--wide">Pendiente</span>':1==e.evaluationReport.status?'<span class="m-badge m-badge--warning m-badge--wide">Generado</span>':2==e.evaluationReport.status?'<span class="m-badge m-badge--success m-badge--wide"> Recibido</span>':3==e.evaluationReport.status?'<span class="m-badge m-badge--metal m-badge--wide"> Pendiente </span>':void 0}},{data:null,title:"Detalle",render:function(e){return`<button data-id=${e.id} class="btn btn-primary btn-sm m-btn m-btn--icon btn-preview-details"><i class="la la-eye"></i></button> `}},{title:"Cant. Impresiones",data:null,render:function(e){return null!==e.evaluationReport?e.evaluationReport.printQuantity:"0"}},{title:"Opciones",data:null,render:function(e){var t="";return null!=e.evaluationReport?t+=`<button data-id="${e.id}" class="btn btn-secondary btn-sm m-btn m-btn--icon btn-generate"><span><i class="la la-file-text-o"></i><span>Imprimir</span></span></button>`:t+=`<button data-id="${e.id}" class="btn btn-brand btn-sm m-btn m-btn--icon btn-generate"><span><i class="la la-file-text-o"></i><span>Generar</span></span></button>`,t}}]},reload:function(){e.correctionExam.object.ajax.reload()},events:{onPreview:function(){$("#data-table").on("click",".btn-preview-details",(function(){var e=$(this).data("id");$("#preview-datatable").html(""),$("#previewView").modal("show"),mApp.block("#preview-datatable"),$.ajax({url:`/admin/generacion-actas/examenes-subsanacion/vista-previa?correctionExamId=${e}`.proto().parseURL(),type:"GET",dataType:"html",contextType:"application/json"}).done((function(e){$("#preview-datatable").html(e)})).fail((function(e){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)})).always((function(){mApp.unblock("#preview-datatable")}))}))},onReport:function(){$("#data-table").on("click",".btn-generate",(function(){var t=$(this).data("id"),a=$(this);a.addLoader(),$.fileDownload(`/admin/generacion-actas/examenes-subsanacion/imprimir-acta?id=${t}`,{httpMethod:"GET",successCallback:function(){a.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Ã‰xito"),e.correctionExam.reload()},failCallback:function(e,t){a.removeLoader(),e=(e=e.replace('<pre style="word-wrap: break-word; white-space: pre-wrap;">',"")).replace("</pre>",""),toastr.error(e,"Error")}})}))},init:function(){this.onReport(),this.onPreview()}},init:function(){e.correctionExam.object=$("#data-table").DataTable(e.correctionExam.options),e.correctionExam.events.init()}},init:function(){e.correctionExam.init()}},t={terms:{init:function(){t.terms.load()},load:function(){$.ajax({url:"/periodos/get".proto().parseURL(),success:function(e){$("#term_select").select2({data:e.items})}}).done((function(){e.init(),$("#term_select").on("change",(function(){e.correctionExam.reload()}))}))}},career:{events:{load:function(){$.ajax({url:"/carreras/get".proto().parseURL()}).done((function(e){$("#career_select").select2({data:e.items,allowClear:!0,placeholder:"Seleccionar una escuela profesional"})}))},onChange:function(){$("#career_select").on("change",(function(){var a=$(this).val();t.curriculum.events.load(a),e.correctionExam.reload()}))},init:function(){this.load(),this.onChange()}},init:function(){t.career.events.init()}},curriculum:{events:{load:function(e){if($("#curriculum_select").empty(),e===_app.constants.guid.empty||" "===e||void 0===e||null==e)$("#curriculum_select").select2({disabled:!0,placeholder:"Seleccionar plan de estudio"});else{var t=$("#term_select").val();$.ajax({url:`/planes-estudio/${e}/activos/${t}/get`.proto().parseURL()}).done((function(e){e.items.unshift({id:_app.constants.guid.empty,text:"Todos"}),$("#curriculum_select").select2({data:e.items,disabled:!1})}))}},onChange:function(){$("#curriculum_select").on("change",(function(){e.correctionExam.reload()}))},init:function(){this.load(),this.onChange()}},init:function(){t.curriculum.events.init()}},init:function(){t.terms.init(),t.career.init(),t.curriculum.init()}},a={onSearch:function(){$("#course_search").doneTyping((function(){e.correctionExam.reload()}))},init:function(){this.onSearch()}};return{init:function(){t.init(),a.init()}}}();$((()=>{index.init()}));
var report=function(){var e={evaluationreports:{object:null,options:{ajax:{url:"/admin/generacion-actas/buscador/datatable",data:function(e){delete e.columns,e.careerId=$("#career_select").val(),e.code=$("#evaluation_report_code").val(),e.termId=$("#term_select").val(),e.curriculumId=$("#curriculum_select").val(),e.resolutionNumber=$("#resolution_number").val(),e.typeSelect=$("#type_select").val(),e.courseSearch=$("#course_input").val(),e.onlyReceived=!0}},columns:[{title:"Periodo",data:"term"},{title:"Curso",data:"course"},{title:"Acta",data:"code"},{title:"Fec. Recepción",data:"receptionDate"},{title:"Opciones",data:null,orderable:!1,render:function(e){downloadUrl=`/admin/generacion-actas/acta/${e.id}/pdf`.proto().parseURL();var t="";return t+="<button ",t+="class='btn btn-primary ",t+="m-btn btn-sm m-btn--icon btn-download' ",t+=` data-url=${downloadUrl}>`,t+="<span><i class='la la-file-text-o'></i><span>Descargar</span></span></button> ",1==e.type&&(t+="<button ",t+="class='btn btn-primary ",t+="m-btn btn-sm m-btn--icon btn-download-excel' ",t+=` data-id="${e.id}">`,t+="<span><i class='la la-file-excel-o'></i><span>EXCEL</span></span></button> "),t}}]},reload:function(){null===e.evaluationreports.object?e.evaluationreports.object=$("#data-table").DataTable(e.evaluationreports.options):e.evaluationreports.object.ajax.reload()},events:function(){$("#data-table").on("click",".btn-download",(function(){var e=$(this),t=e.data("url");e.addLoader(),$.fileDownload(t,{httpMethod:"GET"}).done((function(){e.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(t){e.removeLoader(),toastr.error("Sucedio un Error","Error")}))})),$("#data-table").on("click",".btn-download-excel",(function(){var e=$(this),t=`/admin/generacion-actas/acta/${e.data("id")}/excel`;e.addLoader(),$.fileDownload(t,{httpMethod:"GET"}).done((function(){e.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(t){e.removeLoader(),toastr.error("Sucedio un Error","Error")}))})),$("#data-table").on("click",".btn-detail",(function(){var e=$(this).data("url");window.location.href=e}))},init:function(){e.evaluationreports.events()}},init:function(){e.evaluationreports.init()}},t={init:function(){this.type.init(),this.terms.init(),this.careers.init(),this.curriculums.init()},type:{init:function(){$("#type_select").select2({minimumResultsForSearch:-1,placeholder:"Seleccionar tipo de busqueda"}),t.type.events()},events:function(){$("#type_select").on("change",(function(){if($("#resolution_code").val(""),$("#career_select").val(null).trigger("change"),$("#course_input").val(""),1==$(this).val())return $("#code_option").addClass("d-none"),void $("#course_option").removeClass("d-none");$("#btn-search").prop("disabled",!1),2==$(this).val()&&($("#code_option").removeClass("d-none"),$("#course_option").addClass("d-none"))}))}},terms:{init:function(){t.terms.load(),t.terms.events()},load:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(e){$("#term_select").select2({data:e.items}).trigger("change")}))},events:function(){$("#term_select").on("change",(function(){e.evaluationreports.reload()}))}},careers:{init:function(){t.careers.load(),t.careers.events()},load:function(){$.ajax({url:"/carreras/v2/get".proto().parseURL()}).done((function(e){$("#career_select").select2({placeholder:"Seleccionra escuela",data:e.items})}))},events:function(){$("#career_select").on("change",(function(e,o){if(void 0!==o&&o)return $("#curriculum_select").prop("disabled",!0),$("#course_select").prop("disabled",!0),!1;t.curriculums.load(),$("#course_select").html("<option value='0' disabled selected>Seleccione un Curso</option>"),$("#course_select").prop("disabled",!0)}))}},curriculums:{init:function(){$("#curriculum_select").select2(),t.curriculums.events()},load:function(){$("#curriculum_select").prop("disabled",!1),$("#curriculum_select").html("<option value='0' disabled selected>Seleccione un Plan</option>"),$.ajax({url:`/carreras/${$("#career_select").val()}/planestudio/get`.proto().parseURL()}).done((function(e){$("#curriculum_select").select2({data:e.items}).trigger("change")}))},events:function(){$("#curriculum_select").on("change",(function(t,o){e.evaluationreports.reload()}))}}},o={onSerachByCode:function(){$("#search_by_code").on("click",(function(){var t=$("#evaluation_report_code").val();null!=t&&""!==t?e.evaluationreports.reload():toastr.info("Debe ingresar el código del acta.","Información")}))},onSearchCourse:function(){$("#course_input").doneTyping((function(){e.evaluationreports.reload()}))},init:function(){o.onSerachByCode(),o.onSearchCourse()}};return{init:function(){t.init(),o.init(),e.init()}}}();$((()=>{report.init()}));
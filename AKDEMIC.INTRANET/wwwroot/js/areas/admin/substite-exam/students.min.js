var CourseTable=function(){var t=null,e=$("#Id").val(),a=[],n=getSimpleDataTableConfiguration({url:`/admin/examen-sustitutorio/estudiantes/${e}/getstudents`.proto().parseURL(),data:function(t){delete t.columns,t.search=$("#search").val()},pageLength:20,orderable:[],columns:[{data:"code",orderable:!1},{data:null,orderable:!1,render:function(t){var e=`<span>${t.name}</span>`;return t.hasGradeCorrection&&(e+='<span class="m--font-danger m--font-boldest">*Corrección de nota pendiente</span>'),t.hasGradeRecoveryExam&&(e+='<span class="m--font-danger m--font-boldest">*Examen de recuperación de nota pendiente</span>'),e}},{data:null,orderable:!1,render:function(t){return t.score}},{data:null,orderable:!1,title:"Opciones",render:function(t){var e="",n="";return n=t.isChecked?'checked="checked"':a.length>0?-1===a.findIndex((e=>e.studentId===t.id))?"":'checked="checked"':"",t.evaluated?e+="-":e+=`<span class="m-switch">\n                               <label>\n                                   <input type="checkbox" ${n} class="checkbox-status" data-studentId="${t.studentId}" name="cbkStatus">\n                                   <span></span>\n                               </label>\n                           </span>`,e}}]}),o=function(){$(".students-datatable").on("change","[name='cbkStatus']",(function(){var a=$(this),n=$(this).is(":checked"),o=$(this).data("studentid"),s=new FormData;s.append("SectionId",e),s.append("StudentId",o),s.append("Checked",n),$.ajax({url:"/admin/examen-sustitutorio/actualizar-alumno-examen",type:"POST",data:s,processData:!1,contentType:!1}).done((function(){t.ajax.reload(),swal({type:"success",title:"Completado",text:"Estado actualizado con éxito",confirmButtonText:"Excelente"})})).fail((function(t){var e=$(".students-datatable").find("[name='cbkStatus']").is(":checked");a.prop("checked",!e),swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:t.responseText})}))})),$(".btn-update-students").click((function(){var t=$(this);t.addLoader(),$.ajax({url:`/admin/examen-sustitutorio/actualizar-alumnos?sectionId=${e}`,type:"POST"}).done((function(t){swal({type:"success",title:"Completado",text:"Estudiantes actualizados con éxito",confirmButtonText:"Excelente"}),s.reload()})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:t.responseText})})).always((function(e){t.removeLoader()}))}))},s={init:function(){t=$(".students-datatable").DataTable(n)},reload:function(){t.ajax.reload()}},r=function(){s.init(),$("#search").doneTyping((function(){null!=s&&null!=s&&s.reload()})),$("#btn-pdf").on("click",(function(){})),o()},d={saveGrade:{object:$("#modal_save_grade"),form:{object:$("#form_save_grade").validate({submitHandler:function(e){$("#form_save_grade").find(":input").attr("disabled",!0);var a=new FormData;a.append("Score",$("#modal_save_grade").find("[name='Score']").val()),a.append("Id",$("#modal_save_grade").find("[name='Id']").val()),$.ajax({url:"/admin/examen-sustitutorio/asignar-nota",data:a,type:"POST",contentType:!1,processData:!1,success:function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),t.ajax.reload(),d.saveGrade.object.modal("hide")},error:function(t){null==t.responseText||""==t.responseText?toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error):toastr.error(t.responseText,_app.constants.toastr.title.error)},complete:function(){$("#form_save_grade").find(":input").attr("disabled",!1)}})}})},show:function(){$(".students-datatable").on("click",".btn-qualify",(function(){var t=$(this).data("id");d.saveGrade.object.find("[name='Id']").val(t),d.saveGrade.object.find("[name='Score']").val(""),d.saveGrade.object.modal("show")}))},init:function(){this.show()}},init:function(){this.saveGrade.init()}};return{init:function(){r(),d.init()}}}();$((function(){CourseTable.init()}));
var InitApp=function(){var e={init:function(){this.terms.init(),this.faculties.init(),this.careers.init(),this.orders.init(),this.curriculum.init(),this.academicyear.init()},terms:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(e){$(".select2-terms").select2({data:e.items}),null!==e.selected&&$(".select2-terms").val(e.selected).trigger("change")}))}},faculties:{init:function(){$.ajax({url:"/facultades/get"}).done((function(a){$(".select2-faculties").select2({data:a.items}),$(".select2-faculties").on("change",(function(){var a=$(".select2-faculties").val();a===_app.constants.guid.empty?($(".select2-careers").empty(),$(".select2-careers").select2({placeholder:"Seleccione una facultad",disabled:!0})):e.careers.load(a)})),$(".select2-faculties").trigger("change")}))}},careers:{init:function(){$(".select2-careers").select2({placeholder:"Seleccione una facultad",disabled:!0}),$(".select2-careers").on("change",(function(){var a=$(".select2-careers").val();a===_app.constants.guid.empty?($("#curriculum-select").empty(),$("#curriculum-select").select2({placeholder:"Seleccione una escuela",disabled:!0})):e.curriculum.load(a)}))},load:function(e){$(".select2-careers").empty(),$.ajax({url:`/carreras/get?fid=${e}`.proto().parseURL()}).done((function(e){$(".select2-careers").select2({data:e.items,placeholder:"Seleccione una carrera",disabled:!1}),$(".select2-careers").trigger("change")}))}},orders:{init:function(){$(".select2-orders").select2().on("change",(function(){}))}},curriculum:{init:function(){$("#curriculum-select").select2({placeholder:"Seleccione un plan",disabled:!0}),$("#curriculum-select").on("change",(function(){var a=$("#curriculum-select").val();a===_app.constants.guid.empty?e.academicyear.empty():e.academicyear.load(a)}))},load:function(e){$.ajax({url:`/carreras/${e}/planestudio/get`.proto().parseURL()}).done((function(e){$("#curriculum-select").empty(),$("#curriculum-select").select2({placeholder:"Seleccione un plan de estudios",data:e.items,disabled:!1}),$("#curriculum-select").trigger("change")}))},empty:function(){$("#curriculum-select").empty(),$("#curriculum-select").select2({placeholder:"Seleccione un plan",disabled:!0})}},academicyear:{init:function(){$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",disabled:!0}),$("#academicyear-select").on("change",(function(){}))},load:function(e){$.ajax({url:`/planes-estudio/${e}/niveles/get`.proto().parseURL()}).done((function(e){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un ciclo",data:e.items,disabled:!1,minimumResultsForSearch:-1})}))},empty:function(){$("#academicyear-select").empty(),$("#academicyear-select").select2({placeholder:"Seleccione un curso",disabled:!0})}}},a={students:{object:null,options:{ajax:{url:"/admin/situacion-academica/get".proto().parseURL(),data:function(e){e.fid=$(".select2-faculties").val(),e.cid=$(".select2-careers").val(),e.tid=$(".select2-terms").val(),e.curriculumId=$("#curriculum-select").val(),e.year=$("#academicyear-select").val(),e.academicOrder=$(".select2-orders").val(),e.searchValue=$("#search").val()}},order:[[3,"asc"]],columns:[{title:"Código",data:"code",width:"100px"},{title:"Estudiante",data:"name"},{title:"Escuela Profesional",data:"career",width:"250px"},{title:"Orden de Mérito",data:"order",width:"120px"},{title:"Prom. Ponderado",data:"grade",width:"120px"},{title:"Clasificación",data:null,width:"120px",render:function(e,a,t){if(null!==t.meritType&&t.meritType>1){var c={0:{text:_app.constants.academicOrder.none.text,value:_app.constants.academicOrder.none.value,class:"m-badge--info"},1:{text:_app.constants.academicOrder.none.text,value:_app.constants.academicOrder.none.value,class:"m-badge--info"},2:{text:_app.constants.academicOrder.upperThird.text,value:_app.constants.academicOrder.upperThird.value,class:"m-badge--metal"},3:{text:_app.constants.academicOrder.upperFifth.text,value:_app.constants.academicOrder.upperFifth.value,class:"m-badge--accent"},4:{text:_app.constants.academicOrder.upperTenth.text,value:_app.constants.academicOrder.upperTenth.value,class:"m-badge--focus"},5:{text:_app.constants.academicOrder.upperHalf.text,value:_app.constants.academicOrder.upperHalf.value,class:"m-badge--warning"}};return"<span class='m-badge "+c[t.meritType].class+" m-badge--wide'>"+c[t.meritType].text+"</span>"}return"Ninguno"}},{title:"Créditos Aprob.",width:"120px",data:"approvedCredits"}]},init:function(){this.object=$(".students-datatable").DataTable(this.options)},reload:function(){this.object.ajax.reload()},load:function(){null==a.students.object?a.students.init():a.students.reload()}}},t=function(){$("#search").doneTyping((function(){a.students.reload()}))},c=function(){$("#btn-apply").on("click",(function(){var e=$(".select2-terms").val(),t=$(".select2-faculties").val(),c=$(".select2-careers").val(),s=$("#curriculum-select").val(),l=$("#academicyear-select").val();null!=e&&e!=_app.constants.guid.empty&&null!=t&&t!=_app.constants.guid.empty&&null!=c&&c!=_app.constants.guid.empty&&null!=s&&s!=_app.constants.guid.empty&&-1!=l?a.students.load():toastr.error("Todos los campos son obligatorios",_app.constants.toastr.title.error)})),$("#print_pdf").on("click",(function(){var e=$(".select2-terms").val(),a=$(".select2-faculties").val(),t=$(".select2-careers").val(),c=$("#curriculum-select").val(),s=$("#academicyear-select").val();if(null!=e&&e!=_app.constants.guid.empty&&null!=a&&a!=_app.constants.guid.empty&&null!=t&&t!=_app.constants.guid.empty&&null!=c&&c!=_app.constants.guid.empty&&-1!=s){var l=$(this);l.addLoader(),$.fileDownload("/admin/situacion-academica/reporte-pdf".proto().parseURL(),{httpMethod:"GET",data:{fid:$(".select2-faculties").val(),cid:$(".select2-careers").val(),tid:$(".select2-terms").val(),curriculumId:$("#curriculum-select").val(),year:$("#academicyear-select").val(),academicOrder:$(".select2-orders").val()},successCallback:function(){l.removeLoader(),toastr.success("Archivo descargado satisfactoriamente","Éxito")}})}else toastr.error("Todos los campos son obligatorios",_app.constants.toastr.title.error)}))};return{init:function(){e.init(),t(),c()}}}();$((function(){InitApp.init()}));
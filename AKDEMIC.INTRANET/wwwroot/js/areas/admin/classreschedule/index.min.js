var InitApp=function(){var t={reprogram:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:"/admin/clases/reprogramaciones/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.startSearchDate=$("#startSearchDate").val(),t.endSearchDate=$("#endSearchDate").val(),t.search=$("#search").val()}},pageLength:50,orderable:[],columns:[{data:"fullName",title:"Nombre del Solicitante"},{data:"course",title:"Curso"},{data:"startTime",title:"Inicio (Actual)"},{data:"createdAt",title:"Fecha de Solicitud"},{data:"isPermanent",title:"¿Es Permanente?"},{title:"Opciones",data:null,render:function(t){return"<button data-target='#info_modal' data-toggle='modal' class='btn btn-info m-btn btn-sm m-btn--icon btn-detail' data-id='"+t.id+"'><i class='la la-eye'></i></button>"}}]},reload:function(){this.object.ajax.reload()},init:function(){this.object=$("#data-table").DataTable(this.options),this.events()},events:function(){$("#data-table").on("click",".btn-detail",(function(){var t=$(this).data("id");o.showmodal(t)})),$(".btn-aceptar").on("click",(function(){var t=$("#info_modal #Id").val(),e=$("#info_modal #teacher").val();o.accept(t,e)})),$(".btn-denegar").on("click",(function(){var t=$("#info_modal #Id").val(),e=$("#info_modal #teacher").val();o.deny(t,e)}))}},init:function(){this.reprogram.init()}},e="",a="",n=function(){$("#startSearchDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker}).on("changeDate",(function(a){$("#endSearchDate").datepicker("setStartDate",moment(a.date).toDate()),e=$("#startSearchDate").val(),t.reprogram.reload()})),$("#endSearchDate").datepicker({clearBtn:!0,orientation:"bottom",format:_app.constants.formats.datepicker}).on("changeDate",(function(e){$("#startSearchDate").datepicker("setEndDate",e.date),a=$("#endSearchDate").val(),t.reprogram.reload()})),$("#startSearchDate").datepicker().on("hide",(function(){var a=$("#startSearchDate").val();null==$("#startSearchDate").datepicker("getDate")&&$("#endSearchDate").datepicker("setStartDate",-1/0),a!=e&&(t.reprogram.reload(),e=a)})),$("#endSearchDate").datepicker().on("hide",(function(e){var n=$("#endSearchDate").val();null==$("#endSearchDate").datepicker("getDate")&&$("#startSearchDate").datepicker("setEndDate",1/0),n!=a&&(t.reprogram.reload(),a=n)}))},o={showmodal:function(t){$("#info_modal input").prop("disabled",!0),$.ajax({url:`/admin/clases/reprogramaciones/get/${t}`.proto().parseURL(),type:"GET",contentType:!1,processData:!1,success:function(t){$("#info_modal #Id").val(t.id),$("#info_modal #teacher").val(t.fullName),$("#info_modal #course").val(t.course),$("#info_modal #section").val(t.section),$("#info_modal #startDateActual").val(t.startTime),$("#info_modal #endDateActual").val(t.endTime),$("#info_modal #startDate").val(t.startDateTime),$("#info_modal #endDate").val(t.endDateTime),$("#info_modal #isPermanent").val(t.isPermanent)},error:function(t){}})},accept:function(e,a){swal({title:"¿Está seguro?",text:"¿Desea aceptar la solicitud de reprogramación de clase de "+a+" ?",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, aceptarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{var o=new FormData;o.append("Id",e),$.ajax({url:"/admin/clases/reprogramaciones/aceptar/post".proto().parseURL(),type:"POST",data:o,contentType:!1,processData:!1,success:function(e){$("#info_modal").modal("hide"),swal({type:"success",title:"Completado",text:"Se ha aceptado la solicitud de reprogramación de clase de "+a+" con exito.",confirmButtonText:"Excelente"}).then(t.reprogram.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:502===t.status?"No hay respuesta del servidor":t.responseText})}})})),allowOutsideClick:()=>!swal.isLoading()})},deny:function(e,a){swal({title:"¿Está seguro?",text:"¿Desea denegar la solicitud de reprogramación de clase de "+a+" ?",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, aceptarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((n=>{$.ajax({url:"/admin/clases/reprogramaciones/denegar/post".proto().parseURL(),type:"POST",data:{id:e},success:function(e){$("#info_modal").modal("hide"),swal({type:"success",title:"Completado",text:"Se ha denegado la solicitud de reprogramación de clase de "+a+" con exito.",confirmButtonText:"Excelente"}).then(t.reprogram.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:502===t.status?"No hay respuesta del servidor":t.responseText})}})})),allowOutsideClick:()=>!swal.isLoading()})}},r=function(){$("#search").doneTyping((function(){t.reprogram.reload()}))};return{init:function(){t.init(),n(),r()}}}();$((function(){InitApp.init()}));
var InitApp=function(){const t=$("#data-table"),e="#create-modal",a="#edit-modal";var n={courses:{object:null,options:{ajax:{url:"/admin/cursos-extracurriculares/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(t){t.search=$("#search").val()}},columns:[{title:"Código",data:"code"},{title:"Nombre",data:"name"},{title:"Área",data:"area"},{title:"Créditos",data:"credits"},{title:"Precio",data:"price",render:function(t){return 0==t?"Gratuito":`S/. ${t.toFixed(2)}`}},{title:"Opciones",data:null,orderable:!1,render:function(t){return`<button type="button" data-object="${t.proto().encode()}" class="btn btn-info btn-sm m-btn m-btn--icon btn-edit" title=""><i class="la la-edit"></i> Editar</button> <button class="btn btn-danger m-btn btn-sm m-btn--icon m-btn--icon-only btn-delete" data-id="${t.id}"><i class="la la-trash"></i></button>`}}]},init:function(){this.object=t.DataTable(this.options),t.on("click",".btn-edit",(function(t){var e=$(this).data("object");e=e.proto().decode(),o.edit.load(e)})),t.on("click",".btn-delete",(function(t){var e=$(this).data("id");o.delete.load(e)}))},reload:function(){this.object.ajax.reload()}}},o={create:{object:$("#create-form").validate({submitHandler:function(t){mApp.block(`${e} .modal-content`),$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize()}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),n.courses.reload(),o.create.clear()})).fail((function(t){null!==t.responseText&&""!==t.responseText?$("#create-form-alert-txt").html(t.responseText):$("#create-form-alert-txt").html(_app.constants.ajax.message.error),$("#create-form-alert").removeClass("m--hide").show()})).always((function(){mApp.unblock("#create-modal .modal-content")}))}}),clear:function(){o.create.object.resetForm()}},edit:{object:$("#edit-form").validate({submitHandler:function(t){mApp.block(`${a} .modal-content`),$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize()}).done((function(){$(".modal").modal("hide"),$(".m-alert").addClass("m--hide"),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),n.courses.reload(),o.edit.clear()})).fail((function(t){null!==t.responseText&&""!==t.responseText?$("#edit-form-alert-txt").html(t.responseText):$("#edit-form-alert-txt").html(_app.constants.ajax.message.error),$("#edit-form-alert").removeClass("m--hide").show()})).always((function(){mApp.unblock("#edit-modal .modal-content")}))}}),load:function(t){$("#Edit_Id").val(t.id),$("#Edit_Code").val(t.code),$("#Edit_Name").val(t.name),$("#Edit_Credits").val(t.credits),$("#Edit_Description").val(t.description),$("#Edit_Price").val(t.price),$("#Edit_AreaId").val(t.areaId).trigger("change"),$(a).modal("toggle")},clear:function(){o.edit.object.resetForm()}},delete:{load:function(t){swal({title:"¿Está seguro?",text:"El curso será elimininado permanentemente",type:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar"}).then((function(e){e.value&&$.ajax({url:"/admin/cursos-extracurriculares/eliminar",type:"POST",data:{id:t},success:function(){n.courses.reload(),toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)},error:function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}})}))}}},r={areas:{init:function(){$.ajax({url:"/areas-extracurriculares/cursos/get".proto().parseURL()}).done((function(t){$("#Add_AreaId").select2({placeholder:"Seleccione un área",dropdownParent:$(e),data:t.items}),$("#Edit_AreaId").select2({placeholder:"Seleccione un área",dropdownParent:$(a),data:t.items})}))}},init:function(){this.areas.init()}},s=function(){$("#search").doneTyping((function(){n.courses.reload()}))};return{init:function(){n.courses.init(),r.init(),s()}}}();$((function(){InitApp.init()}));
var Workload=function(){var t=null,e=null,a=null,n={data:{type:"remote",source:{read:{url:""}}},detail:{title:"Cargar subtablas",content:function(t){var e=$("<div/>").attr("id","child_data_local_"+t.data.id).appendTo(t.detailCell).mDatatable({data:{type:"remote",source:{read:{url:`/admin/carga-lectiva/${$(".select2-teachers").val()}/cursos/${t.data.id}/secciones/get`.proto().parseURL()}}},sortable:!1,pagination:!1,columns:[{field:"code",title:"Sección",textAlign:"center"},{field:"studentsCount",title:"N° de Estudiantes",textAlign:"center"},{field:"Id",title:"Estudiantes",template:function(e){return`<button data-sectionid="${e.id}" data-courseid="${t.data.id}" class="btn btn-info btn-sm m-btn m-btn--icon btn-students"><span><i class="la la-edit students"></i><span> Alumnos </span></span></button>`}},{field:"Id2",title:"Evaluaciones",template:function(e){return`<button data-sectionid="${e.id}" data-courseid="${t.data.id}" class="btn btn-success btn-sm m-btn m-btn--icon btn-evaluations"><span><i class="la la-edit evaluations"></i><span> Evaluaciones </span></span></button>`}}]});e.on("click",".btn-students",(function(){var t=$(this).data("courseid"),e=$(this).data("sectionid");$("#students_modal").one("shown.bs.modal",(function(){s.students.init(e,t)})),$("#students_modal").one("hidden.bs.modal",(function(){s.students.destroy()})),$("#students_modal").modal("show")})),e.on("click",".btn-evaluations",(function(){var t=$(this).data("courseid"),e=$(this).data("sectionid");$("#evaluations_modal").one("shown.bs.modal",(function(){s.evaluations.init(e,t)})),$("#evaluations_modal").one("hidden.bs.modal",(function(){s.evaluations.destroy()})),$("#evaluations_modal").modal("show")}))}},sortable:!1,pagination:!1,columns:[{field:"id",title:"",sortable:!1,width:20,textAlign:"center"},{field:"code",title:"Código",textAlign:"center"},{field:"name",title:"Curso"},{field:"courseType.name",title:"Tipo",textAlign:"center"},{field:"areaCareer",title:"Área o Carrera"}]},i={data:{type:"remote",source:{read:{url:""}}},sortable:!1,pagination:!1,columns:[{field:"user.userName",title:"Código",width:80},{field:"user.fullName",title:"Estudiante"},{field:"career.name",title:"Carrera"}]},o={data:{type:"remote",source:{read:{url:""}}},sortable:!1,pagination:!1,columns:[{field:"name",title:"Evaluación"},{field:"taken",title:"Tomada",width:80,textAlign:"center",template:function(t){return t.taken?"Si":"No"}}]},s={courses:{init:function(e){null!==t&&(t.destroy(),t=null),n.data.source.read.url=`/admin/carga-lectiva/${e}/cursos/get`.proto().parseURL(),t=$("#workload_table").mDatatable(n)}},students:{init:function(t,a){this.destroy(),i.data.source.read.url=`/admin/carga-lectiva/${$(".select2-teachers").val()}/cursos/${a}/secciones/${t}/alumnos/get`.proto().parseURL(),e=$("#students_table").mDatatable(i)},destroy:function(){null!==e&&(e.destroy(),e=null)}},evaluations:{init:function(t,e){this.destroy(),o.data.source.read.url=`/admin/carga-lectiva/${$(".select2-teachers").val()}/cursos/${e}/secciones/${t}/evaluaciones/get`.proto().parseURL(),a=$("#evaluations_table").mDatatable(o)},destroy:function(){null!==a&&(a.destroy(),a=null)}}},l={onShowCalendarModal:function(){$("#show_schedule").click((function(){r.calendar.show()}))},init:function(){this.onShowCalendarModal(),$("#modal_calendar").on("shown.bs.modal",(function(t){var e=$("#teachers").val();c.load(e)}))}},d={init:function(){this.faculties.init(),this.academicDepartments.init(),this.teachers.init()},faculties:{init:function(){this.load(),this.events()},load:function(){$.ajax({url:"/facultades/get".proto().parseURL()}).done((function(t){$("#faculties").select2({data:t.items,placeholder:"Facultad"})}))},events:function(){$("#faculties").on("change",(function(){d.academicDepartments.load(),d.teachers.load()}))}},academicDepartments:{init:function(){this.load(),this.events()},load:function(){var t=$("#faculties").val();$.ajax({url:`/departamentos-academicos/get?facultyId=${t}`.proto().parseURL()}).done((function(t){$("#academicDepartments").empty(),$("#academicDepartments").html('<option value="0" disabled selected>Seleccione una Opcion</option>'),$("#academicDepartments").select2({data:t,placeholder:"Departamento Académico"})}))},events:function(){$("#academicDepartments").on("change",(function(){d.teachers.load()}))}},teachers:{init:function(){this.load(),this.events()},load:function(){var t=$("#faculties").val(),e=$("#academicDepartments").val();$.ajax({url:`/profesores/departamento-academico/get/${t}/${e}`.proto().parseURL()}).done((function(t){$("#teachers").empty(),$("#teachers").select2({data:t.items,placeholder:"Docente"}).trigger("change")}))},events:function(){$("#teachers").on("change",(function(){s.courses.init($(this).val())}))}}},c={object:null,defaultSettings:{allDaySlot:!1,aspectRatio:2,businessHours:{dow:[1,2,3,4,5,6],end:"24:00",start:"07:00"},columnFormat:"dddd",contentHeight:600,defaultView:"agendaWeek",editable:!1,eventRender:function(t,e){e.hasClass("fc-day-grid-event")?(e.data("content",t.description),e.data("placement","top"),mApp.initPopover(e)):e.hasClass("fc-time-grid-event")?e.find(".fc-title").append('<div class="fc-description">'+t.description+"</div>"):0!==e.find(".fc-list-item-title").length&&e.find(".fc-list-item-title").append('<div class="fc-description">'+t.description+"</div>");var a=e.find(".fc-title").clone().children().remove().end().text();e.css("border-color","#"+a.proto().toRGB()).css("border-width","2px")},events:{className:"m-fc-event--primary",error:function(){toastr.error("Ocurrió un problema con el servidor","Error")},url:""},eventAfterAllRender:function(){$(".fc-prev-button").prop("disabled",!1),$(".fc-next-button").prop("disabled",!1),mApp.unblock(".m-calendar__container")},firstDay:1,header:{left:"prev,next today",center:"title"},height:600,locale:"es",maxTime:"24:00:00",minTime:"06:00:00",monthNames:monthNames,dayNames:dayNames,monthNamesShort:monthNamesShort,dayNamesShort:dayNamesShort,buttonText:{today:"hoy",month:"mes",week:"semana",day:"día"},slotDuration:"00:30:00",timeFormat:"h(:mm)A"},load:function(t){c.destroy(),c.defaultSettings.events.url=`/admin/carga-lectiva/get-horario/${t}`.proto().parseURL(),mApp.block(".m-calendar__container",{type:"loader",message:"Cargando..."}),c.object=$(".m-calendar__container").fullCalendar(c.defaultSettings)},destroy:function(){null!==c.object&&($(c.object).fullCalendar("destroy"),c.object=null)}},r={calendar:{show:function(t){$("#modal_calendar").modal("show")}}};return{init:function(){l.init(),d.init()}}}();jQuery(document).ready((function(){Workload.init()}));
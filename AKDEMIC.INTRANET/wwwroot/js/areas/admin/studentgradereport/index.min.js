var StudentGradeReport=function(){var e=null,t=null,r=function(){var t=$("#career-filter-1").val(),r=$("#program-filter-1").val(),a=$("#term-filter-1").val();$("#btnLoad").show(),$("#btnLoad").addLoader(),$.ajax({url:"/admin/reporte-notas/carrera".proto().parseURL(),data:{cid:t,pid:r,tid:a}}).done((function(t){$("#btnLoad").removeLoader(),$("#load").hide(),$("#chart-filter-1").show();var r=[["Periodo","[0-5]","[5-10]","[10-15]","[15-20]"]];t.forEach((function(e,t){r.push(e)}));var a=google.visualization.arrayToDataTable(r),i=new google.visualization.ColumnChart(document.getElementById("columnchart_material_1"));i.draw(a,{title:"Distribución de Estudiantes por Promedio Ponderado",subtitle:"Clasificados por Rango de Nota y Periodo Académico",vAxes:{0:{title:"",viewWindow:{min:0},gridlines:{count:10}}}}),e=i}))},a=function(){var e=$("#career-filter-2").val(),r=$("#course-filter-2").val(),a=$("#term-filter-2").val(),i=$("#curriculums-filter-2").val();$("#btnLoad-2").show(),$("#btnLoad-2").addLoader(),$.ajax({url:"/admin/reporte-notas/curso".proto().parseURL(),type:"GET",dataType:"JSON",data:{tid:a,cid:e,ccid:r,planId:i}}).done((function(e){$("#btnLoad-2").removeLoader(),$("#load-2").hide(),$("#columnchart_material_2").show(),mApp.unblockPage();var r=[["Periodo","[0-5]","[5-10]","[10-15]","[15-20]"]];e.forEach((function(e,t){r.push(e)}));var a=google.visualization.arrayToDataTable(r),i=new google.visualization.ColumnChart(document.getElementById("columnchart_material_2"));i.draw(a,{title:"Distribución de Estudiantes por Promedio Final de Curso",subtitle:"Clasificados por Rango de Nota y Periodo Académico",vAxes:{0:{title:"",viewWindow:{min:0},gridlines:{count:10}}}}),t=i}))},i={init:function(){$("#btnLoad").hide(),$("#chart-filter-1").hide(),$("#btnLoad-2").hide(),$("#columnchart_material_2").hide(),$("#term-filter-1").on("change",(function(){null!=$("#program-filter-1").val()&&""!=$("#program-filter-1").val()&&r()})),$("#faculty-filter-1").on("change",(function(){i.careers.filter1($(this).val())})),$("#career-filter-1").on("change",(function(){i.academicPrograms.filter1($(this).val())})),$("#program-filter-1").on("change",(function(){r()})),$("#term-filter-2").on("change",(function(){null!=$("#course-filter-2").val()&&""!=$("#course-filter-2").val()&&a()})),$("#faculty-filter-2").on("change",(function(){i.careers.filter2($(this).val())})),$("#career-filter-2").on("change",(function(){i.curriculums.filter2($(this).val())})),$("#curriculums-filter-2").on("change",(function(){i.courses.filter2($(this).val())})),$("#course-filter-2").on("change",(function(){a()})),$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(e){$(".select2-terms").select2({data:e.items}),null!==e.selected&&($(".select2-terms").val(e.selected),$(".select2-terms").trigger("change.select2"))})),$.ajax({url:"/facultades/get".proto().parseURL()}).done((function(e){$(".select2-faculties").select2({data:e.items}).trigger("change")}))},careers:{filter1:function(e){$.ajax({url:("/carreras/get?fid="+e).proto().parseURL()}).done((function(e){$("#career-filter-1").empty(),$("#career-filter-1").select2({data:e.items,placeholder:"Escuela"}).trigger("change")}))},filter2:function(e){$.ajax({url:("/carreras/get?fid="+e).proto().parseURL()}).done((function(e){$("#career-filter-2").empty(),$("#career-filter-2").select2({data:e.items,placeholder:"Escuela"}).trigger("change")}))}},curriculums:{filter2:function(e){null!=e&&e!=_app.constants.guid.empty?$.ajax({url:("/carreras/"+e+"/planestudio/get").proto().parseURL()}).done((function(e){$("#curriculums-filter-2").empty(),$("#curriculums-filter-2").select2({data:e.items,placeholder:"Planes"}).trigger("change")})):($("#curriculums-filter-2").empty(),$("#curriculums-filter-2").select2({placeholder:"Planes"}).trigger("change"))}},courses:{filter2:function(e){null!=e&&e!=_app.constants.guid.empty?$.ajax({url:("/curriculum/"+e+"/cursos/get").proto().parseURL()}).done((function(e){$("#course-filter-2").empty(),$("#course-filter-2").select2({data:e.items,placeholder:"Curso"}),e.items.length>0&&a()})):($("#course-filter-2").empty(),$("#course-filter-2").select2({placeholder:"Curso"}))}},academicPrograms:{filter1:function(e){$.ajax({url:("/carreras/"+e+"/programas/get").proto().parseURL()}).done((function(e){$("#program-filter-1").empty(),$("#program-filter-1").select2({data:e.items,placeholder:"Programa"}),e.items.length>0&&r()}))}}};return{init:function(){google.charts.load("current",{packages:["bar"]}),google.charts.load("current",{packages:["corechart","bar"]}),$(".save-pdf").on("click",(function(){var r=$(this).data("id"),a=new jsPDF("p","mm","a4"),i=a.internal.pageSize.width,o=a.internal.pageSize.height;if(1==r){var l=o/(c=document.getElementById("columnchart_material_1")).clientHeight,n=(u=i/c.clientWidth)>l?l:u;a.addImage(e.getImageURI(),0,0,c.clientWidth*n,c.clientHeight*n),a.save("chart1.pdf")}else{var c,u;l=o/(c=document.getElementById("columnchart_material_2")).clientHeight,n=(u=i/c.clientWidth)>l?l:u,a.addImage(t.getImageURI(),0,0,c.clientWidth*n,c.clientHeight*n),a.save("chart2.pdf")}})),i.init()}}}();$((function(){StudentGradeReport.init()}));
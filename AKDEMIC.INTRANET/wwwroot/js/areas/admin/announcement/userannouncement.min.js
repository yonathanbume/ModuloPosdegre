var UserTable=function(){var t=null,e={responsive:!0,processing:!0,serverSide:!0,ajax:{url:"/admin/anuncios/por-usuarios/get".proto().parseURL(),data:function(t){t.search=$("#search").val()}},columns:[{data:"fullName",title:"Usuario"},{data:"title",title:"Título"},{data:"type",title:"Tipo"},{data:"startDate",title:"Fecha Inicio"},{data:"endDate",title:"Fecha Fin"},{data:null,title:"Opciones",render:function(t,e,a,n){return`<button data-toggle="modal" data-target="#EditModal" data-id="${t.id}" class="btn btn-sm btn-info edit"> <i class= "fa fa-edit"></i> </button>\n                            <button data-id="${t.id}" class="btn btn-sm btn-danger delete"> <i class="fa fa-trash"></i> </button>`}}]},a=function(){$("#add-form").validate({submitHandler:function(e){var a=$(e).find('button[type="submit"]');a.addLoader();var n=new FormData($("#add-form")[0]);$.ajax({type:"POST",url:"/admin/anuncios/por-usuarios/guardar".proto().parseURL(),data:n,processData:!1,contentType:!1,success:function(){$("#AddModal").modal("hide"),swal({type:"success",title:_app.constants.toastr.title.success,text:_app.constants.toastr.message.success.task,confirmButtonText:"Excelente"}).then(t.ajax.reload()),$("#add-form")[0].reset()},error:function(t){toastr.error(t.responseText,_app.constants.toastr.title.error)},complete:function(){a.removeLoader()}})}})},n=function(){$("#edit-form").validate({submitHandler:function(e){var a=$(e).find('button[type="submit"]');a.addLoader();var n=new FormData($("#edit-form")[0]);$.ajax({type:"POST",url:"/admin/anuncios/por-usuarios/editar".proto().parseURL(),data:n,processData:!1,contentType:!1,success:function(){$("#EditModal").modal("hide"),swal({type:"success",title:_app.constants.toastr.title.success,text:_app.constants.toastr.message.success.task,confirmButtonText:"Excelente"}).then(t.ajax.reload()),$("#edit-form")[0].reset()},error:function(t){swal({type:"error",title:_app.constants.toastr.title.error,confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:t.responseText})},complete:function(){a.removeLoader()}})}})},o=function(){t.on("click",".edit",(function(){var t=$(this).data("id");$.ajax({url:`/admin/anuncios/por-usuarios/get/${t}`.proto().parseURL(),type:"GET",contentType:"application/json",success:function(t){$("#edit-form select[name='Type']").val(t.type).trigger("change");var e=new Option(t.fullName,t.userId,!0,!0);$("#edit-user-select2").append(e).trigger("change"),$("#edit-form input[name='Id']").val(t.id),$("#edit-form input[name='Description']").val(t.description),$("#edit-form input[name='Title']").val(t.title),$("#edit-form input[name='StartDate']").val(t.startDate),$("#edit-form input[name='EndDate']").val(t.endDate)}})})),t.on("click",".delete",(function(){var e=$(this).data("id");swal({title:"¿Está seguro?",text:"El registro será eliminado permanentemente",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:()=>new Promise((a=>{$.ajax({url:`/admin/anuncios/por-usuarios/eliminar/${e}`.proto().parseURL(),type:"POST",data:{id:e},success:function(e){swal({type:"success",title:"Completado",text:"El registro ha sido eliminado con éxito",confirmButtonText:"Excelente"}).then(t.ajax.reload())},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"El registro presenta información relacionada"})}})})),allowOutsideClick:()=>!swal.isLoading()})})),$("#search").doneTyping((function(){r.init()})),$("#StartDateAdd, #StartDateEdit, #EndDateAdd, #EndDateEdit").datepicker({format:_app.constants.formats.datepicker}),$("#add-user-select2").select2({placeholder:"Buscar...",dropdownParent:$("#AddModal"),ajax:{url:"/admin/anuncios/por-usuarios/usuarios/get".proto().parseURL(),dataType:"json",data:function(t){return{term:t.term}},processResults:function(t,e){return{results:t.items}},cache:!0},minimumInputLength:3}),$("#edit-user-select2").select2({placeholder:"Buscar...",dropdownParent:$("#EditModal"),ajax:{url:"/admin/anuncios/por-usuarios/usuarios/get".proto().parseURL(),dataType:"json",data:function(t){return{term:t.term}},processResults:function(t,e){return{results:t.items}},cache:!0},minimumInputLength:3})},r={init:function(){t?t.ajax.reload():(t=$(".users-datatable").DataTable(e),o())}};return{init:function(){r.init(),a(),n()}}}();$((function(){UserTable.init()}));
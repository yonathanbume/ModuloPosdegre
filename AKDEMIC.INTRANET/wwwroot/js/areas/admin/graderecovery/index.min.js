var graderecover=function(){var e={sections:{object:null,options:{ajax:{url:"/admin/recuperacion-notas/get",type:"GET",data:function(e){e.careerId=$("#careerId").val(),e.curriculumId=$("#curriculumId").val(),e.courseId=$("#courses").val(),e.search=$("#search").val()}},columns:[{data:"career",title:"Carrera"},{data:"courseCode",title:"Cod. Curso"},{data:"courseName",title:"Curso"},{data:"section",title:"Sección"},{data:"academicYear",title:"Ciclo"},{data:null,title:"Opciones",render:function(e){var a="";return a+=`<a class="btn btn-primary m-btn btn-sm m-btn--icon m-btn--icon-only" href="/admin/recuperacion-notas/examen/detalles/${e.id}" title="Aprobar"><i class="la la-eye"></i></a>`}}]},reload:function(){null===this.object?this.object=$("#ajax_data").DataTable(this.options):this.object.ajax.reload()},init:function(){e.sections.reload()}},init:function(){e.sections.init()}},a={addExam:{object:$("#create_modal"),validate:function(){$("#create_form").validate({submitHandler:function(e,t){t.preventDefault();var n=a.addExam.object.find("button[type='submit']");n.addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0);var i=new FormData(e);$.ajax({url:"/admin/recuperacion-notas/agregar-seccion",type:"POST",data:i,contentType:!1,processData:!1}).done((function(e){window.location.href=`/admin/recuperacion-notas/examen/detalles/${e}`})).fail((function(e){n.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===e.status?"No hay respuesta del servidor":e.responseText})}))}})},init:function(){this.validate()}},init:function(){this.addExam.init()}},t={career:{load:function(){$.ajax({url:"/carreras/v3/get".proto().parseURL(),type:"get"}).done((function(e){a.addExam.object.find("[name='CareerId']").select2({data:e.items,allowClear:!0,minimumInputLength:0,placeholder:"Seleccione escuela profesional",dropdownParent:a.addExam.object}).trigger("change"),$("#careerId").select2({data:e.items,minimumInputLength:0,placeholder:"Seleccione escuela profesional"})}))},onChange:function(){a.addExam.object.find("[name='CareerId']").on("change",(function(){var e=$(this).val();t.curriculum.load(e),a.addExam.object.find("[name='CourseId']").attr("disabled",!0)})),$("#careerId").on("change",(function(){var e=$(this).val();t.curriculum.load_v2(e)}))},init:function(){this.load(),this.onChange()}},curriculum:{load:function(e){a.addExam.object.find("[name='CurriculumId']").empty(),a.addExam.object.find("[name='CurriculumId']").attr("disabled",!0),null!==e?$.ajax({url:`/carreras/${e}/planestudio/get`}).done((function(e){a.addExam.object.find("[name='CurriculumId']").select2({placeholder:"Seleccionar Plan de Estudio",data:e.items,dropdownParent:a.addExam.object}).trigger("change"),a.addExam.object.find("[name='CurriculumId']").attr("disabled",!1)})):a.addExam.object.find("[name='CurriculumId']").select2({placeholder:"Seleccionar Plan de Estudio",disabled:!0,dropdownParent:a.addExam.object}).trigger("change")},load_v2:function(e){$("#curriculumId").empty(),null!==e?$.ajax({url:`/carreras/${e}/planestudio/get`}).done((function(e){e.items.unshift({id:"0",text:"Todos"}),$("#curriculumId").select2({placeholder:"Seleccionar Plan de Estudio",data:e.items}).trigger("change"),$("#curriculumId").attr("disabled",!1)})):$("#curriculumId").select2({placeholder:"Seleccionar Plan de Estudio",disabled:!0}).trigger("change")},onChange:function(){a.addExam.object.find("[name='CurriculumId']").on("change",(function(){var e=$(this).val();t.courses.load(e)})),$("#curriculumId").on("change",(function(){$(this).val();e.sections.reload()}))},init:function(){a.addExam.object.find("[name='CurriculumId']").select2({placeholder:"Seleccionar Plan de Estudio",disabled:!0}),$("#curriculumId").select2({placeholder:"Seleccionar Plan de Estudio",disabled:!0}),this.onChange()}},courses:{load:function(e){a.addExam.object.find("[name='CourseId']").empty(),a.addExam.object.find("[name='CourseId']").attr("disabled",!0),$.ajax({url:`/curriculum/${e}/cursos/get`}).done((function(e){a.addExam.object.find("[name='CourseId']").select2({placeholder:"Seleccionar Curso",data:e.items,dropdownParent:a.addExam.object}).trigger("change"),a.addExam.object.find("[name='CourseId']").attr("disabled",!1)}))},load_v2:function(e){$("#courses").empty(),null!==e?$.ajax({url:`/curriculum/${e}/cursos/get`}).done((function(e){$("#courses").select2({placeholder:"Seleccionar Curso",data:e.items}).trigger("change"),$("#courses").attr("disabled",!1)})):$("#courses").select2({placeholder:"Seleccionar Curso",disabled:!0}).trigger("change")},onChange:function(){a.addExam.object.find("[name='CourseId']").on("change",(function(){var e=$(this).val();t.sections.load(e)}))},init:function(){a.addExam.object.find("[name='CourseId']").select2({placeholder:"Seleccionar Curso",disabled:!0}),$("#courses").select2({placeholder:"Seleccionar Curso",disabled:!0}),this.onChange()}},sections:{load:function(e){a.addExam.object.find("[name='SectionId']").empty(),a.addExam.object.find("[name='SectionId']").attr("disabled",!0),$.ajax({url:`/cursos/${e}/secciones/get`}).done((function(e){a.addExam.object.find("[name='SectionId']").attr("disabled",!1),a.addExam.object.find("[name='SectionId']").select2({data:e.items,dropdownParent:a.addExam.object,placeholder:"Seleccionar sección"})}))},init:function(){a.addExam.object.find("[name='CourseId']").select2({placeholder:"Seleccionar sección",disabled:!0})}},classroom:{load:function(){a.addExam.object.find("[name='ClassroomId']").select2({ajax:{delay:1e3,url:"/aular/get/v2".proto().parseURL()},allowClear:!0,minimumInputLength:0,placeholder:"Seleccione aula",dropdownParent:a.addExam.object})},init:function(){this.load()}},init:function(){this.career.init(),this.curriculum.init(),this.courses.init(),this.sections.init(),this.classroom.init()}},n={startDate:function(){a.addExam.object.find("[name='StartDate']").datepicker()},startTime:function(){a.addExam.object.find("[name='StartTime']").timepicker({minuteStep:5}).timepicker("setTime","7:00 AM")},init:function(){this.startDate(),this.startTime()}},i={onSearch:function(){$("#search").doneTyping((function(){e.sections.reload()}))},init:function(){this.onSearch()}};return{init:function(){e.init(),t.init(),n.init(),a.init(),i.init()}}}();$((()=>{graderecover.init()}));
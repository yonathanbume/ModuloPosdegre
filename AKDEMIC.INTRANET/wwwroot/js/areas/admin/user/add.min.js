var Form=function(){var e={init:function(){$.ajax({url:"/dependencias/todas".proto().parseURL()}).done((function(e){$(".select2-dependencies").select2({minimumInputLength:0,placeholder:"Dependencias",data:e.items})}))}},t={init:function(){$.ajax({url:"/roles/get".proto().parseURL()}).done((function(e){$(".select2-roles").select2({placeholder:"Roles",minimumInputLength:0,data:e.items})}))}},n={init:function(){this.picture.init()},picture:{init:function(){$("#Picture").on("change",(function(e){var t=(e.target||window.event.srcElement).files;if(FileReader&&t&&t.length){var n=new FileReader;n.onload=function(){$("#current-picture").attr("src",n.result)},n.readAsDataURL(t[0])}else console.log("File Reader not supported.")}))}}},o={init:function(){this.birthDate.init()},birthDate:{init:function(){$("#BirthDate").datepicker({format:_app.constants.formats.datepicker}).one("show",(function(){$(this).val("01/01/1990").datepicker("update").trigger("change")}))}}},a=function(){$("#Dni").keypress((function(e){(46===e.which||e.which<48||e.which>57)&&e.preventDefault()})).on("paste",(function(e){e.preventDefault()})),$("#PhoneNumber").keypress((function(e){(46===e.which||e.which<48||e.which>57)&&e.preventDefault()})).on("paste",(function(e){e.preventDefault()}))},r=function(e){var t=new FormData($(e).get(0));$("#add-form input").attr("disabled",!0),$("#add-form select").attr("disabled",!0),$("#btnSave").addLoader(),$.ajax({data:t,type:"POST",contentType:!1,processData:!1,url:$(e).attr("action")}).always((function(){$("#add-form input").attr("disabled",!1),$("#add-form select").attr("disabled",!1),$("#btnSave").removeLoader()})).done((function(e){location.href="/admin/usuarios".proto().parseURL()})).fail((function(e){null!=e.responseText?$("#alert-text").html(e.responseText):$("#alert-text").html(_app.constants.toastr.message.error.task),$("#m-form_alert").removeClass("m--hide").show(),$("body,html").animate({scrollTop:$("#m-form_alert").offset().top-70},800)}))},i=function(){$("#add-form").validate({rules:{ConfirmedPassword:{equalTo:"#Password"}},messages:{PaternalSurname:{pattern:"Por favor, el apellido solo debe contener letras."},MaternalSurname:{pattern:"Por favor, el apellido solo debe contener letras."},PhoneNumber:{pattern:"El campo no tiene el formato correcto (Ejemplo: 989419189 o 3255564 )"},Dni:{pattern:"Por favor, el Dni solo debe contener números.",maxlength:"Por favor, el Dni solo debe 8 contener dígitos.",minlength:"Por favor, el Dni debe 8 contener dígitos."}},submitHandler:function(e,t){t.preventDefault(),$.ajax({url:"/admin/usuarios/validar-correo".proto().parseURL(),data:{email:$("#Email").val()}}).done((function(t){1==t||"true"==t?swal({type:"warning",title:"Correo ya registrado",text:"Ya existe un usuario con el correo especificado. ¿Desea continuar y usar el mismo correo?",confirmButtonText:"Aceptar",showCancelButton:!0,showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((()=>{r(e),swal.close()}))}):r(e)}))}})};return{init:function(){e.init(),t.init(),i(),n.init(),o.init(),a()}}}();$((function(){Form.init()}));
var UserTable=function(){var t=null,n={responsive:!0,processing:!0,serverSide:!0,ajax:{url:"/admin/usuarios/get".proto().parseURL(),data:function(t){t.search=$("#search").val(),t.rolesJson=JSON.stringify($("#select_roles").val())}},columns:[{title:"Foto",data:null,orderable:!1,render:function(t,n,a){var e="";return e+=`<img src="${a.picture||"/images/demo/user.png"}" width="50px" />`}},{title:"Nombre y Apellidos",data:"fullName"},{title:"DNI",data:"dni"},{title:"Usuario",data:"userName"},{title:"Teléfono",data:"phoneNumber"},{title:"Opciones",data:null,orderable:!1,render:function(t,n,a){return`<button data-id="${a.id}" class="btn btn-info btn-sm m-btn m-btn--icon btn-detail" title="Detalle"><span><i class="la la-eye"></i><span>Ver Detalle</span></span></button> <button data-id="${a.id}" class="btn btn-primary btn-sm m-btn m-btn--icon btn-edit" title="Editar"><span><i class="la la-edit"></i><span>Editar</span></span></button> <button data-id="${a.id}" class="btn btn-danger btn-sm m-btn m-btn--icon btn-delete" title="Eliminar"><i class="la la-trash"></i></button>`}}]},a=function(){t.on("click",".btn-detail",(function(){var t=$(this).data("id");location.href=`/admin/usuarios/${t}/detalle`.proto().parseURL()})),t.on("click",".btn-edit",(function(){var t=$(this).data("id");location.href=`/admin/usuarios/${t}/editar`.proto().parseURL()})),t.on("click",".btn-delete",(function(){var n=$(this).data("id");swal({title:"¿Está seguro?",text:"El usuario será eliminado",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((a=>{$.ajax({url:"/admin/usuarios/eliminar/post".proto().parseURL(),type:"POST",data:{id:n},success:function(n){t.ajax.reload(),swal({type:"success",title:"Completado",text:"El usuario ha sido eliminado con éxito",confirmButtonText:"Excelente"})},error:function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"Al parecer el usuario tiene información relacionada"})}})}))})})),$("#search").doneTyping((function(){e.init()}))},e={init:function(){t?t.ajax.reload():(t=$(".users-datatable").DataTable(n),a())}},i=function(){$.ajax({url:"/roles/get".proto().parseURL()}).done((function(t){$("#select_roles").select2({placeholder:"Seleccionar roles...",minimumInputLength:0,data:t.items}).on("change",(function(){e.init()}))}))};return{init:function(){e.init(),i()}}}();$((function(){UserTable.init()}));
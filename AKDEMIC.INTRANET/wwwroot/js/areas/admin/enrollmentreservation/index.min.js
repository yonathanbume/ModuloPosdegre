var InitApp=function(){var e={students:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:"/admin/matricula/reservas/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(e){delete e.columns,e.search="",e.term=$("#term_select").val(),e.faculty=$("#faculty_select").val(),e.career=$("#career_select").val()}},dom:"Bfrtip",buttons:[{extend:"excel",title:"Reservas de Matrícula",exportOptions:{columns:[0,1,2,3,4,5,6]}},{extend:"pdf",title:"Reservas de Matrícula",exportOptions:{columns:[0,1,2,3,4,5,6]},orientation:"landscape"}],pageLength:50,orderable:[],columns:[{data:"term",title:"Periodo",orderable:!1},{data:"code",title:"Código",orderable:!1},{data:"name",title:"Estudiante",orderable:!1},{data:"career",title:"Escuela Profesional",orderable:!1},{data:"faculty",title:"Facultad",orderable:!1},{data:"startDate",title:"Inicio Reserva",orderable:!1},{data:"endDate",title:"Fin Reserva",orderable:!1},{title:"Opciones",orderable:!1,render:function(e,t,a,n){var r="";return r+=`<button data-id= ${a.id} type="button" class="btn btn-sm m-btn m-btn--icon btn-download btn-success"><i class='la la-download'></i></button>`}}]},init:function(){this.object=$("#students_table").DataTable(this.options),e.events()},reload:function(){this.object.ajax.reload()}},events:function(){e.students.object.on("click",".btn-download",(function(){var e=$(this),t=e.data("id");e.addLoader(),$.fileDownload(`/admin/matricula/reservas/descargar-pdf/${t}`.proto().parseURL()).done((function(){toastr.success("Archivo descargado satisfactoriamente","Éxito")})).fail((function(e){toastr.error("Ocurrió un error","Error")})).always((function(){e.removeLoader()}))}))}},t={term:{init:function(){$.ajax({url:"/periodos/get".proto().parseURL()}).done((function(t){$("#term_select").select2({data:t.items}),null!==t.selected&&($("#term_select").val(t.selected),$("#term_select").trigger("change.select2")),e.students.init(),$("#term_select").on("change",(function(t){e.students.reload()}))}))}},faculty:{init:function(){$.ajax({url:"/facultades/v2/get".proto().parseURL()}).done((function(e){$("#faculty_select").select2({data:e.items,minimumResultsForSearch:-1}),t.faculty.events()}))},events:function(){$("#faculty_select").on("change",(function(){$("#faculty_select").val()===_app.constants.guid.empty?($("#career_select").empty(),$("#career_select").select2({placeholder:"Seleccione una escuela",disabled:!0})):t.career.load($("#faculty_select").val()),e.students.reload()}))}},career:{init:function(){$("#career_select").select2({placeholder:"Seleccione una facultad"}),t.career.events()},load:function(e){$.ajax({url:`/facultades/${e}/carreras/v2/get`.proto().parseURL()}).done((function(e){$("#career_select").empty(),$("#career_select").select2({placeholder:"Seleccione una carrera",data:e.items,minimumResultsForSearch:-1,disabled:!1})}))},events:function(){$("#career_select").on("change",(function(){e.students.reload()}))}},init:function(){t.term.init(),t.faculty.init(),t.career.init()}};return{init:function(){t.init()}}}();$((function(){InitApp.init()}));
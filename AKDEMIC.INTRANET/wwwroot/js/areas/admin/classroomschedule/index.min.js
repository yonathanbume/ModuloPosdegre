var ClassroomSchedule=function(){var e,t={init:function(){this.classrooms.initEvents(),this.buildings.initEvents(),this.campuses.init()},campuses:{init:function(){$(".select2-campuses").prop("disabled",!0).select2({placeholder:"Campus"}),$.ajax({url:"/sedes/get".proto().parseURL()}).done((function(e){$(".select2-campuses").select2({placeholder:"Campus",data:e.items}).on("change",(function(){t.buildings.init($(this).val())})).trigger("change"),e.items.length&&$(".select2-campuses").prop("disabled",!1)}))}},buildings:{initEvents:function(){$(".select2-buildings").on("change",(function(){t.classrooms.init($(this).val())}))},init:function(e){$(".select2-buildings").prop("disabled",!0).empty(),$.ajax({url:`/sedes/${e}/pabellones/get`.proto().parseURL()}).done((function(e){$(".select2-buildings").select2({placeholder:"Pabellón",data:e.items}),e.items.length&&$(".select2-buildings").prop("disabled",!1),$(".select2-buildings").trigger("change")}))}},classrooms:{initEvents:function(){$(".select2-classrooms").on("change",(function(){var e=$(this).val();s.destroy(),null!==e&&s.load(e)}))},init:function(e){$(".select2-classrooms").prop("disabled",!0).empty(),$.ajax({url:`/sedes/${$(".select2-campuses").val()}/pabellones/${e}/aulas/get`.proto().parseURL()}).done((function(e){$(".select2-classrooms").select2({placeholder:"Aula",data:e.items}),e.items.length&&$(".select2-classrooms").prop("disabled",!1),$(".select2-classrooms").trigger("change")}))}}},a={allDaySlot:!1,aspectRatio:2,businessHours:{dow:[1,2,3,4,5,6],end:"23:40",start:"07:00"},columnFormat:"dddd",contentHeight:600,defaultView:"agendaWeek",editable:!1,eventRender:function(e,t){t.hasClass("fc-day-grid-event")?(t.data("content",e.description),t.data("placement","top"),mApp.initPopover(t)):t.hasClass("fc-time-grid-event")?t.find(".fc-title").append('<div class="fc-description">'+e.description+"</div>"):0!==t.find(".fc-list-item-title").length&&t.find(".fc-list-item-title").append('<div class="fc-description">'+e.description+"</div>");var a=t.find(".fc-title").clone().children().remove().end().text();t.css("border-color","#"+a.proto().toRGB()).css("border-width","2px")},events:{className:"m-fc-event--primary",error:function(){toastr.error("Ocurrió un problema con el servidor","Error")},url:""},eventClick:function(e,t,a){console.log(e.id),n.detail.load(e.id)},eventAfterAllRender:function(){mApp.unblock(".m-calendar__container")},firstDay:1,header:!1,height:600,contentHeight:900,locale:"es",maxTime:"24:00:00",minTime:"06:00:00",nowIndicator:!0,slotLabelInterval:"01:00:00",viewSubSlotLabel:!0,slotLabelFormat:"h:mmA",monthNames:monthNames,dayNames:dayNames,monthNamesShort:monthNamesShort,dayNamesShort:dayNamesShort,slotDuration:"01:00:00",timeFormat:"h(:mm)A"},s={load:function(t){a.events.url=`/admin/horarioaulas/${t}/get`.proto().parseURL(),mApp.block(".m-calendar__container",{type:"loader",message:"Cargando..."}),e=$(".m-calendar__container").fullCalendar(a)},destroy:function(){null!==e&&($(e).fullCalendar("destroy"),e=null)}},n={detail:{load:function(e){mApp.blockPage(),$.ajax({url:`/admin/horarioaulas/${e}/get-detalle`.proto().parseURL()}).always((function(){mApp.unblockPage()})).done((function(e){$("#DetailCourse").val(e.course),$("#DetailSection").val(e.section),$("#DetailDate").val(e.date),$("#DetailStart").val(e.start),$("#DetailEnd").val(e.end),$("#DetailClassroom").val(e.classroom),$("#DetailType").val(e.type),$("#DetailTeachers").val(e.teachers.join("\r\n")),$("#modal-detail").modal("show")})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}}},o=function(){$("#export_excel").on("click",(function(){var e=$(".select2-classrooms").val();window.open(`/admin/horarioaulas/get-excel?cid=${e}`,"_blank")}))};return{init:function(){t.init(),o()}}}();$((function(){ClassroomSchedule.init()}));
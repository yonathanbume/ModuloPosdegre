var ActivitiesTable=function(){var t,e=$("#GroupId").val(),n={pagination:!1,search:{input:$("#search")},data:{source:{read:{method:"GET",url:`/docente/gruposextracurriculares/section/${e}/students`.proto().parseURL()}}},columns:[{field:"student",title:"Estudiantes"},{field:"score",title:"Nota",width:100,textAlign:"center",sortable:!1,filterable:!1,template:function(t){return"<input data-studentid='"+t.studentId+"' class='form-control integer score' value='"+t.score+"' min='0' max='20' type='number'>"}}]},a=function(){$(".score").on("change",(function(){var t=parseFloat(this.value);isNaN(t)?this.value="0.00":this.value=t>20?"20.00":t<0?"0.00":t.toFixed(2)})),$(".score").on("focus",(function(){$(this).select()})),$(".btn-save").on("click",(function(){var n=[];if($(".score").each((function(){var t=$(this).data("studentid"),e=this.value;n.push({StudentId:t,Score:e})})),n.length>0){var a=JSON.stringify(n);swal({title:"¿Está seguro?",text:"Se guardarán las notas ingresadas.",type:"warning",showCancelButton:!0,confirmButtonText:"Sí, guardar.",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((()=>{$.ajax({url:"/docente/gruposextracurriculares/score/save".proto().parseURL(),type:"POST",data:{score:a,groupId:e},success:function(){t.reload(),swal({type:"success",title:"Completado",text:"La notas de los estudiantes han sido guardadas con éxito",confirmButtonText:"Excelente"}),$(location).attr("href","/docente/gruposextracurriculares".proto().parseURL())},error:function(){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:"Ocurrió un error al guardar las notas de los estudiantes"})}})}))})}}))};return{init:function(){void 0!==t&&t.destroy(),t=$("#datatable").mDatatable(n),$(t).on("m-datatable--on-layout-updated",(function(){a()}))},reload:function(){t.reload()}}}();$((function(){ActivitiesTable.init()}));
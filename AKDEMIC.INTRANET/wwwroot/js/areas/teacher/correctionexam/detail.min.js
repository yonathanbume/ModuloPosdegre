var detail=function(){var t=$("#Id").val(),n={students:{object:null,options:{ajax:{url:"/profesor/examen-subsanacion/get-alumnos-asignados",type:"GET",data:function(n){n.id=t,n.search=$("#search").val()}},columns:[{data:"username",title:"Usuario"},{data:"fullName",title:"Nombre Completo"},{data:"grade",title:"Nota Obtenida",orderable:!1},{data:null,title:"Opciones",orderable:!1,render:function(t){var n="-";return 1==t.status&&(n=`<button data-id="${t.id}" data-student="${t.fullName}" title="Calificar" class="btn-save-grade btn btn-primary btn-sm m-btn  m-btn m-btn--icon"><span><i class="la la-edit"></i><span>Calificar</span></span></button>`),n}}]},events:{onSaveGrade:function(){$("#ajax_data").on("click",".btn-save-grade",(function(){var t=$(this).data("id"),n=$(this).data("student");a.saveGrade.events.show(t,n)}))},init:function(){this.onSaveGrade()}},reload:function(){n.students.object.ajax.reload()},init:function(){n.students.object=$("#ajax_data").DataTable(n.students.options),n.students.events.init()}},init:function(){n.students.init()}},a={saveGrade:{object:$("#modal_save_grade"),form:{object:$("#form_save_grade").validate({submitHandler:function(t,e){e.preventDefault(),swal({title:"¿Está seguro?",text:`La nota(${$(t).find("[name='Grade']").val()}) será asignada.`,type:"info",showCancelButton:!0,confirmButtonText:"Sí, asignar",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,allowOutsideClick:()=>!swal.isLoading(),preConfirm:()=>new Promise((e=>{$.ajax({url:"/profesor/examen-subsanacion/calificar",data:$(t).serialize(),type:"POST"}).done((function(t){n.students.reload(),a.saveGrade.object.modal("hide"),swal({type:"success",title:"Completado",text:"La nota ha sido asignada",confirmButtonText:"Excelente"})})).fail((function(t){swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Entendido",text:502===t.status?"No hay respuesta del servidor":t.responseText})}))}))})}})},events:{show:function(t,n){a.saveGrade.object.find("[name='Id']").val(t),$("#StudentName").text(n),a.saveGrade.object.modal("show")},onHidden:function(){a.saveGrade.object.on("hidden.bs.modal",(function(t){a.saveGrade.object.resetForm()}))},init:function(){this.onHidden()}},init:function(){a.saveGrade.events.init()}},init:function(){a.saveGrade.init()}},e={onSearch:function(){$("#search").doneTyping((function(){n.students.reload()}))},init:function(){this.onSearch()}};return{init:function(){e.init(),a.init(),n.init()}}}();$((()=>{detail.init()}));
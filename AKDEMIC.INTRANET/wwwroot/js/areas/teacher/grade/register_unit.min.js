var index=function(){var t=$("#SectionId").val(),n=$("#CourseUnitId").val(),a=!1,o={object:null,rules:function(){$.validator.addMethod("grade",(function(t,n,a,o){if("nr"==t.toLowerCase())return!0;if(/^\d{0,2}(\.\d{0,3})?$/.test(t)){var e=parseFloat(t);return!isNaN(e)&&!(e>20||e<0)}return!1}),"Por favor ingrese una nota vÃ¡lida.")},validate:function(){o.object=$("#form-validation").validate({submitHandler:function(n){mApp.block(".m-portlet",{message:"Guardando notas..."}),$.ajax({url:$(n).attr("action"),type:"POST",data:$(n).serialize(),success:function(){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),a&&swal({type:"success",title:"Notas publicadas",text:"Las notas han sido publicadas y seran visibles para los estudiantes",confirmButtonText:"Aceptar"}).then((function(n){n&&(window.location.href=`/profesor/notas/detalle/${t}`)}))},error:function(t){null==t.responseText||""==t.responseText?toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error):toastr.error(t.responseText,_app.constants.toastr.title.error)},complete:function(){mApp.unblock(".m-portlet")}})}})},init:function(){o.rules(),o.validate()}},e={onGetStudents:function(){mApp.block(".m-portlet",{message:"Cargando alumnos..."}),$.ajax({url:`/profesor/notas/registrar/getalumnos-unidad/${t}/${n}`,type:"GET"}).done((function(t){$("#container_datatable").html(t),mApp.unblock(".m-portlet"),$(".input-grade").each((function(){$(this).rules("add",{grade:!0})}))}))},onChangeSubmit:function(){$("#publish-btn").on("click",(function(){$("#form-validation").attr("action","/profesor/notas/registrar-notas-unidades/publicar"),a=!0,$("#form-validation").submit()})),$("#save-btn").on("click",(function(){$("#form-validation").attr("action","/profesor/notas/registrar-notas-unidades/post"),a=!1,$("#form-validation").submit()}))},onValidate:function(){$("#container_datatable").on("keydown",".input-grade",(function(t){var n=t.charCode||t.keyCode||0;return console.log(n),78==n||82==n||8==n||9==n||13==n||46==n||110==n||190==n||n>=35&&n<=40||n>=48&&n<=57||n>=96&&n<=105}))},init:function(){e.onGetStudents(),e.onChangeSubmit(),e.onValidate()}};return{init:function(){e.init(),o.init()}}}();$((()=>{index.init()}));
var InitApp=function(){var e={requests:{object:null,options:{serverSide:!0,filter:!1,lengthChange:!1,ajax:{url:"/profesor/correccion-rectificacion-notas/get".proto().parseURL(),type:"GET",dataType:"JSON",data:function(e){delete e.columns,e.searchValue=$("#search").val()}},pageLength:50,orderable:[],columns:[{data:"term",title:"Periodo"},{data:"course",title:"Curso"},{data:"code",title:"Código"},{data:"student",title:"Estudiante"},{data:"evaluation",title:"Evaluación"},{data:null,title:"Nota Ant.",render:function(e,t,a){return a.gradePrevious}},{data:null,title:"Nota Nue.",render:function(e,t,a){return 0!=e.gradeNew?e.gradeNew:"--"}},{data:"state",title:"Estado"}]},init:function(){this.object=$("#ajax_data").DataTable(this.options)},reload:function(){this.object.ajax.reload()}}},t={init:function(){},term:{init:function(){$.ajax({url:"/periodos-pasados/get".proto().parseURL()}).done((function(e){$("#TermId").select2({data:e.items}),$("#TermId").on("change",(function(){null!==$("#TermId").val()&&($(".select2-teachers").empty(),$("#CourseId").empty(),$("#AcademicHistoryIds").empty(),$("#EvaluationId").empty(),t.teacher.init())})),$("#TermId").trigger("change")})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}},teacher:{init:function(){t.teacher.load(),t.teacher.onChange()},load:function(){$(".select2-teachers").select2({ajax:{data:function(e){return console.log(e),{search:e.term||e.q||"",query:e.q||e.term||"",type:e._type,page:e.page||1}},delay:300,type:"GET",url:`/periodo/${$("#TermId").val()}/profesor/get`.proto().parseURL()},placeholder:"Seleccione Docente",allowClear:!0,minimumInputLength:3,dropdownParent:$(".select2-teachers").closest(".modal-body")})},onChange:function(){$(".select2-teachers").on("change",(function(){null!==$(".select2-teachers").val()&&($("#CourseId").empty(),t.course.init())})),$(".select2-teachers").trigger("change")},clean:function(){$(".select2-teachers").val("").trigger("change")}},course:{init:function(){$.ajax({url:`/cursos/docente/${$("#TeacherId").val()}/periodo/${$("#TermId").val()}`.proto().parseURL()}).done((function(e){$("#CourseId").select2({data:e,placeholder:"Seleccione Curso",dropdownParent:$("#CourseId").closest(".modal-body")}),$("#CourseId").on("change",(function(){null!==$("#CourseId").val()&&($("#AcademicHistoryIds").empty(),$("#EvaluationId").empty(),t.academicHistory.init(),t.evaluation.init())})),$("#CourseId").trigger("change")})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}},academicHistory:{init:function(){t.academicHistory.load(),t.academicHistory.onChange()},load:function(){$("#AcademicHistoryIds").select2({ajax:{data:function(e){return console.log(e),{search:e.term||e.q||"",query:e.q||e.term||"",type:e._type,page:e.page||1}},delay:300,type:"GET",url:`/cursos/${$("#CourseId").val()}/periodo/${$("#TermId").val()}/historial-academico/get`.proto().parseURL()},placeholder:"Seleccione Alumno",allowClear:!0,dropdownParent:$("#AcademicHistoryIds").closest(".modal-body")})},onChange:function(){$("#AcademicHistoryIds").on("change",(function(){$("#AcademicHistoryIds").val()})),$("#AcademicHistoryIds").trigger("change")},clean:function(){$("#AcademicHistoryIds").val("").trigger("change")}},evaluation:{init:function(){$.ajax({url:`/cursos/${$("#CourseId").val()}/periodo/${$("#TermId").val()}/evaluacion/get`.proto().parseURL()}).done((function(e){$("#EvaluationId").select2({data:e,placeholder:"Seleccione Evaluación",dropdownParent:$("#EvaluationId").closest(".modal-body")})})).fail((function(){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error)}))}}},a=function(){},o=function(){},r=function(){$("#search").doneTyping((function(){e.requests.reload()}))};return{init:function(){t.init(),o(),r(),a(),e.requests.init()},reloadTable:function(){e.requests.reload()}}}();$((function(){InitApp.init()}));
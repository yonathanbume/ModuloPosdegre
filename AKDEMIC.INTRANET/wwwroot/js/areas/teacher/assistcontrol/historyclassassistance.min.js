var Assistances=function(){var e={search:{input:$("#search")},data:{type:"remote",source:{read:{method:"GET",url:`/profesor/asistencia/get?classId=${$("#classId").val()}`.proto().parseURL()}},pageSize:10,saveState:{cookie:!0,webstorage:!0}},layout:{footer:!0},pagination:!1,columns:[{field:"studentName",title:"Nombre",width:260,template:function(e){var t="";return e.absences>e.maxAbsences?(t+="<p style='color:red;'>",t+=e.studentName,t+="</p>"):t+=e.studentName,t}},{field:"maxAbsences",title:"MÃ¡x. Faltas",textAlign:"center",width:120,template:function(e){var t="";return e.absences>e.maxAbsences?(t+="<p style='color:red;'>",t+=e.maxAbsences,t+="</p>"):t+=e.maxAbsences,t}},{field:"absences",title:"Faltas",textAlign:"center",width:120,template:function(e){var t="";return e.absences>e.maxAbsences?(t+="<p style='color:red;'>",t+=e.absences,t+="</p>"):t+=e.absences,t}},{field:"status",title:"Inasistencia",width:250,sortable:!1,overflow:"inherit",textAlign:"center",template:function(e,t){var s="";return s+=`<input  hidden name='assists.List[${t}].ClassStudentId' value='${e.id}' />`,s+="<label class='m-checkbox m-checkbox--single m-checkbox--solid m-checkbox--brand'>",s+=`<input disabled id='input_${e.id}' type='checkbox' name='assists.List[${t}].IsAbsent' value='true' ${e.isAbsent?"checked":""}/>`,s+=`<input name='assists[${t}].IsAbsent' type='hidden' value='false' />`,s+=`<input hidden name='assists.List[${t}].StudentId' value='${e.studentId}' />`,s+="<span></span></label>"}}]},t=function(){$("#form_msg").addClass("m--hide").hide(),$("#form_msg_txt").html(""),$("select").attr("disabled",!0),$("#btnAssists").addLoader()},s=function(){$("select").attr("disabled",!1),$("#btnAssists").removeLoader()},a=function(e){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success)},n=function(e){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!=e.responseText?$("#form_msg_txt").html(e.responseText):$("#form_msg_txt").html(_app.constants.toastr.message.error.task),$("#form_msg").removeClass("m--hide").show()},i={init:function(){this.activities.init(),this.virtualClass.init()},activities:{init:function(){$.ajax({url:`/cursos/${$("#CourseId").val()}/temario/get`}).done((function(e){$(".select2-activities").select2({data:e.items,placeholder:"Selecciona un tema de clase",dropdownParent:$("#frm-assistance"),disabled:!EnableUpdateClass}).val($("#defaultActivityId").val()).trigger("change")}))}},virtualClass:{init:function(){$.ajax({url:`/get-videoconferencias-select?sectionId=${$("#SectionId").val()}`}).done((function(e){$(".select2-videoconferences").select2({data:e,placeholder:"Selecciona un tema de videoconferencias"}),$("#VirtualClassId").val($("#defaultVirtualClassId").val()).trigger("change")}))}}},l={onChange:function(){$("#Class_HasVirtualClass").on("change",(function(){$(this).is(":checked")?($("#div_virtualclass").removeClass("d-none"),$("#VirtualClassId").val($("#defaultVirtualClassId").val()).trigger("change"),$("#VirtualClassId").attr("required",!0)):($("#div_virtualclass").addClass("d-none"),$("#VirtualClassId").val(null).trigger("change"),$("#VirtualClassId").attr("required",!1))}))},init:function(){this.onChange()}},c=function(){$("#frm-assistance").validate()};return{init:function(){$("#assistance-datatable").mDatatable(e),i.init(),c(),l.init()},Form:{begin:function(){t()},complete:function(){s()},success:function(e){a(e)},failure:function(e){n(e)}}}}();$((function(){Assistances.init()}));
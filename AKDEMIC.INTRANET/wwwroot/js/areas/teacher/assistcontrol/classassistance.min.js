var Assistances=function(){var t={search:{input:$("#search")},data:{type:"remote",source:{read:{method:"GET",url:`/profesor/asistencia/get?classId=${$("#classId").val()}`.proto().parseURL()}},pageSize:10,saveState:{cookie:!0,webstorage:!0}},layout:{footer:!0},pagination:!1,columns:[{field:"studentName",title:"Nombre",template:function(t){var e="";return t.dpi?(e+="<p style='color:red; font-weight: bold;'>",e+=`${t.studentName} (DPI)`,e+="</p>"):e+=t.studentName,e}},{field:"maxAbsences",title:"% Faltas",textAlign:"center",width:120,template:function(t){var e="";return t.dpi?(e+="<p style='color:red; font-weight: bold;'>",e+=`${t.absencePercentage}%`,e+="</p>"):e+=`${t.absencePercentage}%`,e}},{field:"absences",title:"Faltas",textAlign:"center",width:120,template:function(t){var e="";return t.dpi?(e+="<p style='color:red; font-weight: bold;'>",e+=t.absences,e+="</p>"):e+=t.absences,e}},{field:"status",title:"Inasistencia",width:250,sortable:!1,overflow:"inherit",textAlign:"center",template:function(t,e){var s="";return s+=`<input hidden name='assists.List[${e}].ClassStudentId' value='${t.id}' />`,s+=`<label class='m-checkbox m-checkbox--single m-checkbox--solid m-checkbox--brand' ${t.dpi?"style = 'cursor:not-allowed'":""}>`,s+=`<input id='input_${t.id}' type='checkbox' name='assists.List[${e}].IsAbsent' value='true' ${t.dpi?"disabled":""} ${t.isAbsent?"checked":""}/>`,s+=`<input name='assists.List[${e}].DPI' type='hidden' value='${t.dpi}' />`,s+=`<input name='assists[${e}].IsAbsent' type='hidden' value='false' />`,s+=`<input hidden name='assists.List[${e}].StudentId' value='${t.studentId}' />`,s+="<span></span></label>"}}]},e=($("#frm-assistance").validate({submitHandler:function(t,e){e.preventDefault();var s=new FormData(t);$("#form_msg").addClass("m--hide").hide(),$("#form_msg_txt").html(""),$("#frm-assistance").find(":input").attr("disabled",!0),$("#btnAssists").addLoader(),$.ajax({url:$(t).attr("action"),type:"POST",data:s,contentType:!1,processData:!1}).done((function(t){toastr.success(_app.constants.toastr.message.success.task,_app.constants.toastr.title.success),window.location.href=`/profesor/reporte_asistencia/asistencias/${$("#SectionId").val()}`.proto().parseURL()})).fail((function(t){toastr.error(_app.constants.toastr.message.error.task,_app.constants.toastr.title.error),null!=t.responseText?$("#form_msg_txt").html(t.responseText):$("#form_msg_txt").html(_app.constants.toastr.message.error.task),$("#form_msg").removeClass("m--hide").show()})).always((function(){$("#btnAssists").removeLoader(),$("#frm-assistance").find(":input").attr("disabled",!1)}))}}),{init:function(){this.activities.init(),this.virtualClass.init()},activities:{init:function(){$.ajax({url:`/cursos/${$("#CourseId").val()}/temario/get`}).done((function(t){$(".select2-activities").select2({data:t.items,allowClear:!0,placeholder:"Selecciona un tema de clase",dropdownParent:$("#frm-assistance")}).val($("#defaultActivityId").val()).trigger("change")}))}},virtualClass:{init:function(){$.ajax({url:`/get-videoconferencias-select?sectionId=${$("#SectionId").val()}`}).done((function(t){$(".select2-videoconferences").select2({data:t,allowClear:!0,placeholder:"Selecciona un tema de videoconferencias"}),$("#VirtualClassId").val(null).trigger("change")}))}}}),s={onChange:function(){$("#Class_HasVirtualClass").on("change",(function(){$(this).is(":checked")?($("#div_virtualclass").removeClass("d-none"),$("#VirtualClassId").val($("#defaultVirtualClassId").val()).trigger("change"),$("#VirtualClassId").attr("required",!0)):($("#div_virtualclass").addClass("d-none"),$("#VirtualClassId").val(null).trigger("change"),$("#VirtualClassId").attr("required",!1))}))},init:function(){this.onChange()}};return{init:function(){$("#assistance-datatable").mDatatable(t),e.init(),s.init()}}}();$((function(){Assistances.init()}));
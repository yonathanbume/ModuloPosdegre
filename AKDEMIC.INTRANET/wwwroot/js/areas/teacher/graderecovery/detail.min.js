var detail=function(){var t=$("#GradeRecoveryExamId").val(),e={studentsAssigned:{object:null,options:{ajax:{url:"/profesor/examenes-recuperacion-nota/get-estudiantes-asignados",data:function(e){e.gradeRecoveryExamId=t},method:"GET",dataSrc:""},bPaginate:!1,bLengthChange:!1,bFilter:!0,bInfo:!1,columns:[{data:"userName",title:"Usuario"},{data:"fullName",title:"Estudiante"},{data:"minGrade",title:"Nota a Reemplazar"},{data:"evaluation",title:"Evaluación"},{data:null,title:"¿Ausente?",render:function(t){var e="";return e+=`<span class="m-switch m-switch--outline m-switch--icon m-switch--primary m-switch--sm">\n                                <label>\n                                    <input type="checkbox" class="students_check check_${t.studentId}" data-id="${t.studentId}">\n                                    <span></span>\n                                </label>\n                            </span>`}},{data:null,title:"Nota del Exámen",render:function(t){var e="";return e+=`<input type='number' min='0' max='20' step='1' required data-id="${t.studentId}" class="form-control input-sm m-input input_student input_${t.studentId}">`}}]},init:function(){this.object=$("#assigned_students").DataTable(this.options)}},studentsExecuted:{object:null,options:{ajax:{url:"/profesor/examenes-recuperacion-nota/get-estudiantes-asignados-examen-concluido",data:function(e){e.gradeRecoveryExamId=t},method:"GET",dataSrc:""},bPaginate:!1,bLengthChange:!1,bFilter:!0,bInfo:!1,columns:[{data:"userName",title:"Usuario"},{data:"fullName",title:"Estudiante"},{data:"prevFinalScore",title:"Nota Reemplazada"},{data:"evaluation",title:"Evaluación"},{data:"examScore",title:"Nota Obtenida"}]},init:function(){this.object=$("#assigned_students_executed").DataTable(this.options)}},init:function(){this.studentsAssigned.init(),this.studentsExecuted.init()}},a={onChangeStatus:function(){$("#assigned_students").on("change",".students_check",(function(){var t=$(this).data("id");$(this).is(":checked")?($("#assigned_students").find(`.input_${t}`).val(0),$("#assigned_students").find(`.input_${t}`).attr("disabled",!0)):($("#assigned_students").find(`.input_${t}`).attr("disabled",!1),$("#assigned_students").find(`.input_${t}`).val(""))}))},onSave:function(){$("#save_grades").on("click",(function(){var e=$(this);e.addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0);var a=new FormData;a.append("GradeRecoveryExam",t);for(var n=$("#assigned_students").find(".input_student"),s=0;s<n.length;s++){var i=$(n[s]).data("id"),d=$("#assigned_students").find(`.check_${i}`).is(":checked"),o=$("#assigned_students").find(`.input_${i}`).val();a.append(`Students[${s}].StudentId`,i),a.append(`Students[${s}].Value`,o),a.append(`Students[${s}].IsAbsent`,d)}$.ajax({url:"/profesor/examenes-recuperacion-nota/guardar-notas",type:"POST",data:a,contentType:!1,processData:!1}).done((function(){window.location.reload()})).fail((function(t){e.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),swal({type:"error",title:"Error",confirmButtonClass:"btn btn-danger m-btn m-btn--custom",confirmButtonText:"Aceptar",text:502===t.status?"No hay respuesta del servidor":t.responseText})})).always((function(){e.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1)}))}))},init:function(){this.onChangeStatus(),this.onSave()}};return{init:function(){e.init(),a.init()}}}();$((()=>{detail.init()}));
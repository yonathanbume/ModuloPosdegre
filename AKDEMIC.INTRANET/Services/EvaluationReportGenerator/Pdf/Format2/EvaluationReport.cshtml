@model AKDEMIC.REPOSITORY.Repositories.Intranet.Templates.EvaluationReport.EvaluationReportInformationTemplate
@using AKDEMIC.CORE.Extensions
@using AKDEMIC.CORE.Helpers
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Acta de notas</title>
    <style>
        body {
            font-family: "Calibri";
            font-size: 15px;
        }

        h1 {
            margin-bottom: 5px !important;
            font-size: 28px;
        }

        h2 {
            margin: 0px;
            font-size: 18px;
        }

        img {
            top: 0;
            left: 0;
            /*max-height: 60px;*/
        }

        header {
            width: 100%;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-weight: normal;
        }

        tr {
            page-break-inside: avoid;
        }


        th {
            page-break-inside: avoid;
        }

        tbody .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .bordered {
            border: 1px solid black;
            padding: 3px 3px !important;
        }

        .headerformat .unbordered {
            border: 0px;
            padding: 3px 3px !important;
        }

        th {
            font-weight: normal;
            text-align: left;
        }

        .red {
            color: red;
        }

        .bold {
            font-weight: bold;
            background-color: lightgray;
        }

        .center {
            text-align: center;
        }

        .header2 {
            font-size: 15px;
            padding: 3px 0px !important;
        }

        .header > th, td {
            border: 1px solid black;
            padding: 5px 3px !important;
        }

        .td-header {
            border: none;
            padding: 0px !important;
        }

        .detail-header {
            font-size: 15px;
            text-align: left;
            font-weight: 600;
        }

        .footer {
            font-size: 15px;
            text-align: center;
            font-style: italic;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: -6px;
        }

        .thd {
            border: 1px solid black;
            padding: 5px;
            font-size: 15px;
        }

        .negrita {
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        .unk-header {
            width: 100%;
            text-align: center;
            /*margin-bottom: 40px;*/
        }
    </style>
</head>
<body>


    <table>

        <thead class="headerformat" style="height:100px;">
            <tr>

                <th colspan="6">

                    <table>
                        <thead class="headerformat">
                            <tr class="unbordered" style="height: 100px">
                                <th colspan="1" style="text-align: center; padding: 0px 20px; vertical-align: middle">
                                    <img style="top: 0; left: 0; height: 80px;width:auto" src="@Model.Img" />
                                    @*<img style="top: 0; left: 0; height: 80px;width:auto" src="~/images/themes/unamad/logo-report.png" />*@
                                </th>
                                <th colspan="5" style="vertical-align: middle;">
                                    <div class="unk-header negrita" style="font-size:18px; text-transform: uppercase">@GeneralHelpers.GetInstitutionName() <br /> ACTA DE NOTAS</div>
                                </th>
                            </tr>
                            <tr class="unbordered" style="">
                                <th colspan="6" style="padding:unset !important">
                                    <table class="header">
                                        <tbody>
                                            <tr>
                                                <td class="bold" style="width:9%">DOCENTE:</td>
                                                <td colspan="3">@Model.Course.Section.Teacher</td>
                                                <td class="bold">PERIODO ACAD.:</td>
                                                <td>@Model.Term.Name</td>
                                            </tr>
                                            <tr>
                                                <td class="bold">CURSO:</td>
                                                <td style="width:45%">@($"[{Model.Course.Curriculum}-{Model.Course.Code}] {Model.Course.Name}")</td>
                                                <td class="bold" style="width:11%;">CREDITOS:</td>
                                                <td style="width:6%;">@Model.Course.Credits</td>
                                                <td class="bold" style="width:18%">CICLO DEL CURSO:</td>
                                                <td>@Model.Course.AcademicYear</td>
                                            </tr>
                                            <tr>
                                                <td class="bold">ESCUELA:</td>
                                                <td>@Model.Course.Career.Name</td>
                                                <td class="bold">SEDE:</td>
                                                <td>-</td>
                                                <td class="bold">SECCION:</td>
                                                <td>@Model.Course.Section.Code</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <br />
                                    @*<br />
                                    <br />*@
                                </th>
                            </tr>
                        </thead>
                    </table>

                </th>

            </tr>

            <tr class="bordered">
                <th class="bold center" style="width: 40px;">N°</th>
                <th class="bold center" style="width: 80px;">Código</th>
                <th class="bold center">Apellidos y Nombres</th>
                <th class="bold center" style="width: 70px;">Nota</th>
                <th class="bold center" style="width: 150px;">Descripción</th>
                <th class="bold center" style="width: 180px;">Observación</th>

            </tr>
        </thead>
        <tbody>
            @for (var i = 0; i < Model.Course.Section.Students.Count(); i++)
            {
                <tr class="bordered">
                    <th class="thd center">@(i + 1)</th>
                    <th class="thd center" style="border-right:0px !important;">@Model.Course.Section.Students[i].UserName</th>
                    <th class="thd" style="border-right:0px !important;">@Model.Course.Section.Students[i].FullName</th>

                    @if (Model.Course.Section.Students[i].Status != ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN)
                    {
                        @if (Model.Course.Section.Students[i].Approved)
                        {
                            <th class="thd center" style="font-weight:bold;">@Model.Course.Section.Students[i].FinalGrade @(Model.Course.Section.Students[i].HasSusti ? "(SUSTI)" : "")</th>
                            <th class="thd center">@Model.Course.Section.Students[i].FinalGradeText</th>
                        }
                        else
                        {
                            <th class="red thd center">@Model.Course.Section.Students[i].FinalGrade @(Model.Course.Section.Students[i].HasSusti ? "(SUSTI)" : "")</th>
                            <th class="red thd center">@Model.Course.Section.Students[i].FinalGradeText</th>
                        }
                    }
                    else
                    {
                        <th class="red thd center">R</th>
                        <th class="red thd center">RETIRADO</th>
                    }
                    <th class="thd">@Model.Course.Section.Students[i].StatusText.ToUpper()</th>
                </tr>
            }

            @if (!Model.Course.Section.Students.Any())
            {
                <tr class="bordered">
                    <th class="center" colspan="6">No hay estudiantes en la sección</th>
                </tr>
            }

        </tbody>

    </table>


    <table>
        <tr style="border:unset !important">
            <th style="border:unset !important; width: 300px; vertical-align: top">
                <br />
                <table>
                    <tr>
                        <td style="width: 100px"><b>Resumen</b></td>
                        <td style="width: 100px"># de Estudiantes</td>
                        <td style="width: 100px">Porcentual</td>
                    </tr>
                    <tr>
                        <td><b>Matriculados</b></td>
                        <td>@Model.Course.Section.Students.Count()</td>
                        <td>100%</td>
                    </tr>
                    <tr>
                        <td><b>Aprobados</b></td>
                        @{
                            var app = Model.Course.Section.Students.Where(x => x.Status != ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN && x.Approved).Count();
                        }
                        <td>@app</td>
                        <td>@((app * 100) > 0 ? (app * 100) / Model.Course.Section.Students.Count() : 0)%</td>
                    </tr>
                    <tr>
                        <td><b>Desaprobados</b></td>
                        @{
                            var disapp = Model.Course.Section.Students.Where(x => x.Status != ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN && !x.Approved).Count();
                        }
                        <td>@disapp</td>
                        <td>@((disapp * 100) > 0 ? (disapp * 100) / Model.Course.Section.Students.Count() : 0)%</td>
                    </tr>
                    @*<tr>
                    <td><b>No rindió</b></td>
                    <td></td>
                    <td></td>
                    </tr>*@
                    <tr>
                        <td><b>Retirados</b></td>
                        @{
                            var ret = Model.Course.Section.Students.Where(x => x.Status == ConstantHelpers.STUDENT_SECTION_STATES.WITHDRAWN).Count();
                        }
                        <td>@ret</td>
                        <td>@((ret * 100) > 0 ? (ret * 100) / Model.Course.Section.Students.Count() : 0)%</td>
                    </tr>
                </table>
                @*<div style="width:29% !important; text-align:end; float:left; display:block; padding:5px">
                <img style="max-height:100px !important; height:100px !important; width:100px !important;" src="@Model.FinalQR" />
                </div>*@
            </th>
            <th colspan="4" style="border:unset !important">
                <table>
                    <tr style="height:55px">
                        <th>

                        </th>
                        <th style="text-align:right" colspan="2">
                            <table>
                                <tr style="text-align:center">
                                    @if (Model.BasicInformation.LastGradeRegistration.HasValue)
                                    {
                                        <td>@GeneralHelpers.GetInstitutionLocation(), @Model.BasicInformation.DateByConfiguration.ToDefaultTimeZone().Value.Day de @ConstantHelpers.MONTHS.VALUES[Model.BasicInformation.DateByConfiguration.ToDefaultTimeZone().Value.Month] del @Model.BasicInformation.DateByConfiguration.ToDefaultTimeZone().Value.Year</td>
                                    }
                                    else
                                    {
                                        <td>&emsp;</td>
                                    }
                                </tr>
                            </table>
                        </th>
                    </tr>
                    <tr>
                        <th style="height:90px;">

                        </th>
                    </tr>
                    <tr>
                        <th colspan="2">
                            <table>
                                <tr>
                                    <th style="border-top:1px solid; text-align:center;">
                                        FIRMA DOCENTE
                                    </th>
                                    <th>
                                        &emsp;
                                    </th>
                                    <th style="border-top:1px solid; text-align:center;">
                                        DIRECTOR DE ESCUELA
                                    </th>
                                </tr>
                            </table>
                        </th>
                    </tr>
                </table>
            </th>
        </tr>
    </table>
    <br />
</body>
</html>
